<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EDUC 784 - 4&nbsp; Categorical predictors</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch3_two_predictors.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch4_categorical_predictors.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Categorical predictors</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">EDUC 784</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2_simple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simple Regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3_two_predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Two predictors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4_categorical_predictors.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Categorical predictors</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-interpretations-4" id="toc-sec-interpretations-4" class="nav-link active" data-scroll-target="#sec-interpretations-4"><span class="header-section-number">4.1</span> Focus on interpretation</a></li>
  <li><a href="#sec-social-constructs-4" id="toc-sec-social-constructs-4" class="nav-link" data-scroll-target="#sec-social-constructs-4"><span class="header-section-number">4.2</span> Data and social constructs</a></li>
  <li><a href="#sec-binary-predictors-4" id="toc-sec-binary-predictors-4" class="nav-link" data-scroll-target="#sec-binary-predictors-4"><span class="header-section-number">4.3</span> Binary predictors</a>
  <ul class="collapse">
  <li><a href="#sec-t-test-4" id="toc-sec-t-test-4" class="nav-link" data-scroll-target="#sec-t-test-4"><span class="header-section-number">4.3.1</span> Relation with t-tests of means</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4.3.2</span> Summary</a></li>
  </ul></li>
  <li><a href="#sec-reference-group-coding-4" id="toc-sec-reference-group-coding-4" class="nav-link" data-scroll-target="#sec-reference-group-coding-4"><span class="header-section-number">4.4</span> Reference-group coding</a>
  <ul class="collapse">
  <li><a href="#a-hypothetical-example" id="toc-a-hypothetical-example" class="nav-link" data-scroll-target="#a-hypothetical-example"><span class="header-section-number">4.4.1</span> A hypothetical example</a></li>
  <li><a href="#sec-reference-group-interpretation-4" id="toc-sec-reference-group-interpretation-4" class="nav-link" data-scroll-target="#sec-reference-group-interpretation-4"><span class="header-section-number">4.4.2</span> Interpreting the regression coefficients</a></li>
  <li><a href="#sec-reference-group-more-than-three-4" id="toc-sec-reference-group-more-than-three-4" class="nav-link" data-scroll-target="#sec-reference-group-more-than-three-4"><span class="header-section-number">4.4.3</span> More than 3 categories</a></li>
  <li><a href="#summary-1" id="toc-summary-1" class="nav-link" data-scroll-target="#summary-1"><span class="header-section-number">4.4.4</span> Summary</a></li>
  </ul></li>
  <li><a href="#sec-deviation-coding-4" id="toc-sec-deviation-coding-4" class="nav-link" data-scroll-target="#sec-deviation-coding-4"><span class="header-section-number">4.5</span> Deviation coding</a>
  <ul class="collapse">
  <li><a href="#sec-idela-4" id="toc-sec-idela-4" class="nav-link" data-scroll-target="#sec-idela-4"><span class="header-section-number">4.5.1</span> A hypothetical example</a></li>
  <li><a href="#sec-deviation-interpretation-4" id="toc-sec-deviation-interpretation-4" class="nav-link" data-scroll-target="#sec-deviation-interpretation-4"><span class="header-section-number">4.5.2</span> Interpreting the regression coefficients</a></li>
  <li><a href="#summary-2" id="toc-summary-2" class="nav-link" data-scroll-target="#summary-2"><span class="header-section-number">4.5.3</span> Summary</a></li>
  <li><a href="#sec-extra1-4" id="toc-sec-extra1-4" class="nav-link" data-scroll-target="#sec-extra1-4"><span class="header-section-number">4.5.4</span> Extra: Deviation coding with unequal sample sizes*</a></li>
  <li><a href="#sec-extra2-4" id="toc-sec-extra2-4" class="nav-link" data-scroll-target="#sec-extra2-4"><span class="header-section-number">4.5.5</span> Extra: Deviation coding with all groups included*</a></li>
  </ul></li>
  <li><a href="#relation-with-anova" id="toc-relation-with-anova" class="nav-link" data-scroll-target="#relation-with-anova"><span class="header-section-number">4.6</span> Relation with ANOVA</a></li>
  <li><a href="#sec-categorical-results-4" id="toc-sec-categorical-results-4" class="nav-link" data-scroll-target="#sec-categorical-results-4"><span class="header-section-number">4.7</span> Some details about categorical data*</a></li>
  <li><a href="#sec-workbook-4" id="toc-sec-workbook-4" class="nav-link" data-scroll-target="#sec-workbook-4"><span class="header-section-number">4.8</span> Workbook</a></li>
  <li><a href="#sec-exercises-4" id="toc-sec-exercises-4" class="nav-link" data-scroll-target="#sec-exercises-4"><span class="header-section-number">4.9</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#a-single-binary-predictor" id="toc-a-single-binary-predictor" class="nav-link" data-scroll-target="#a-single-binary-predictor"><span class="header-section-number">4.9.1</span> A single binary predictor</a></li>
  <li><a href="#recoding-a-factor-to-numeric" id="toc-recoding-a-factor-to-numeric" class="nav-link" data-scroll-target="#recoding-a-factor-to-numeric"><span class="header-section-number">4.9.2</span> Recoding a factor to numeric</a></li>
  <li><a href="#binary-predictors-and-independent-samples-t-tests" id="toc-binary-predictors-and-independent-samples-t-tests" class="nav-link" data-scroll-target="#binary-predictors-and-independent-samples-t-tests"><span class="header-section-number">4.9.3</span> Binary predictors and independent samples t-tests</a></li>
  <li><a href="#reference-group-coding" id="toc-reference-group-coding" class="nav-link" data-scroll-target="#reference-group-coding"><span class="header-section-number">4.9.4</span> Reference-group coding</a></li>
  <li><a href="#more-about-factors" id="toc-more-about-factors" class="nav-link" data-scroll-target="#more-about-factors"><span class="header-section-number">4.9.5</span> More about factors</a></li>
  <li><a href="#back-to-reference-group-coding" id="toc-back-to-reference-group-coding" class="nav-link" data-scroll-target="#back-to-reference-group-coding"><span class="header-section-number">4.9.6</span> Back to reference-group coding</a></li>
  <li><a href="#changing-the-reference-group" id="toc-changing-the-reference-group" class="nav-link" data-scroll-target="#changing-the-reference-group"><span class="header-section-number">4.9.7</span> Changing the reference group</a></li>
  <li><a href="#deviation-coding" id="toc-deviation-coding" class="nav-link" data-scroll-target="#deviation-coding"><span class="header-section-number">4.9.8</span> Deviation coding</a></li>
  <li><a href="#extra-relation-to-anova" id="toc-extra-relation-to-anova" class="nav-link" data-scroll-target="#extra-relation-to-anova"><span class="header-section-number">4.9.9</span> Extra: Relation to ANOVA</a></li>
  <li><a href="#extra-group-mean-coding" id="toc-extra-group-mean-coding" class="nav-link" data-scroll-target="#extra-group-mean-coding"><span class="header-section-number">4.9.10</span> Extra: Group-mean coding</a></li>
  <li><a href="#extra-weighted-versus-unweighted-deviation-coding" id="toc-extra-weighted-versus-unweighted-deviation-coding" class="nav-link" data-scroll-target="#extra-weighted-versus-unweighted-deviation-coding"><span class="header-section-number">4.9.11</span> Extra: Weighted versus unweighted deviation coding</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-chap-4" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Categorical predictors</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>So far we have considered examples in which we regress a continuous outcome variable (e.g., Math Achievement) on one or more continuous predictors (SES, Approaches to Learning). In this chapter we consider how regression can be used with categorical predictors.</p>
<p>In an experimental context, the canonical example of a categorical predictor is treatment status (e.g., 1 = treatment group, 0 = control group). Examples of other categorical predictors commonly used in education research include:</p>
<ul>
<li>Geographical region / school district (Orange, CH-C, Wake, …)</li>
<li>Type of school (public, private, charter, religious)</li>
<li>Which classroom, teacher, or school a student was assigned to</li>
<li>Gender (if recorded as categorical)</li>
<li>Race / ethnicity (if recorded as categorical)</li>
<li>Free / reduced price lunch status</li>
<li>English language learner status</li>
<li>Individualized learning plan status</li>
<li>…</li>
</ul>
<p>In regression, we deal with these types of predictors using an approach called <em>contrast coding</em> (also called <em>effect coding</em> or <em>dummy coding</em>). In particular, we will address three types of contrast coding:</p>
<ul>
<li>The special case of a single binary predictor</li>
<li>Reference-group coding (called “treatment” contrasts in R)</li>
<li>Deviation coding (called “sum” contrasts in R)</li>
</ul>
<p>There are other types of contrast coding out there. We do not attempt an exhaustive review. However, the techniques we use in this chapter can be used with other types of contrast coding.</p>
<p>Along the way we will see that regression with a categorical predictor encompasses the independent samples t-tests of means and one-way ANOVA, both of which we discussed last semester. In the next chapter we will address how to combine categorical and continuous predictors in the same model.</p>
<section id="sec-interpretations-4" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sec-interpretations-4"><span class="header-section-number">4.1</span> Focus on interpretation</h2>
<p>Categorical predictors can be challenging to understand because, depending on the contrast coding used, the model results can appear quite different.</p>
<p>For example, the two models below use the same data and the same variables (Math Achievement regressed on Urbanicity), but their regression coefficients have different values. Why? Because the models used different contrast coding for Urbanicity. In the first model, Urban and Suburban students are compared to Rural students. In the second model, Rural and Suburban students are compared to the unweighted average across all three groups. We talk in more detail about these interpretations in the following sections. For now, the main thing to notice is just that “different contrast coding = different results”.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"NELS.RData"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(NELS)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># run model with default contrast (treatment / dummy coding)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>egA <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># change to sum / deviation contrasts and run again</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(urban)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rural"</span>, <span class="st">"Suburban"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>egB <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># print</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(egA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ urban)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3002  -6.1620   0.2098   6.7948  15.5573 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    54.9927     0.6885  79.876  &lt; 2e-16 ***
urbanSuburban   0.6675     0.9117   0.732  0.46439    
urbanUrban      3.1275     1.0480   2.984  0.00298 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.763 on 497 degrees of freedom
Multiple R-squared:  0.01904,   Adjusted R-squared:  0.0151 
F-statistic: 4.824 on 2 and 497 DF,  p-value: 0.008411</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(egB)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ urban)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3002  -6.1620   0.2098   6.7948  15.5573 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    56.2577     0.4021 139.897   &lt;2e-16 ***
urbanRural     -1.2650     0.5654  -2.237   0.0257 *  
urbanSuburban  -0.5975     0.5299  -1.128   0.2600    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.763 on 497 degrees of freedom
Multiple R-squared:  0.01904,   Adjusted R-squared:  0.0151 
F-statistic: 4.824 on 2 and 497 DF,  p-value: 0.008411</code></pre>
</div>
</div>
<p>Note that the <code>lm</code> output doesn’t explicitly tell us what kind of coding was used. So, we need to know what is going on “under the hood” in order to interpret the output correctly. Also note that the while the <em>Coefficients</em> tables of the two models are different, they both explain the same amount of variance in the outcome. So, we could say that both models “fit” the data equally well, but they provide different interpretations of the relationship between Math Achievement and Urbanicity.</p>
<p>The choice of which contrast to use is up to the researcher. This choice should reflect the research questions you want to address. For example, if we wanted to know how Urban and Suburban students differ from Rural students, that is what the first output shows us. If we wanted to know how Suburban and Rural students differ from the overall average, that is what the second output shows us. As we will discuss below, we can’t make all possible comparisons among groups in a single model, so we have to make some compromises when choosing contrasts. Understanding how to align our research questions with the choice of contrasts is a big part of what this chapter is about!</p>
</section>
<section id="sec-social-constructs-4" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sec-social-constructs-4"><span class="header-section-number">4.2</span> Data and social constructs</h2>
<p>Before getting into the math, let’s consider some conceptual points.</p>
<p>First, some terminology. <em>Binary</em> means the a variable can take on only two values: 1 and 0. If a variable takes on two values but these are represented with other numbers (e.g., 1 and 2) or with non-numeric values (“male”, “female”), it is called <em>dichotomous</em> rather than binary. Otherwise stated, a binary variable is a dichotomous variable whose values are 1 and 0. The term <em>categorical</em> is used to describe variables with two or more categories – it includes binary and dichotomous variables, as well as variables with more categories.</p>
<p>Note that encoding a variable as dichotomous does not imply that the underlying social construct is dichotomous. For example, we can encode educational attainment as a dichotomous variable indicating whether or not a person has graduated high school. This does not imply that educational attainment has only two values “irl”, or even that educational attainment is best conceptualized in terms of years of formal education. Nonetheless, for many outcomes of interest it can be meaningful to consider whether individuals have completed high school (e.g., <a href="https://www.ssa.gov/policy/docs/research-summaries/education-earnings.html">https://www.ssa.gov/policy/docs/research-summaries/education-earnings.html</a>).</p>
<p>In general, the way that a variable is encoded in a dataset is not a statement about reality – it reflects a choice made by researchers about how to represent social constructs. When conducting quantitative research, we are often faced with less-than-ideal encodings of social constructs, especially demographic variables. For example, both NELS and ECLS conceptualize gender as dichotomous and use a limited set of mutually exclusive categories for race. These representations are not well aligned with current literature on gender and racial identity. Some recent perspectives on how these issues play into quantitative research are available here: <a href="https://www.sree.org/critical-perspectives">https://www.sree.org/critical-perspectives</a>.</p>
<p>Despite the conceptual issues inherent in categorizing social constructs, I would argue that categorical variables often have utility, <em>especially</em> in the study of social inequality. Here is an example of why I think gender qua “male/female” is a flawed but important consideration in global education: <a href="https://www.unicef.org/education/girls-education">https://www.unicef.org/education/girls-education</a>.</p>
<p><strong>Please take a moment to write down your thoughts on the tensions that arise when conceptualizing social constructs such as gender or race as categorical, and I will invite you to share you thoughts in class.</strong></p>
</section>
<section id="sec-binary-predictors-4" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="sec-binary-predictors-4"><span class="header-section-number">4.3</span> Binary predictors</h2>
<p>Let’s start our interpretation of categorical predictors with the simplest case: a single binary predictor.</p>
<p><a href="#fig-reading-on-gender-4">Figure&nbsp;<span>4.1</span></a> uses the NELS data to illustrate the regression of Reading Achievement in Grade 8 (<code>achrdg08</code>) on a binary encoding of Gender (female = 0, male = 1). There isn’t a lot going on the plot! However, we can see the conditional distributions of Reading Achievement for each value of Gender, and the means of the two groups are indicated.</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't read this unless you really like working on graphics :) </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>) <span class="sc">*</span> <span class="dv">1</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(binary_gender, achrdg08, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#4B9CD3"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"binary gender (Female = 0, Male = 1)"</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Reading (Grade 8)"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(achrdg08, binary_gender, mean)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(Y)[<span class="dv">0</span>]), <span class="fu">expression</span>(<span class="fu">bar</span>(Y)[<span class="dv">1</span>]))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>), <span class="at">y =</span> means, <span class="at">labels =</span> labels, <span class="at">cex =</span> <span class="fl">1.5</span>) </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y =</span> means, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"_"</span>, <span class="st">"_"</span>), <span class="at">cex =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-reading-on-gender-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch4_categorical_predictors_files/figure-html/fig-reading-on-gender-4-1.png" class="img-fluid figure-img" width="480"></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: Reading Achievement on Binary Gender.</figcaption>
</figure>
</div>
</div>
</div>
<p>We can represent the relationship between Reading Achievement and Gender using the same simple regression equation from <a href="ch2_simple_regression.html#sec-regression-line-2"><span>Section&nbsp;2.2</span></a></p>
<p><span class="math display">\[\widehat Y = b_0 + b_1 X, \]</span></p>
<p>and we can still interpret the regression slope in terms of a one-unit increase in <span class="math inline">\(X\)</span>. However, since <span class="math inline">\(X\)</span> can only take on two values (0 or 1), there are also other interpretations of the regression coefficients. In this section we are interested in the these “more specific” interpretations of regression coefficients when <span class="math inline">\(X\)</span> is binary.</p>
<p>The general strategy for approaching the interpretation of regression coefficients with categorical predictors has two steps:</p>
<ul>
<li><em>Step 1.</em> Plug the values for <span class="math inline">\(X\)</span> into the regression equation to get the predicted values for each group <span class="math display">\[
\begin{align}
\widehat Y (Female) &amp; = b_0 + b_1 (0) = b_0 \\
\widehat Y (Male) &amp; = b_0 + b_1 (1) = b_0 + b_1
\end{align}
\]</span></li>
<li><em>Step 2.</em> Solve for the coefficients in terms the predicted values.</li>
</ul>
<p><span id="eq-binary-1"><span class="math display">\[ b_0 = \widehat Y (Female) \tag{4.1}\]</span></span> <span id="eq-binary-2"><span class="math display">\[ b_1  = \widehat Y (Male) - b_0 = \widehat Y (Male) - \widehat Y (Female)
\tag{4.2}\]</span></span></p>
<p>Looking at <a href="#eq-binary-1">Equation&nbsp;<span>4.1</span></a> we can see that intercept (<span class="math inline">\(b_0\)</span>) is equal to the predicted value of Reading Achievement for Females, and <a href="#eq-binary-2">Equation&nbsp;<span>4.2</span></a> shows that the regression slope (<span class="math inline">\(b_1\)</span>) is equal to the difference between predicted Reading Achievement for Males and Females.</p>
<p>There is one last detail that is important for interpreting these equations: for a single categorical predictor, the predicted values for each category are just the group means on the <span class="math inline">\(Y\)</span> variable (see <a href="#sec-categorical-results-4"><span>Section&nbsp;4.7</span></a>, which is optional).</p>
<p>So, using the notation of <a href="#fig-reading-on-gender-4">Figure&nbsp;<span>4.1</span></a>, we can re-write <a href="#eq-binary-1">Equation&nbsp;<span>4.1</span></a> and <a href="#eq-binary-2">Equation&nbsp;<span>4.2</span></a> as</p>
<p><span id="eq-binary-3"><span class="math display">\[b_0 = \bar Y_0   \tag{4.3}\]</span></span><br>
<span id="eq-binary-3"><span class="math display">\[ b_1 = \bar Y_1 - \bar Y_0  \tag{4.4}\]</span></span></p>
<p>We will use the equivalence between the predicted values and group means on the outcome variable throughout this chapter. However, it is important to note this equivalence holds only when there is single categorical predictor in the model, and no other predictors. Additional predictors are discussed in the next chapter.</p>
<p>For the example data, regression coefficients are:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert "Female / Male" coding to binary</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> NELS<span class="sc">$</span>gender</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>mod_binary <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> binary_gender)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod_binary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) binary_gender 
   56.4678022    -0.9223396 </code></pre>
</div>
</div>
<p><strong>Please take a moment and write down how these two numbers are related to <a href="#fig-reading-on-gender-4">Figure&nbsp;<span>4.1</span></a>. In particular, what is <span class="math inline">\(\bar Y_0\)</span> equal to, what is <span class="math inline">\(\bar Y_1\)</span> equal to, and what is their difference equal to?</strong></p>
<section id="sec-t-test-4" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="sec-t-test-4"><span class="header-section-number">4.3.1</span> Relation with t-tests of means</h3>
<p>Simple regression with a binary predictor is equivalent to conducting an independent samples t-test in which the <span class="math inline">\(X\)</span> variable (Gender) is the grouping variable and the <span class="math inline">\(Y\)</span> variable (Reading Achievement) is the outcome. The following output illustrates this.</p>
<p>For the regression model (same as above):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_binary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ binary_gender)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.7278  -6.1472   0.3784   6.9765  15.0045 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    56.4678     0.5342 105.703   &lt;2e-16 ***
binary_gender  -0.9223     0.7928  -1.163    0.245    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.827 on 498 degrees of freedom
Multiple R-squared:  0.00271,   Adjusted R-squared:  0.0007076 
F-statistic: 1.353 on 1 and 498 DF,  p-value: 0.2452</code></pre>
</div>
</div>
<p>For the independent samples t-test (with homogeneity of variance assumed):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(achrdg08 <span class="sc">~</span> binary_gender, <span class="at">var.equal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  achrdg08 by binary_gender
t = 1.1633, df = 498, p-value = 0.2452
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.6353793  2.4800586
sample estimates:
mean in group 0 mean in group 1 
       56.46780        55.54546 </code></pre>
</div>
</div>
<p>We will go through the comparison between these two outputs in class together. <strong>If you have any questions about the relation between these two sets of output, please note them now and be prepared ask them in class.</strong></p>
</section>
<section id="summary" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="summary"><span class="header-section-number">4.3.2</span> Summary</h3>
<p>When doing regression with a binary predictor:</p>
<ul>
<li><p>The regression intercept is equal to the mean of the group coded “0”.</p></li>
<li><p>The regression slope is equal to the mean of the group coded “0” subtracted from the mean of the groups coded “1”.</p></li>
<li><p>Testing <span class="math inline">\(H_0: b_1 = 0\)</span> is equivalent to testing the mean difference <span class="math inline">\(H_0: \mu_1 – \mu_0 = 0\)</span></p>
<ul>
<li>i.e., regression with a binary variable is the same as a t-test of means for independent groups.</li>
</ul></li>
</ul>
</section>
</section>
<section id="sec-reference-group-coding-4" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="sec-reference-group-coding-4"><span class="header-section-number">4.4</span> Reference-group coding</h2>
<p>Now that we know about regression with a binary predictor, let’s consider how to extend this approach to contrast coding of categorical predictors with <span class="math inline">\(C ≥ 2\)</span> categories.</p>
<p>The basic idea is to represent the <span class="math inline">\(C\)</span> categories of the predictor in terms of <span class="math inline">\(C – 1\)</span> “dummy variables.” Binary coding of a dichotomous predictor is one example of this: We represented a categorical variable with <span class="math inline">\(C = 2\)</span> categories using <span class="math inline">\(1\)</span> binary predictor.</p>
<p>For predictors with <span class="math inline">\(C ≥ 2\)</span> categories, the most common approach to contrast coding is called <em>reference-group</em> coding. In R, the approach is called <em>treatment contrasts</em> and is the default coding for categorical predictors.</p>
<p>It is called reference-group coding because:</p>
<ul>
<li>The researcher chooses a reference-group.</li>
<li>The intercept is interpreted as the mean of the reference-group.</li>
<li>The <span class="math inline">\(C – 1\)</span> regression slopes are interpreted as the mean differences between the <span class="math inline">\(C – 1\)</span> other groups and the reference-group.</li>
</ul>
<p>Note that reference-group coding is a generalization of binary coding. In the example from Section <a href="#sec-binary-predictors-4"><span>Section&nbsp;4.3</span></a>:</p>
<ul>
<li>Females were the reference-group.</li>
<li>The intercept was equal to the mean Reading Achievement for females.</li>
<li>The regression coefficient was equal to the mean difference between males and females.</li>
</ul>
<p>The rest of this section considers how to generalize this approach to greater than 2 groups.</p>
<section id="a-hypothetical-example" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="a-hypothetical-example"><span class="header-section-number">4.4.1</span> A hypothetical example</h3>
<p><a href="#fig-martital-status1">Figure&nbsp;<span>4.2</span></a> presents a toy example. The data show the Age and marital status (Mstatus) of 16 hypothetical individuals. Marital status is encoded as</p>
<ul>
<li>Single (never married)</li>
<li>Married</li>
<li>Divorced</li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/marital_status1.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-martital-status1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/marital_status1.png" class="img-fluid figure-img" width="348"></p>
<figcaption class="figure-caption">Figure&nbsp;4.2: Toy Martital Status Example.</figcaption>
</figure>
</div>
</div>
</div>
<p>These 3 categories are represented by two binary variables, denoted <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</p>
<ul>
<li><span class="math inline">\(X_1\)</span> is a binary variable that is equal to 1 when Mstatus is “married”, and equal to 0 otherwise.</li>
<li><span class="math inline">\(X_2\)</span> is a binary variable that is equal to 1 when Mstatus is “divorced”, and equal to 0 otherwise.</li>
</ul>
<p>The binary variables are often called <em>dummies</em> or <em>indicators</em>. For example, <span class="math inline">\(X_1\)</span> is a dummy or indicator for married respondents.</p>
<p>In reference-group coding, the group that does not have a dummy variable is the reference group. It is also the group that is coded zero on all of the included dummies. In this example, “Single” is the reference group.</p>
<p>We can more compactly write down the contrast coding in the example using a <em>contrast matrix</em> .</p>
<p><span class="math display">\[
\begin{matrix} &amp; X_1 &amp; X_2\\
                 \text{Married} &amp; 1 &amp; 0  \\
                 \text{Divorced} &amp; 0 &amp; 1 \\
                \text{Single}  &amp; 0 &amp; 0 \\
\end{matrix}
\]</span></p>
<p>This notation is an abbreviated version of the data matrix in <a href="#fig-martital-status1">Figure&nbsp;<span>4.2</span></a>. It summarizes how the two indicator variables correspond to the different levels of the categorical variable. As we will see in the <a href="#sec-exercises-4"><span>Section&nbsp;4.9</span></a>, contrast matrices are useful for programming in R.</p>
</section>
<section id="sec-reference-group-interpretation-4" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="sec-reference-group-interpretation-4"><span class="header-section-number">4.4.2</span> Interpreting the regression coefficients</h3>
<p>Regressing Age on the dummies we have:</p>
<p><span class="math display">\[ \widehat Y = b_0 + b_1 X_1 + b_2 X_2. \]</span></p>
<p>In order to interpret the regression coefficients we can use the same two steps as in <a href="#sec-binary-predictors-4"><span>Section&nbsp;4.3</span></a></p>
<ul>
<li><em>Step 1.</em> Plug the values for the <span class="math inline">\(X\)</span> variables into the regression equation to get the predicted values for each group</li>
</ul>
<p><span class="math display">\[\begin{align}
\widehat Y (Single) &amp; = b_0 + b_1 (0) + b_2 (0) = b_0 \\
\widehat Y (Married) &amp; = b_0 + b_1 (1) + b_2 (0) = b_0 + b_1 \\
\widehat Y (Divorced) &amp; = b_0 + b_1 (0) + b_2 (1) = b_0 + b_2
\end{align}\]</span></p>
<ul>
<li><em>Step 2.</em> Solve for the model parameters in terms the predicted values.</li>
</ul>
<p><span class="math display">\[\begin{align}
b_0 &amp; = \widehat Y (Single) \\
b_1 &amp; = \widehat Y (Married) - b_0 = \widehat Y (Married) - \widehat Y (Single) \\
b_2 &amp; = \widehat Y (Divorced) - b_0 = \widehat Y (Divorced) - \widehat Y (Single)
\end{align}\]</span></p>
<p><strong>Using the above equations, please write down an interpretation of the regression parameters for the hypothetical example. (Note: this question is not asking for a numerical answer, it is just asking you to put the above equations into words.)</strong></p>
</section>
<section id="sec-reference-group-more-than-three-4" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="sec-reference-group-more-than-three-4"><span class="header-section-number">4.4.3</span> More than 3 categories</h3>
<p><a href="#fig-martital-status2">Figure&nbsp;<span>4.3</span></a> extends the example by adding another category for Mstatus (“widowed”).</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/marital_status2.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-martital-status2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/marital_status2.png" class="img-fluid figure-img" width="419"></p>
<figcaption class="figure-caption">Figure&nbsp;4.3: Toy Martital Status Example, Part 2.</figcaption>
</figure>
</div>
</div>
</div>
<p>Here we are interested in the model</p>
<p><span class="math display">\[\widehat Y = b_0 + b_1 X_1 + b_2 X_2 + b_3 X_3\]</span></p>
<p><strong>Please work through the following questions and be prepared to share your answers in class</strong></p>
<ul>
<li><strong>How should <span class="math inline">\(X_3\)</span> be coded so that “single” is the reference-group?</strong></li>
<li><strong>Write down the contrast matrix for the example.</strong></li>
<li><strong>Using the two-step approach illustrated above, write out the interpretation of the regression coefficients.</strong></li>
<li><strong>Let’s imagine that we included an additional dummy variable for “Single” in the model. In this case we would have <span class="math inline">\(C = 4\)</span> dummies in the model rather than <span class="math inline">\(C-1 = 3\)</span> dummies. Please take a moment to write down what you think will happen (Hint: something goes wrong)</strong></li>
</ul>
</section>
<section id="summary-1" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="summary-1"><span class="header-section-number">4.4.4</span> Summary</h3>
<p>In reference-group coding with a single categorical variable:</p>
<ul>
<li><p>The reference is group is chosen by the analyst – it is the group that is coded zero on all dummies, or the one that has its indicator omitted from the model.</p></li>
<li><p>The intercept is interpreted as the mean of the reference group.</p></li>
<li><p>The regression coefficients of the dummy variables are interpreted as the difference between the mean of the indicated group and the mean of the reference group.</p></li>
</ul>
</section>
</section>
<section id="sec-deviation-coding-4" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="sec-deviation-coding-4"><span class="header-section-number">4.5</span> Deviation coding</h2>
<p>In some research scenarios, there is a clear reference group. For example, in an experiment, all treatment groups are can be compared to the control group. But in other cases, it is less clear what the reference group should be. In both of the examples we have considered so far (gender and marital status), the choice of reference group was arbitrary.</p>
<p>When there is not a clear reference group, it can be preferable to use other types of contrast coding than reference-group coding. One such approach is called <em>deviation coding</em>. In R, this is called <em>sum-to-zero constrasts</em>, or <em>sum</em> contrasts for short.</p>
<p>The main difference between deviation coding and reference-group coding is the interpretation of the intercept. In deviation coding, it is no longer the mean of the reference-group, but instead represents the mean of all groups’ predicted values. When the groups have equal sample size, the deviation-coded intercept is also equal to overall mean on <span class="math inline">\(Y\)</span>.</p>
<p>More specifically, in deviation coding:</p>
<ul>
<li>The intercept is equal to the mean of the predicted values for each category i.e.,</li>
</ul>
<p><span id="eq-unweighted-mean"><span class="math display">\[
b_0 = \frac{\sum_{c=1}^C \widehat Y_c} {C}
\tag{4.5}\]</span></span></p>
<ul>
<li>When the groups have equal sample sizes (<span class="math inline">\(n\)</span>), the intercept is also equal to the overall mean on the outcome variable:</li>
</ul>
<p><span class="math display">\[\begin{equation}
b_0 = \frac{\sum_{c=1}^C \widehat Y_c} {C}
= \frac{\sum_{c=1}^C \bar Y_c}{C} = \frac{\sum_{c=1}^C \left(\frac{\sum_{i=1}^n Y_{ic}}{n}\right)} {C} =  \frac{\sum_{c=1}^C \sum_{i=1}^n Y_{ic}}{nC} = \bar Y
\end{equation}\]</span></p>
<p>The regression slopes compare the each group to the intercept. Consequently, when the groups have equal sample sizes, the regression slopes are interpreted as the deviation of each group mean from the overall mean, which is why it is called deviation coding.</p>
<p>When the groups have unequal sample size, the situation is a bit more complicated. In particular, we have to weight the predicted values in <a href="#eq-unweighted-mean">Equation&nbsp;<span>4.5</span></a> by the group sample sizes. This is addressed in <a href="#sec-extra1-4"><span>Section&nbsp;4.5.4</span></a> (optional). To clarify that intercept in deviation coding is not always equal to <span class="math inline">\(\bar Y\)</span>, we refer to it as an “unweighted mean” of group means / predicted scores.</p>
<p>It is important to note that there are still only <span class="math inline">\(C-1\)</span> regression slopes So, one group gets left out of the analysis, and the researcher has to chose which one. This is a shortcoming of deviation coding, which is addressed in <a href="#sec-extra2-4"><span>Section&nbsp;4.5.5</span></a> (optional).</p>
<section id="sec-idela-4" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="sec-idela-4"><span class="header-section-number">4.5.1</span> A hypothetical example</h3>
<p>The International Development and Early Learning Assessment (IDELA) is an assessment designed to measure young children’s development in literacy, numeracy, social-emotional, and motor domains, in international settings. <a href="#fig-idela1">Figure&nbsp;<span>4.4</span></a> shows the countries in which the IDELA had been used as of 2017 (for more info, see <a href="https://www.savethechildren.net/sites/default/files/libraries/GS_0.pdf">https://www.savethechildren.net/sites/default/files/libraries/GS_0.pdf</a>).</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/idela_map.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-idela1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/idela_map.png" class="img-fluid figure-img" width="1471"></p>
<figcaption class="figure-caption">Figure&nbsp;4.4: IDELA Worldwide Usage, 2017.</figcaption>
</figure>
</div>
</div>
</div>
<p>If our goal was to compare countries’ IDELA scores, agreeing on which country should serve as the reference group would politically fraught. Therefore, it would be preferable to avoid the problem of choosing a reference group altogether. In particular, deviation coding let’s us compare each country’s mean IDELA score to the (unweighted) mean over all of the countries.</p>
<p><a href="#fig-idela2">Figure&nbsp;<span>4.5</span></a> presents a toy example. The data show the IDELA scores and Country for 16 hypothetical individuals. The countries considered in this example are</p>
<ul>
<li>Ethiopia</li>
<li>Vietnam</li>
<li>Boliva</li>
</ul>
<p>These 3 countries are represented by two binary variables, denoted <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>.</p>
<ul>
<li><span class="math inline">\(X_1\)</span> is a indicator for Ethiopia</li>
<li><span class="math inline">\(X_2\)</span> is a indicator for Vietnam</li>
</ul>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/idela1.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-idela2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/idela1.png" class="img-fluid figure-img" width="464"></p>
<figcaption class="figure-caption">Figure&nbsp;4.5: Toy IDELA Example.</figcaption>
</figure>
</div>
</div>
</div>
<p>Note that the dummy variables are different than for the case of reference-group coding discussed in <a href="#sec-reference-group-coding-4"><span>Section&nbsp;4.4</span></a>. In deviation coding, the dummies always take on values <span class="math inline">\(1, 0, -1\)</span>. The same group must receive the code <span class="math inline">\(-1\)</span> for all dummies. The group with the value <span class="math inline">\(-1\)</span> is the group that gets left out of the analysis.</p>
<p><strong>Please take a moment to write down the contrast matrix for the IDELA example.</strong></p>
</section>
<section id="sec-deviation-interpretation-4" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="sec-deviation-interpretation-4"><span class="header-section-number">4.5.2</span> Interpreting the regression coefficients</h3>
<p>Regressing IDELA on the dummies we have:</p>
<p><span class="math display">\[\widehat Y = b_0 + b_1 X_1 + b_2 X_2\]</span></p>
<p>In order to interpret the regression coefficients, we proceed using the same two steps as in <a href="#sec-binary-predictors-4"><span>Section&nbsp;4.3</span></a> and <a href="#sec-reference-group-coding-4"><span>Section&nbsp;4.4</span></a>.</p>
<ul>
<li><em>Step 1.</em> Plug the values for <span class="math inline">\(X\)</span> into the regression equation to get the predicted values for each group.</li>
</ul>
<p><span class="math display">\[\begin{align}
\widehat Y (Ethiopia) &amp; = b_0 + b_1 (1) + b_2 (0) = b_0 + b_1\\
\widehat Y (Vietnam) &amp; = b_0 + b_1 (0) + b_2 (1) = b_0 + b_2 \\
\widehat Y (Bolivia) &amp; = b_0 + b_1 (-1) + b_2 (-1) = b_0 - b_1 - b_2
\end{align}\]</span></p>
<ul>
<li><em>Step 2.</em> Solve for the model parameters in terms of the predicted values.</li>
</ul>
<p><span class="math display">\[\begin{align}
b_1 &amp;= \widehat Y (Ethiopia) - b_0 \\
b_2 &amp;= \widehat Y (Vietnam) - b_0 \\
b_0 &amp; = \widehat Y (Bolivia) + b_1 + b_2 \\  
\end{align}\]</span></p>
<p>At this point, we want to use the first two lines to substitute in for <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> in the last line:</p>
<p><span class="math display">\[\begin{align}
b_0 &amp; = \widehat Y (Bolivia) + \widehat Y (Ethiopia) - b_0 + \widehat Y (Vietnam) - b_0 \\
\implies &amp; \\
3b_0 &amp; = \widehat Y (Bolivia) + \widehat Y (Ethiopia) + \widehat Y (Vietnam) \\

\implies &amp; \\
b_0 &amp; = \frac{\widehat Y (Bolivia) + \widehat Y (Ethiopia) + \widehat Y (Vietnam)}{3}
\end{align}\]</span></p>
<p>In the last line we see that <span class="math inline">\(b_0\)</span> is equal to the (unweighted) mean of the predicted values.</p>
<p><strong>Using the above equations, please write down an interpretation of the regression parameters for the hypothetical example. (Note: this question is not asking for a numerical answer, it is just asking you to put the above equations into words.)</strong></p>
</section>
<section id="summary-2" class="level3" data-number="4.5.3">
<h3 data-number="4.5.3" class="anchored" data-anchor-id="summary-2"><span class="header-section-number">4.5.3</span> Summary</h3>
<p>In deviation coding with a single categorical variable:</p>
<ul>
<li><p>The intercept is interpreted as the unweighted mean of the groups’ means, which is equal to the overall mean on the <span class="math inline">\(Y\)</span> variable when the groups have equal sample sizes.</p></li>
<li><p>The regression slopes on the dummy variables are interpreted as the difference between the mean of the indicated group and the unweighted mean of the groups.</p></li>
<li><p>There are still only <span class="math inline">\(C - 1\)</span> regression coefficients, so one group gets left out (see extra material for how to get around this).</p></li>
</ul>
</section>
<section id="sec-extra1-4" class="level3" data-number="4.5.4">
<h3 data-number="4.5.4" class="anchored" data-anchor-id="sec-extra1-4"><span class="header-section-number">4.5.4</span> Extra: Deviation coding with unequal sample sizes*</h3>
<p>When groups have unequal sample size, the unweighted mean of the group means is not equial the overall mean of the <span class="math inline">\(Y\)</span> variable. This is not always a problem. In particular, in the IDELA example, it is reasonable that each country should receive equal weight, even if the size of the samples in each country differed.</p>
<p>However, if you want to compare each groups’ mean to the overall mean on <span class="math inline">\(Y\)</span>, deviation coding can be adjusted by replacing the dummy-coded value <span class="math inline">\(-1\)</span> with the ratio of indicated group’s sample size to the omitted group’s sample size. An example for 3 groups is shown below.</p>
<p><span class="math display">\[
\begin{matrix} &amp; \text{Dummy 1}&amp; \text{Dummy 2}\\
                   \text{Group 1} &amp; 1 &amp; 0  \\
                   \text{Group 2} &amp; 0 &amp; 1 \\
                  \text{Group 3}  &amp; - n_1 /n_3 &amp; - n_2 / n_3 \\
\end{matrix}
\]</span></p>
<p>You can use the 2-step procedure to show that this coding, called <em>weighted deviation coding</em>, results in</p>
<p><span class="math display">\[\begin{equation}
b_0 = \frac{n_1 \widehat Y( \text{Group 1}) + n_2 \widehat Y( \text{Group 2}) + n_3 \widehat Y( \text{Group 3})}{n_1 + n_2 + n_3}
\end{equation}\]</span></p>
<p>Replacing <span class="math inline">\(\widehat Y( \text{Group }c )\)</span> with <span class="math inline">\(\bar Y_c\)</span> you can also show that <span class="math inline">\(b_0 = \bar Y\)</span>, using the rules of summation algebra.</p>
<p>The punchline: unlike the case for the deviation coding, the intercept in <em>weighted deviation coding</em> is always equal to the overall mean on the outcome variance, regardless of the sample sizes of the groups. In R, you can use the package <code>wec</code> for weighted effect coding.</p>
</section>
<section id="sec-extra2-4" class="level3" data-number="4.5.5">
<h3 data-number="4.5.5" class="anchored" data-anchor-id="sec-extra2-4"><span class="header-section-number">4.5.5</span> Extra: Deviation coding with all groups included*</h3>
<p>Another shortcoming of deviation coding is that it requires leaving one group out of the model. As a work around, one can instead use the following approach. Note that this approach will affect the statistical significance of R-squared, so you should only use it if you aren’t interested in reporting R-squared (or are willing to do some more fiddling around with R).</p>
<ul>
<li>Step 1: Center the <span class="math inline">\(Y\)</span> variable so that <span class="math inline">\(\bar Y = 0\)</span>.</li>
<li>Step 2: Compute binary dummy variables (reference-group coding) for all <span class="math inline">\(C\)</span> groups, <span class="math inline">\(X_1, X_2, \dots, X_C\)</span></li>
<li>Step 3: Regress <span class="math inline">\(Y\)</span> on the all <span class="math inline">\(C\)</span> dummy variables, without the intercept in the model:</li>
</ul>
<p><span class="math display">\[\hat Y = b_1X_1 +  b_2 X_2 + \dots + b_cX_C.\]</span></p>
<p>Using the two step approach, it is easy to show that the regression coefficients are just the means of the indicated group. Since the overall mean of <span class="math inline">\(Y\)</span> is zero (because of Step 1), the group means can be interpreted as deviations from the overall mean on <span class="math inline">\(Y\)</span>.</p>
<p>Using the <code>lm</code> function in R, you can remove the intercept from the model using <code>-1</code> in the formula syntax:</p>
<p><code>Y ~ -1 + X1 + ...</code></p>
<p>As noted, this will affect the statistical significance of R-squared, as reported in <code>summary(lm)</code>. So, you shouldn’t use this approach when you want to report R-squared. The next two paragraphs explain why, but the explanation requires some material we won’t discuss until <span class="quarto-unresolved-ref">?sec-chap-6</span>.</p>
<p>The F-test of R-squared can be computed by comparing two different models, a reference model with no predictors and a focal model with the predictors. The reference model used by <code>lm</code> depends on whether the intercept is included in the focal model. If the focal model has an intercept, the reference model also has an intercept. In the focal model omits the intercept, the reference also omits the intercept.</p>
<p>In the present context, the focal model omits the intercept and use <span class="math inline">\(C\)</span> dummies This model has the same R-squared as if we had used the intercept and <span class="math inline">\(C-1\)</span> dummies. However, the F-statistic for the test of R-squared (as reported by <code>summary(lm)</code>) is different for the two approaches, because of the choice of reference model. You can change the reference model, but it takes a bit of fiddling around. If you are interested, just ask in class.</p>
</section>
</section>
<section id="relation-with-anova" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="relation-with-anova"><span class="header-section-number">4.6</span> Relation with ANOVA</h2>
<p>As mentioned in <a href="ch3_two_predictors.html"><span>Chapter&nbsp;3</span></a>, the F-test of R-squared is equivalent to simultaneously testing whether all of the regression slopes are equal to zero. In symbols:</p>
<p>Testing</p>
<p><span class="math display">\[H_0: R^2 = 0\]</span></p>
<p>is equivalent to testing</p>
<p><span class="math display">\[H_0: b_1 = b_2 = \cdots = b_{C-1} = 0\]</span> We have see above that the regression slopes can be interpreted in terms of group-mean differences. For example, under reference-group coding, we can re-write the null hypothesis above as:</p>
<p><span class="math display">\[H_0: \bar Y_1 - \bar Y_C = \bar Y_2 - \bar Y_C  = \cdots = \bar Y_{C-1} - \bar Y_C  = 0\]</span> In this notation, we let <span class="math inline">\(C\)</span> denote the reference group. If we add <span class="math inline">\(\bar Y_C\)</span> to each equality in the null hypothesis, we have</p>
<p><span class="math display">\[H_0: \bar Y_1 = \bar Y_2  = \cdots = \bar Y_{C-1}  =  \bar Y_C \]</span> Note that this is the same null hypothesis as one-way ANOVA – i.e., all the group means are equal. Consequently, the F-test of R-squared using a categorical predictor is equivalent to the F-test of the omnibus hypothesis in one-way ANOVA (assuming homoskedasticity). In <a href="#sec-exercises-4"><span>Section&nbsp;4.9</span></a>, we show how the two approaches produce the same numerical values.</p>
<p>Although regression with a categorical predictor is mathematically equivalent to one-way ANOVA, you may have noticed that the two approahces are not used in the same way. In ANOVA, we first conduct an F-test of the omnibus hypothesis, and, if the test is significant, we follow-up by comparing the groups using procedures that control for familywise error rate. In regression, we just report the F-test along with the test of the individual contrasts, without any discussion of familywise error rate control. Which approach is correct? Depends who you ask….</p>
</section>
<section id="sec-categorical-results-4" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="sec-categorical-results-4"><span class="header-section-number">4.7</span> Some details about categorical data*</h2>
<p>Check back later for:</p>
<ul>
<li>mean and variance of binary variables</li>
<li>covariance between binary variables and between binary and continuous</li>
<li>regression coefficient when X is binary</li>
</ul>
</section>
<section id="sec-workbook-4" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="sec-workbook-4"><span class="header-section-number">4.8</span> Workbook</h2>
<p>This section collects the questions asked in this chapter. The lesson for this chapter will focus on discussing these questions and then working on the exercises in <a href="#sec-exercises-4"><span>Section&nbsp;4.9</span></a>. The lesson will <strong>not</strong> be a lecture that reviews all of the material in the chapter! So, if you haven’t written down / thought about the answers to these questions before class, the lesson will not be very useful for you. Please engage with each question by writing down one or more answers, asking clarifying questions about related material, posing follow up questions, etc.</p>
<p><a href="#sec-social-constructs-4"><span>Section&nbsp;4.2</span></a></p>
<p>Please take a moment to write down your thoughts on the tensions that arise when conceptualizing social constructs such as gender or race as categorical, and I will invite you to share you thoughts in class.</p>
<p><a href="#sec-binary-predictors-4"><span>Section&nbsp;4.3</span></a></p>
<p>Please take a moment to write down how the regression output is related to the Figure. In particular, what is <span class="math inline">\(\bar Y_0\)</span> equal to, what is equal <span class="math inline">\(\bar Y_0\)</span> to, and what is their difference equal to?</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't read this unless you really like working on graphics :) </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>) <span class="sc">*</span> <span class="dv">1</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(binary_gender, achrdg08, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#4B9CD3"</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"binary gender (Female = 0, Male = 1)"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Reading (Grade 8)"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(achrdg08, binary_gender, mean)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(Y)[<span class="dv">0</span>]), <span class="fu">expression</span>(<span class="fu">bar</span>(Y)[<span class="dv">1</span>]))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>), <span class="at">y =</span> means, <span class="at">labels =</span> labels, <span class="at">cex =</span> <span class="fl">1.5</span>) </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y =</span> means, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"_"</span>, <span class="st">"_"</span>), <span class="at">cex =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="ch4_categorical_predictors_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert "Female / Male" coding to binary</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> NELS<span class="sc">$</span>gender</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>mod_binary <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> binary_gender)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod_binary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept) binary_gender 
   56.4678022    -0.9223396 </code></pre>
</div>
</div>
<p><a href="#sec-t-test-4"><span>Section&nbsp;4.3.1</span></a></p>
<p>We will go through the comparison between these two outputs in class together. If you have any questions about the relation between these two sets of output, please note them now and be prepared ask them in class.</p>
<p>Regression with a binary predictor:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_binary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ binary_gender)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.7278  -6.1472   0.3784   6.9765  15.0045 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    56.4678     0.5342 105.703   &lt;2e-16 ***
binary_gender  -0.9223     0.7928  -1.163    0.245    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.827 on 498 degrees of freedom
Multiple R-squared:  0.00271,   Adjusted R-squared:  0.0007076 
F-statistic: 1.353 on 1 and 498 DF,  p-value: 0.2452</code></pre>
</div>
</div>
<p>Independent samples t-test (with homogeneity of variance assumed):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(achrdg08 <span class="sc">~</span> binary_gender, <span class="at">var.equal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  achrdg08 by binary_gender
t = 1.1633, df = 498, p-value = 0.2452
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.6353793  2.4800586
sample estimates:
mean in group 0 mean in group 1 
       56.46780        55.54546 </code></pre>
</div>
</div>
<p><a href="#sec-reference-group-interpretation-4"><span>Section&nbsp;4.4.2</span></a></p>
<p>Regressing Age on the dummies we have:</p>
<p><span class="math display">\[ \widehat Y = b_0 + b_1 X_1 + b_2 X_2 \]</span></p>
<p>In order to interpret the regression coefficients we can use the same two steps as in <a href="#sec-binary-predictors-4"><span>Section&nbsp;4.3</span></a></p>
<ul>
<li><em>Step 1.</em> Plug the values for the <span class="math inline">\(X\)</span> variables into the regression equation to get the predicted values for each group</li>
</ul>
<p><span class="math display">\[\begin{align}
\widehat Y (Single) &amp; = b_0 + b_1 (0) + b_2 (0) = b_0 \\
\widehat Y (Married) &amp; = b_0 + b_1 (1) + b_2 (0) = b_0 + b_1 \\
\widehat Y (Divorced) &amp; = b_0 + b_1 (0) + b_2 (1) = b_0 + b_2
\end{align}\]</span></p>
<ul>
<li><em>Step 2.</em> Solve for the model parameters in terms the predicted values.</li>
</ul>
<p><span class="math display">\[\begin{align}
b_0 &amp; = \widehat Y (Single) \\
b_1 &amp; = \widehat Y (Married) - b_0 = \widehat Y (Married) - \widehat Y (Single) \\
b_2 &amp; = \widehat Y (Divorced) - b_0 = \widehat Y (Divorced) - \widehat Y (Single)
\end{align}\]</span></p>
<p>Using the above equations, please write down an interpretation of the regression parameters for the hypothetical example. (Note: this question is not asking for a numerical answer, it is just asking you to put the above equations into words.)</p>
<p><a href="#sec-reference-group-more-than-three-4"><span>Section&nbsp;4.4.3</span></a></p>
<p>The Mstatus example with 4 categories:</p>
<div class="cell" data-layout-align="center">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/marital_status2.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="files/images/marital_status2.png" class="img-fluid figure-img" width="419"></p>
</figure>
</div>
</div>
</div>
<p>Here we are interested in the model:</p>
<p><span class="math display">\[\widehat Y = b_0 + b_1 X_1 + b_2 X_2 + b_3 X_3\]</span></p>
<p>Please work through the following questions and be prepared to share your answers in class</p>
<ul>
<li>How should <span class="math inline">\(X_3\)</span> be coded so that “single” is the reference-group?</li>
<li>Write down the contrast matrix for the example.</li>
<li>Using the two-step approach illustrated above, write out the interpretation of the regression coefficients.</li>
<li>Let’s imagine that we included an additional dummy variable for “Single” in the model. In this case we would have <span class="math inline">\(C = 4\)</span> dummies in the model rather than <span class="math inline">\(C-1 = 3\)</span> dummies. Please take a moment to write down what you think will happen (Hint: something goes wrong).</li>
</ul>
<p><a href="#sec-idela-4"><span>Section&nbsp;4.5.1</span></a></p>
<p>Please take a moment to write down the contrast matrix for the IDELA example:</p>
<p><span class="math display">\[
\begin{matrix} &amp;  X_1 &amp; X_2 \\
                  \text{Ethiopia} &amp; ? &amp; ? \\
                  \text{Vietnam} &amp;?  &amp; ? \\
                  \text{Bolivia}  &amp; ? &amp; ? \\
\end{matrix}
\]</span></p>
<p><a href="#sec-deviation-interpretation-4"><span>Section&nbsp;4.5.2</span></a></p>
<p>Regressing IDELA on the dummies we have:</p>
<p><span class="math display">\[\widehat Y = b_0 + b_1 X_1 + b_2 X_2\]</span></p>
<p>In order to interpret the regression coefficients, we proceed using the same two steps as in <a href="#sec-binary-predictors-4"><span>Section&nbsp;4.3</span></a> and <a href="#sec-reference-group-coding-4"><span>Section&nbsp;4.4</span></a>.</p>
<ul>
<li><em>Step 1.</em> Plug the values for <span class="math inline">\(X\)</span> into the regression equation to get the predicted values for each group.</li>
</ul>
<p><span class="math display">\[\begin{align}
\widehat Y (Ethiopia) &amp; = b_0 + b_1 (1) + b_2 (0) = b_0 + b_1\\
\widehat Y (Vietnam) &amp; = b_0 + b_1 (0) + b_2 (1) = b_0 + b_2 \\
\widehat Y (Bolivia) &amp; = b_0 + b_1 (-1) + b_2 (-1) = b_0 - b_1 - b_2
\end{align}\]</span></p>
<ul>
<li><em>Step 2.</em> Solve for the model parameters in terms of the predicted values.</li>
</ul>
<p><span class="math display">\[\begin{align}
b_1 &amp;= \widehat Y (Ethiopia) - b_0 \\
b_2 &amp;= \widehat Y (Vietnam) - b_0 \\
b_0 &amp; = \widehat Y (Bolivia) + b_1 + b_2 \\  
\end{align}\]</span></p>
<p>At this point, we want to use the first two lines to substitute in for <span class="math inline">\(b_1\)</span> and <span class="math inline">\(b_2\)</span> in the last line, which leads to</p>
<p><span class="math display">\[\begin{align}
b_0 &amp; = \frac{\widehat Y (Bolivia) + \widehat Y (Ethiopia) + \widehat Y (Vietnam)}{3}
\end{align}\]</span></p>
<p>In the last line we see that <span class="math inline">\(b_0\)</span> is equal to the (unweighted) mean of the predicted values.</p>
<p>Using the above equations, please write down an interpretation of the regression parameters for the hypothetical example. (Note: this question is not asking for a numerical answer, it is just asking you to put the above equations into words.)</p>
</section>
<section id="sec-exercises-4" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="sec-exercises-4"><span class="header-section-number">4.9</span> Exercises</h2>
<p>These exercises provide an overview of contrast coding with categorical predictors in R. Two preliminary topics are also discussed: linear regression with a binary predictor, and the <code>factor</code> data class in R. We will go through this material in class together, so you don’t need to work on it before class (but you can if you want.)</p>
<p>Before staring this section, you may find it useful to scroll to the top of the page, click on the “&lt;/&gt; Code” menu, and select “Show All Code.”</p>
<section id="a-single-binary-predictor" class="level3" data-number="4.9.1">
<h3 data-number="4.9.1" class="anchored" data-anchor-id="a-single-binary-predictor"><span class="header-section-number">4.9.1</span> A single binary predictor</h3>
<p>Regression with a single binary predictor is equivalent to the independent samples t-test of group means. Let’s illustrate this using the NELS dataset with Reading achievement in grade 8 (<code>achrdg08</code>) as the outcome and <code>gender</code> as the predictor. Although gender need not be conceptualized as dichotomous or even categorical, the variable <code>gender</code> reported in NELS data is dichotomous, with values “Female” and “Male”.</p>
<p>R treats variables like <code>gender</code> as “factors”. Factors have special properties that we are going to work with later on, but for now let’s recode <code>gender</code> to <code>binary_gender</code> by setting <code>Female = 0</code> and <code>Male = 1</code></p>
</section>
<section id="recoding-a-factor-to-numeric" class="level3" data-number="4.9.2">
<h3 data-number="4.9.2" class="anchored" data-anchor-id="recoding-a-factor-to-numeric"><span class="header-section-number">4.9.2</span> Recoding a factor to numeric</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load("NELS.RData")</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># attach(NELS)</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that gender is non-numeric -- it is a factor with levels "Female" and "Male"</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Male   Female Male   Female Male   Female
Levels: Female Male</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A trick to create a binary indicator for males   </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>) <span class="sc">*</span> <span class="dv">1</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that the two variables are telling us the same thing</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gender, binary_gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        binary_gender
gender     0   1
  Female 273   0
  Male     0 227</code></pre>
</div>
</div>
<p>It is often hassle to get from factor to numeric or vice versa. Above we used a hack by of first creating a logical vector (<code>gender == "Male"</code>) and then coercing the logical vector to binary by multiplying it by 1. Other strategies can be used. See <code>help(factor)</code> for more information.</p>
</section>
<section id="binary-predictors-and-independent-samples-t-tests" class="level3" data-number="4.9.3">
<h3 data-number="4.9.3" class="anchored" data-anchor-id="binary-predictors-and-independent-samples-t-tests"><span class="header-section-number">4.9.3</span> Binary predictors and independent samples t-tests</h3>
<p>Now let’s get back to regressing Reading Achievement (<code>achrdg08</code>) on <code>binary_gender</code>, and comparing this to an independent samples t-test using the same two variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression with a binary variable</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> binary_gender)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ binary_gender)

Residuals:
     Min       1Q   Median       3Q      Max 
-20.7278  -6.1472   0.3784   6.9765  15.0045 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    56.4678     0.5342 105.703   &lt;2e-16 ***
binary_gender  -0.9223     0.7928  -1.163    0.245    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.827 on 498 degrees of freedom
Multiple R-squared:  0.00271,   Adjusted R-squared:  0.0007076 
F-statistic: 1.353 on 1 and 498 DF,  p-value: 0.2452</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to the output of t-test</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(achrdg08 <span class="sc">~</span> binary_gender, <span class="at">var.equal =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  achrdg08 by binary_gender
t = 1.1633, df = 498, p-value = 0.2452
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -0.6353793  2.4800586
sample estimates:
mean in group 0 mean in group 1 
       56.46780        55.54546 </code></pre>
</div>
</div>
<p>Note that:</p>
<ul>
<li>The intercept in <code>mod1</code> is equal the mean of the group coded 0 (females) in the t-test:</li>
</ul>
<p><span class="math display">\[b_0 = \bar Y_0 = 56.4678\]</span></p>
<ul>
<li>The b-weight in <code>mod1</code> is equal to difference between the means:</li>
</ul>
<p><span class="math display">\[b_1 = \bar Y_1 - \bar Y_0 = 55.54546 - 56.4678 = -0.9223\]</span></p>
<ul>
<li>The t-test of the b-weight, and its p-value, are equivalent to the t-test mean difference (except for the sign):</li>
</ul>
<p><span class="math display">\[ t(498) = 1.1633, p = .245\]</span></p>
<p>In summary, a t-test of a b-weight of a binary predictor is equal equivalent to a t-test of the mean difference.</p>
</section>
<section id="reference-group-coding" class="level3" data-number="4.9.4">
<h3 data-number="4.9.4" class="anchored" data-anchor-id="reference-group-coding"><span class="header-section-number">4.9.4</span> Reference-group coding</h3>
<p>As discussed in Section @ref(reference-group-coding-5), the basic idea of contrast coding is to replace a categorical variable with <span class="math inline">\(C\)</span> categories with <span class="math inline">\(C-1\)</span> “dummy” variables. In reference-group coding, the dummy variables are binary, and the resulting interpretation is:</p>
<ul>
<li><p>The intercept is interpreted as the mean of the reference group. The reference is group is chosen by the analyst – it is the group that is coded zero on all dummies, or the group whose dummy variable is “left out” of the <span class="math inline">\(C-1\)</span> dummy variables.</p></li>
<li><p>The regression coefficients of the dummy variables are interpreted as the difference between the mean of the indicated group and the mean of the reference group</p></li>
</ul>
<p>Reference-group coding is the default contrast coding in R. However, in order for contrast coding to be implemented, our categorical predictor needs to be represented in R as a <code>factor</code>.</p>
</section>
<section id="more-about-factors" class="level3" data-number="4.9.5">
<h3 data-number="4.9.5" class="anchored" data-anchor-id="more-about-factors"><span class="header-section-number">4.9.5</span> More about factors</h3>
<p>Factors are the way that R deals with categorical data. If you want to know if your variable is a factor or not, you can use the functions <code>class</code> or <code>is.factor</code>. Let’s illustrate this with the <code>urban</code> variable from NELS.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two ways of checking what type a variable is </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out the levels of a factor using "levels"</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Rural"    "Suburban" "Urban"   </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out what contrast coding R is using for a factor "constrasts"</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Rural Suburban
Rural        1        0
Suburban     0        1
Urban       -1       -1</code></pre>
</div>
</div>
<p>In the above code, we see that <code>urban</code> is a factor with 3 levels and the default reference-group contrasts are set up so that <code>Rural</code> is the reference group. Below we will show how to change the contrasts for a variable.</p>
<p>If we are working with a variable that is not a factor, but we want R to treat it as a factor, we can use the <code>factor</code> command. Let’s illustrate this by turning <code>binary_gender</code> back into a factor.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change a numeric variable into a factor</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(binary_gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>factor_gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(binary_gender)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(factor_gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(factor_gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "0" "1"</code></pre>
</div>
</div>
<p>We can also use the <code>levels</code> function to tell R what labels we want it to use for our factor. <code>levels</code> should be assigned a text vector with length equal to the number of levels of the variable. The entries of the assigned vector will be the new level names of the factor.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the levels of factor_gender to "F" and "M"</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(factor_gender) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(factor_gender)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Female" "Male"  </code></pre>
</div>
</div>
</section>
<section id="back-to-reference-group-coding" class="level3" data-number="4.9.6">
<h3 data-number="4.9.6" class="anchored" data-anchor-id="back-to-reference-group-coding"><span class="header-section-number">4.9.6</span> Back to reference-group coding</h3>
<p>OK, back to reference coding. Let’s see what <code>lm</code> does when we regress <code>achrdg08</code> on <code>urban</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ urban)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3002  -6.1620   0.2098   6.7948  15.5573 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    56.2577     0.4021 139.897   &lt;2e-16 ***
urbanRural     -1.2650     0.5654  -2.237   0.0257 *  
urbanSuburban  -0.5975     0.5299  -1.128   0.2600    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.763 on 497 degrees of freedom
Multiple R-squared:  0.01904,   Adjusted R-squared:  0.0151 
F-statistic: 4.824 on 2 and 497 DF,  p-value: 0.008411</code></pre>
</div>
</div>
<p>In the output, we see that two regression coefficients are reported, one for <code>Suburban</code> and one for <code>Urban</code>. As discussed in Section @ref(reference-group-coding-5), these coefficients are the mean difference between the indicated group and the reference group (<code>Rural</code>).</p>
<p>We can see that Urban students scores significantly higher than Rural students (3.125 percentage points), but there was no significant difference between Rural and Suburban students.</p>
<p>The intercept is the mean of the reference group (<code>rural</code>) – about 55% on the reading test.</p>
<p>Note the R-squared – Urbanicity accounts for about 2% of the variation reading achievement. As usual, the F-test of R-squared has degrees of freedom <span class="math inline">\(K\)</span> and <span class="math inline">\(N - K -1\)</span>, but now <span class="math inline">\(K\)</span> (the number of predictors) is equal to <span class="math inline">\(C - 1\)</span> – the number of categories minus one.</p>
</section>
<section id="changing-the-reference-group" class="level3" data-number="4.9.7">
<h3 data-number="4.9.7" class="anchored" data-anchor-id="changing-the-reference-group"><span class="header-section-number">4.9.7</span> Changing the reference group</h3>
<p>What if we wanted to use a group other than <code>Rural</code> as the reference group? We can chose a different reference group using the <code>cont.treatment</code> function. This function takes two arguments</p>
<ul>
<li><code>n</code> tells R how many levels there</li>
<li><code>base</code> tells R which level should be the reference group</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The current reference group is Rural</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Rural Suburban
Rural        1        0
Suburban     0        1
Urban       -1       -1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Chance the reference group to the Urban (i.e., the last level)</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban) <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">base =</span> <span class="dv">3</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         1 2
Rural    1 0
Suburban 0 1
Urban    0 0</code></pre>
</div>
</div>
<p>Note that when we first ran <code>contrasts(urban)</code>, the column names were names of the levels. But after changing the reference group, the column names are just the numbers 1 and 2. To help interpret the <code>lm</code> output, it is helpful to name the contrast levels appropriately</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Naming our new contrasts</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(urban)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rural"</span>, <span class="st">"Suburban"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         Rural Suburban
Rural        1        0
Suburban     0        1
Urban        0        0</code></pre>
</div>
</div>
<p>Now we are ready to run our regression again, this time using a different reference group.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ urban)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3002  -6.1620   0.2098   6.7948  15.5573 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    58.1202     0.7901  73.559  &lt; 2e-16 ***
urbanRural     -3.1275     1.0480  -2.984  0.00298 ** 
urbanSuburban  -2.4600     0.9907  -2.483  0.01335 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.763 on 497 degrees of freedom
Multiple R-squared:  0.01904,   Adjusted R-squared:  0.0151 
F-statistic: 4.824 on 2 and 497 DF,  p-value: 0.008411</code></pre>
</div>
</div>
<p>Compared to the output from <code>mod2</code>, note that</p>
<ul>
<li><p>The intercept now represents the mean reading scores of the Urban group, because this is the new reference group.</p></li>
<li><p>The regression coefficients now represent the mean difference between the indicated group with the new reference group.</p></li>
<li><p>The R-square and F stay the same – in other words, the total amount of variation explained by the variable <code>urban</code> does not change, just because we changed the reference group.</p></li>
</ul>
</section>
<section id="deviation-coding" class="level3" data-number="4.9.8">
<h3 data-number="4.9.8" class="anchored" data-anchor-id="deviation-coding"><span class="header-section-number">4.9.8</span> Deviation coding</h3>
<p>It is possible to change R’s default contrast coding to one of the other built-in contrasts (see <code>help(contrasts)</code> for more information on the built in contrasts).</p>
<p>For instance, to change to deviation coding, we use R’s <code>contr.sum</code> function and tell it how many levels there are for the factor (<code>n</code>). In deviation coding, the intercept is equal to the unweighted mean of the predicted values, and the regression coefficients are difference between the indicated group and the unweighted mean.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         [,1] [,2]
Rural       1    0
Suburban    0    1
Urban      -1   -1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># As above, it is helpful to name the contrasts using "colnames"</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(urban)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rural"</span>, <span class="st">"Suburban"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now we are all set to use deviation coding with <code>lm</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span>  urban)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ urban)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3002  -6.1620   0.2098   6.7948  15.5573 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    56.2577     0.4021 139.897   &lt;2e-16 ***
urbanRural     -1.2650     0.5654  -2.237   0.0257 *  
urbanSuburban  -0.5975     0.5299  -1.128   0.2600    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.763 on 497 degrees of freedom
Multiple R-squared:  0.01904,   Adjusted R-squared:  0.0151 
F-statistic: 4.824 on 2 and 497 DF,  p-value: 0.008411</code></pre>
</div>
</div>
<p>Note the following things about the output:</p>
<ul>
<li><p>The regression coefficients compare each group’s mean to the unweighted mean of the groups. Rural and Suburban students are below the unweighted mean, but the difference is only significant for Rural.</p></li>
<li><p>Although the output looks similar to that of <code>mod3</code>, the coefficients are all different and they all have different interpretations. The <code>lm</code> output doesn’t tell us this, we have to know what is going on under the hood.</p></li>
<li><p>The R-square does not change from <code>mod2</code> – again, the type of contrast coding used doesn’t affect how much variation is explained by the predictor.</p></li>
</ul>
</section>
<section id="extra-relation-to-anova" class="level3" data-number="4.9.9">
<h3 data-number="4.9.9" class="anchored" data-anchor-id="extra-relation-to-anova"><span class="header-section-number">4.9.9</span> Extra: Relation to ANOVA</h3>
<p>As our next exercise, let’s compare the output of <code>lm</code> and the output of <code>aov</code> – R’s module for Analysis of Variance. If regression and ANOVA are really doing the same thing, we should be able to illustrate it with these two modules. Note that if you check out <code>help(aov)</code>, it explicitly states that <code>aov</code> uses the <code>lm</code> function, so, finding that the two approaches give similar output shouldn’t be a big surprise!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run our model as an ANOVA</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the output with lm</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
urban         2    741   370.5   4.824 0.00841 **
Residuals   497  38163    76.8                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ urban)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3002  -6.1620   0.2098   6.7948  15.5573 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    56.2577     0.4021 139.897   &lt;2e-16 ***
urbanRural     -1.2650     0.5654  -2.237   0.0257 *  
urbanSuburban  -0.5975     0.5299  -1.128   0.2600    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.763 on 497 degrees of freedom
Multiple R-squared:  0.01904,   Adjusted R-squared:  0.0151 
F-statistic: 4.824 on 2 and 497 DF,  p-value: 0.008411</code></pre>
</div>
</div>
<p>If we compare the output from <code>aov</code> to the F-test reported by <code>lm</code> we see that the F-stat, degrees of freedom, and p-value are all identical. If we compute eta-squared from aov, we also find that it is equal to the R-squared value from <code>lm</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute eta-squared from aov output</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="dv">741</span> <span class="sc">/</span> (<span class="dv">741</span> <span class="sc">+</span> <span class="dv">38163</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01904688</code></pre>
</div>
</div>
<p>In short, ANOVA and regression are doing the same thing: R-squared is the same as omega-squared and the ANOVA omnibus F-test is the same as the F-test of R-squared. The main difference is that <code>lm</code> focuses on contrasts for analyzing and interpreting the group differences, whereas ANOVA focuses on the F-test of the omnibus hypothesis and the procedures for analyzing group difference are conducted as a follow-up step.</p>
</section>
<section id="extra-group-mean-coding" class="level3" data-number="4.9.10">
<h3 data-number="4.9.10" class="anchored" data-anchor-id="extra-group-mean-coding"><span class="header-section-number">4.9.10</span> Extra: Group-mean coding</h3>
<p>As a step towards addresses the issues with deviation coding, let’s consider another coding procedure. If we omit the intercept term, all of the reference-group coded dummies can be included and the regression coefficients now correspond to means of each group. We omit the intercept using <code>-1</code> in the model formula.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Omit the intercept using -1</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>mod5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> urban)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = achrdg08 ~ -1 + urban)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3002  -6.1620   0.2098   6.7948  15.5573 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
urbanRural     54.9927     0.6885   79.88   &lt;2e-16 ***
urbanSuburban  55.6602     0.5976   93.14   &lt;2e-16 ***
urbanUrban     58.1202     0.7901   73.56   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.763 on 497 degrees of freedom
Multiple R-squared:  0.9763,    Adjusted R-squared:  0.9761 
F-statistic:  6822 on 3 and 497 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Note the following things about the output:</p>
<ul>
<li><p>The coefficients are no <strong>longer interpreted mean differences</strong>, just the raw means.</p></li>
<li><p>The R-square and F-test <strong>do</strong> change from <code>mod2</code>. When the intercept is omitted, R-squared can no longer interpretated as a proportion of variance unless the variable <span class="math inline">\(Y\)</span> variable is centered. When the intercept is omitted, it also changes the degrees of freedom in the F-test, because there are now 3 predictors instead of 2. In general, when the intercept is omitted, R-square and its F-test do not have the usual interpretation. When reporting R-squared and its F-test, we should use a model with the intercept.</p></li>
</ul>
<p>By itself, group mean coding is not very interesting uninteresting – we don’t usually want to test whether the group means are different from zero. However, we will see in the next section that it can be used to provide an alternative to deviation coding.</p>
</section>
<section id="extra-weighted-versus-unweighted-deviation-coding" class="level3" data-number="4.9.11">
<h3 data-number="4.9.11" class="anchored" data-anchor-id="extra-weighted-versus-unweighted-deviation-coding"><span class="header-section-number">4.9.11</span> Extra: Weighted versus unweighted deviation coding</h3>
<p>This section presents a “hack” for addressing the two main issues with deviation coding noted in Section @ref(deviation-coding-5). This is a hack in the sense that we are working around R’s usual procedures rather than replacing them with a completely new procedure. The result of this hack is to provide deviation coding in which comparisons are made to grand mean on the outcome for all <span class="math inline">\(C\)</span> categories, not just <span class="math inline">\(C-1\)</span> categories. As a side effect, the F-test for the R-squared statistic is no longer correct, so you should not use this approach to report R-squared.</p>
<p>First, note that the group sample sizes are not equal for <code>ubran</code></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(urban)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>urban
   Rural Suburban    Urban 
     162      215      123 </code></pre>
</div>
</div>
<p>Because of this, the unweighted mean of the group means (i.e., the intercept in <code>mod4</code> above) is not equal to the overall mean on <code>achrdg08</code> – we can see that the overall mean and the unweighted group means are slightly different for these data:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>group_means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(achrdg08, <span class="at">INDEX =</span> urban, <span class="at">FUN =</span> mean)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>group_means</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Rural Suburban    Urban 
54.99265 55.66019 58.12016 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the overall mean and the unweighted mean of the group means</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the outcome variable</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(achrdg08)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>ybar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56.04906</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(group_means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56.25767</code></pre>
</div>
</div>
<p>Note that the intercept in <code>mod4</code> is not equal to the overall mean, <code>ybar</code>, but is instead equal to the unweighted average of the group means, <code>mean(group_means)</code>. the difference isnt very big in this example, but it can be quite drastic with highly unequal sample sizes.</p>
<p>If you would like to compare the groups to the overall mean when the sample sizes are unequal, the simplest way to do this in R is by first centering the Y variable and then using group mean coding.</p>
<p>After centering, the grand mean of <span class="math inline">\(Y\)</span> is zero, and so the group means represent deviations from the grand mean (i.e., deviations from zero) and the tests of the regression coefficients are tests of whether the group means are different from the grand mean.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the contrasts back to reference group</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban) <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">base  =</span> <span class="dv">1</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(urban)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Suburban"</span>, <span class="st">"Urban"</span>)</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the outcome variable</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>dev_achrdg08 <span class="ot">&lt;-</span> achrdg08 <span class="sc">-</span> ybar</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the regression with group mean coding</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>mod6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dev_achrdg08 <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> urban)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dev_achrdg08 ~ -1 + urban)

Residuals:
     Min       1Q   Median       3Q      Max 
-22.3002  -6.1620   0.2098   6.7948  15.5573 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
urbanRural     -1.0564     0.6885  -1.534  0.12556   
urbanSuburban  -0.3889     0.5976  -0.651  0.51554   
urbanUrban      2.0711     0.7901   2.621  0.00903 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.763 on 497 degrees of freedom
Multiple R-squared:  0.01904,   Adjusted R-squared:  0.01312 
F-statistic: 3.216 on 3 and 497 DF,  p-value: 0.02264</code></pre>
</div>
</div>
<p>Note the following things about the output:</p>
<ul>
<li><p>The regression coefficients compare each group’s mean to the overall mean on the outcome. Urban students are significantly above average, Rural and Suburban students are below average but the difference is not significant.</p></li>
<li><p>The R-square is the same as <code>mod2</code> because the Y variable is centered, but the F test <strong>does</strong> change from <code>mod2</code>, because there are now 3 variables included in the model. In general, when the intercept is omitted, R-square and its F-test do not have the usual interpretation. So, when reporting R-squared and F-test, we should use a model with the intercept, rather than the approach outlined here.</p></li>
</ul>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch3_two_predictors.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Two predictors</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb83" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="an">fold:</span><span class="co"> true</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Categorical predictors {#sec-chap-4}</span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>So far we have considered examples in which we regress a continuous outcome variable (e.g., Math Achievement) on one or more continuous predictors (SES, Approaches to Learning). In this chapter we consider how regression can be used with categorical predictors. </span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>In an experimental context, the canonical example of a categorical predictor is treatment status (e.g.,  1 = treatment group, 0 = control group). Examples of other categorical predictors commonly used in education research include: </span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Geographical region / school district  (Orange, CH-C, Wake, …)</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Type of school (public, private, charter, religious)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Which classroom, teacher, or school a student was assigned to</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Gender (if recorded as categorical)</span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Race  / ethnicity (if recorded as categorical) </span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Free / reduced price lunch status </span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>English language learner status</span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Individualized learning plan status</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>...</span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>In regression, we deal with these types of predictors using an approach called *contrast coding* (also called *effect coding* or *dummy coding*). </span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>In particular, we will address three types of contrast coding: </span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The special case of a single binary predictor</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Reference-group coding (called "treatment" contrasts in R)</span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Deviation coding (called "sum" contrasts in R)</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-31"><a href="#cb83-31" aria-hidden="true" tabindex="-1"></a>There are other types of contrast coding out there. We do not attempt an exhaustive review. However, the techniques we use in this chapter can be used with other types of contrast coding. </span>
<span id="cb83-32"><a href="#cb83-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-33"><a href="#cb83-33" aria-hidden="true" tabindex="-1"></a>Along the way we will see that regression with a categorical predictor encompasses the independent samples t-tests of means and one-way ANOVA, both of which we discussed last semester. In the next chapter we will address how to combine categorical and continuous predictors in the same model. </span>
<span id="cb83-34"><a href="#cb83-34" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb83-35"><a href="#cb83-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Focus on interpretation  {#sec-interpretations-4}</span></span>
<span id="cb83-36"><a href="#cb83-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-37"><a href="#cb83-37" aria-hidden="true" tabindex="-1"></a>Categorical predictors can be challenging to understand because, depending on the contrast coding used, the model results can appear quite different.</span>
<span id="cb83-38"><a href="#cb83-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-39"><a href="#cb83-39" aria-hidden="true" tabindex="-1"></a>For example, the two models below use the same data and the same variables (Math Achievement regressed on Urbanicity), but their regression coefficients have different values. Why? Because the models used different contrast coding for  Urbanicity. In the first model, Urban and Suburban students are compared to Rural students. In the second model, Rural and Suburban students are compared to the unweighted average across all three groups. We talk in more detail about these interpretations in the following sections. For now, the main thing to notice is just that "different contrast coding = different results". </span>
<span id="cb83-40"><a href="#cb83-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-41"><a href="#cb83-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-42"><a href="#cb83-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-45"><a href="#cb83-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-46"><a href="#cb83-46" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"NELS.RData"</span>)</span>
<span id="cb83-47"><a href="#cb83-47" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(NELS)</span>
<span id="cb83-48"><a href="#cb83-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-49"><a href="#cb83-49" aria-hidden="true" tabindex="-1"></a><span class="co"># run model with default contrast (treatment / dummy coding)</span></span>
<span id="cb83-50"><a href="#cb83-50" aria-hidden="true" tabindex="-1"></a>egA <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb83-51"><a href="#cb83-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-52"><a href="#cb83-52" aria-hidden="true" tabindex="-1"></a><span class="co"># change to sum / deviation contrasts and run again</span></span>
<span id="cb83-53"><a href="#cb83-53" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb83-54"><a href="#cb83-54" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(urban)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rural"</span>, <span class="st">"Suburban"</span>)</span>
<span id="cb83-55"><a href="#cb83-55" aria-hidden="true" tabindex="-1"></a>egB <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb83-56"><a href="#cb83-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-57"><a href="#cb83-57" aria-hidden="true" tabindex="-1"></a><span class="co"># print</span></span>
<span id="cb83-58"><a href="#cb83-58" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(egA)</span>
<span id="cb83-59"><a href="#cb83-59" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(egB)</span>
<span id="cb83-60"><a href="#cb83-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-61"><a href="#cb83-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-62"><a href="#cb83-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-63"><a href="#cb83-63" aria-hidden="true" tabindex="-1"></a>Note that the <span class="in">`lm`</span> output doesn’t explicitly tell us what kind of coding was used. So, we need to know what is going on “under the hood” in order to interpret the output correctly. Also note that the while the *Coefficients* tables of the two models are different, they both explain the same amount of variance in the outcome. So, we could say that both models "fit" the data equally well, but they provide different interpretations of the relationship between Math Achievement and Urbanicity. </span>
<span id="cb83-64"><a href="#cb83-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-65"><a href="#cb83-65" aria-hidden="true" tabindex="-1"></a>The choice of which contrast to use is up to the researcher. This choice should reflect the research questions you want to address. For example, if we wanted to know how Urban and Suburban students differ from Rural students, that is what the first output shows us. If we wanted to know how Suburban and Rural students differ from the overall average, that is what the second output shows us. As we will discuss below, we can't make all possible comparisons among groups in a single model, so we have to make some compromises when choosing contrasts. Understanding how to align our research questions with the choice of contrasts is a big part of what this chapter is about!</span>
<span id="cb83-66"><a href="#cb83-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-67"><a href="#cb83-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-68"><a href="#cb83-68" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data and social constructs {#sec-social-constructs-4}</span></span>
<span id="cb83-69"><a href="#cb83-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-70"><a href="#cb83-70" aria-hidden="true" tabindex="-1"></a>Before getting into the math, let's consider some conceptual points. </span>
<span id="cb83-71"><a href="#cb83-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-72"><a href="#cb83-72" aria-hidden="true" tabindex="-1"></a>First, some terminology. *Binary* means the a variable can take on only two values: 1 and 0. If a variable takes on two values but these are represented with other numbers (e.g., 1 and 2) or with non-numeric values ("male", "female"), it is called *dichotomous* rather than binary. Otherwise stated, a binary variable is a dichotomous variable whose values are 1 and 0. The term *categorical* is used to describe variables with two or more categories -- it includes binary and dichotomous variables, as well as variables with more categories. </span>
<span id="cb83-73"><a href="#cb83-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-74"><a href="#cb83-74" aria-hidden="true" tabindex="-1"></a>Note that encoding a variable as dichotomous does not imply that the underlying social construct is dichotomous. For example, we can encode educational attainment as a dichotomous variable indicating whether or not a person has graduated high school. This does not imply that educational attainment has only two values "irl", or even that educational attainment is best conceptualized in terms of years of formal education. Nonetheless, for many outcomes of interest it can be meaningful to consider whether individuals have completed high school (e.g., <span class="co">[</span><span class="ot">https://www.ssa.gov/policy/docs/research-summaries/education-earnings.html</span><span class="co">](https://www.ssa.gov/policy/docs/research-summaries/education-earnings.html)</span>).</span>
<span id="cb83-75"><a href="#cb83-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-76"><a href="#cb83-76" aria-hidden="true" tabindex="-1"></a>In general, the way that a variable is encoded in a dataset is not a statement about reality -- it reflects a choice made by researchers about how to represent social constructs. When conducting quantitative research, we are often faced with less-than-ideal encodings of social constructs, especially demographic variables. For example, both NELS and ECLS conceptualize gender as dichotomous and use a limited set of mutually exclusive categories for race. These representations are not well aligned with current literature on gender and racial identity. Some recent perspectives on how these issues play into quantitative research are available here: <span class="co">[</span><span class="ot">https://www.sree.org/critical-perspectives</span><span class="co">](https://www.sree.org/critical-perspectives)</span>. </span>
<span id="cb83-77"><a href="#cb83-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-78"><a href="#cb83-78" aria-hidden="true" tabindex="-1"></a>Despite the conceptual issues inherent in categorizing social constructs,  I would argue that categorical variables often have utility, *especially* in the study of social inequality. Here is an example of why I think gender qua "male/female" is a flawed but important consideration in global education: <span class="co">[</span><span class="ot">https://www.unicef.org/education/girls-education</span><span class="co">](https://www.unicef.org/education/girls-education)</span>.</span>
<span id="cb83-79"><a href="#cb83-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-80"><a href="#cb83-80" aria-hidden="true" tabindex="-1"></a>**Please take a moment to write down your thoughts on the tensions that arise when conceptualizing social constructs such as gender or race as categorical, and I will invite you to share you thoughts in class.**</span>
<span id="cb83-81"><a href="#cb83-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-82"><a href="#cb83-82" aria-hidden="true" tabindex="-1"></a><span class="fu">## Binary predictors {#sec-binary-predictors-4}</span></span>
<span id="cb83-83"><a href="#cb83-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-84"><a href="#cb83-84" aria-hidden="true" tabindex="-1"></a>Let's start our interpretation of categorical predictors with the simplest case: a single binary predictor. </span>
<span id="cb83-85"><a href="#cb83-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-86"><a href="#cb83-86" aria-hidden="true" tabindex="-1"></a>@fig-reading-on-gender-4 uses the NELS data to illustrate the regression of Reading Achievement in Grade 8 (<span class="in">`achrdg08`</span>) on a binary encoding of Gender (female = 0, male = 1). There isn't a lot going on the plot! However, we can see the conditional distributions of Reading Achievement for each value of Gender, and the means of the two groups are indicated. </span>
<span id="cb83-87"><a href="#cb83-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-88"><a href="#cb83-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-reading-on-gender-4, fig.cap = 'Reading Achievement on Binary Gender.', fig.align = 'center', fig.width=5}</span></span>
<span id="cb83-89"><a href="#cb83-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-90"><a href="#cb83-90" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't read this unless you really like working on graphics :) </span></span>
<span id="cb83-91"><a href="#cb83-91" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>) <span class="sc">*</span> <span class="dv">1</span> </span>
<span id="cb83-92"><a href="#cb83-92" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(binary_gender, achrdg08, </span>
<span id="cb83-93"><a href="#cb83-93" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#4B9CD3"</span>, </span>
<span id="cb83-94"><a href="#cb83-94" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"binary gender (Female = 0, Male = 1)"</span>,</span>
<span id="cb83-95"><a href="#cb83-95" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Reading (Grade 8)"</span>)</span>
<span id="cb83-96"><a href="#cb83-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-97"><a href="#cb83-97" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(achrdg08, binary_gender, mean)</span>
<span id="cb83-98"><a href="#cb83-98" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(Y)[<span class="dv">0</span>]), <span class="fu">expression</span>(<span class="fu">bar</span>(Y)[<span class="dv">1</span>]))</span>
<span id="cb83-99"><a href="#cb83-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-100"><a href="#cb83-100" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>), <span class="at">y =</span> means, <span class="at">labels =</span> labels, <span class="at">cex =</span> <span class="fl">1.5</span>) </span>
<span id="cb83-101"><a href="#cb83-101" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y =</span> means, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"_"</span>, <span class="st">"_"</span>), <span class="at">cex =</span> <span class="dv">2</span>) </span>
<span id="cb83-102"><a href="#cb83-102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-103"><a href="#cb83-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-104"><a href="#cb83-104" aria-hidden="true" tabindex="-1"></a>We can represent the relationship between Reading Achievement and Gender using the same simple regression equation from @sec-regression-line-2</span>
<span id="cb83-105"><a href="#cb83-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-106"><a href="#cb83-106" aria-hidden="true" tabindex="-1"></a>$$\widehat Y = b_0 + b_1 X, $$</span>
<span id="cb83-107"><a href="#cb83-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-108"><a href="#cb83-108" aria-hidden="true" tabindex="-1"></a>and we can still interpret the regression slope in terms of a one-unit increase in $X$. However, since $X$ can only take on two values (0 or 1), there are also other interpretations of the regression coefficients. In this section we are interested in the these "more specific" interpretations of regression coefficients when $X$ is binary. </span>
<span id="cb83-109"><a href="#cb83-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-110"><a href="#cb83-110" aria-hidden="true" tabindex="-1"></a>The general strategy for approaching the interpretation of regression coefficients with categorical predictors has two steps:</span>
<span id="cb83-111"><a href="#cb83-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-112"><a href="#cb83-112" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 1.* Plug the values for $X$ into the regression equation to get the predicted values for each group</span>
<span id="cb83-113"><a href="#cb83-113" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-114"><a href="#cb83-114" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-115"><a href="#cb83-115" aria-hidden="true" tabindex="-1"></a>\widehat Y (Female) &amp; = b_0 + b_1 (0) = b_0 <span class="sc">\\</span> </span>
<span id="cb83-116"><a href="#cb83-116" aria-hidden="true" tabindex="-1"></a>\widehat Y (Male) &amp; = b_0 + b_1 (1) = b_0 + b_1 </span>
<span id="cb83-117"><a href="#cb83-117" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-118"><a href="#cb83-118" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-119"><a href="#cb83-119" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 2.* Solve for the coefficients in terms the predicted values. </span>
<span id="cb83-120"><a href="#cb83-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-121"><a href="#cb83-121" aria-hidden="true" tabindex="-1"></a>$$ b_0 = \widehat Y (Female)$$ {#eq-binary-1}</span>
<span id="cb83-122"><a href="#cb83-122" aria-hidden="true" tabindex="-1"></a>$$ b_1  = \widehat Y (Male) - b_0 = \widehat Y (Male) - \widehat Y (Female) </span>
<span id="cb83-123"><a href="#cb83-123" aria-hidden="true" tabindex="-1"></a>$$ {#eq-binary-2}</span>
<span id="cb83-124"><a href="#cb83-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-125"><a href="#cb83-125" aria-hidden="true" tabindex="-1"></a>Looking at @eq-binary-1 we can see that intercept ($b_0$) is equal to the predicted value of Reading Achievement for Females, and @eq-binary-2 shows that the regression slope ($b_1$) is equal to the difference between predicted Reading Achievement for Males and Females. </span>
<span id="cb83-126"><a href="#cb83-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-127"><a href="#cb83-127" aria-hidden="true" tabindex="-1"></a>There is one last detail that is important for interpreting these equations: for a single categorical predictor, the predicted values for each category are just the group means on the $Y$ variable (see @sec-categorical-results-4, which is optional). </span>
<span id="cb83-128"><a href="#cb83-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-129"><a href="#cb83-129" aria-hidden="true" tabindex="-1"></a>So, using the notation of @fig-reading-on-gender-4, we can re-write @eq-binary-1 and @eq-binary-2 as</span>
<span id="cb83-130"><a href="#cb83-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-131"><a href="#cb83-131" aria-hidden="true" tabindex="-1"></a>$$b_0 = \bar Y_0  $$ {#eq-binary-3}  </span>
<span id="cb83-132"><a href="#cb83-132" aria-hidden="true" tabindex="-1"></a>$$ b_1 = \bar Y_1 - \bar Y_0 $${#eq-binary-3}  </span>
<span id="cb83-133"><a href="#cb83-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-134"><a href="#cb83-134" aria-hidden="true" tabindex="-1"></a>We will use the equivalence between the predicted values and group means on the outcome variable throughout this chapter. However, it is important to note this equivalence holds only when there is single categorical predictor in the model, and no other predictors. Additional predictors are discussed in the next chapter. </span>
<span id="cb83-135"><a href="#cb83-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-136"><a href="#cb83-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-137"><a href="#cb83-137" aria-hidden="true" tabindex="-1"></a>For the example data, regression coefficients are: </span>
<span id="cb83-138"><a href="#cb83-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-141"><a href="#cb83-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-142"><a href="#cb83-142" aria-hidden="true" tabindex="-1"></a><span class="co"># convert "Female / Male" coding to binary</span></span>
<span id="cb83-143"><a href="#cb83-143" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> NELS<span class="sc">$</span>gender</span>
<span id="cb83-144"><a href="#cb83-144" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb83-145"><a href="#cb83-145" aria-hidden="true" tabindex="-1"></a>mod_binary <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> binary_gender)</span>
<span id="cb83-146"><a href="#cb83-146" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod_binary)</span>
<span id="cb83-147"><a href="#cb83-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-148"><a href="#cb83-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-149"><a href="#cb83-149" aria-hidden="true" tabindex="-1"></a>**Please take a moment and write down how these two numbers are related to @fig-reading-on-gender-4. In particular, what is $\bar Y_0$ equal to, what is $\bar Y_1$ equal to, and what is their difference equal to?**</span>
<span id="cb83-150"><a href="#cb83-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-151"><a href="#cb83-151" aria-hidden="true" tabindex="-1"></a><span class="fu">### Relation with t-tests of means {#sec-t-test-4}</span></span>
<span id="cb83-152"><a href="#cb83-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-153"><a href="#cb83-153" aria-hidden="true" tabindex="-1"></a>Simple regression with a binary predictor is equivalent to conducting an independent samples t-test in which the $X$ variable (Gender) is the grouping variable and the $Y$ variable (Reading Achievement) is the outcome. The following output illustrates this. </span>
<span id="cb83-154"><a href="#cb83-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-155"><a href="#cb83-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-156"><a href="#cb83-156" aria-hidden="true" tabindex="-1"></a>For the regression model (same as above): </span>
<span id="cb83-159"><a href="#cb83-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-160"><a href="#cb83-160" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_binary)</span>
<span id="cb83-161"><a href="#cb83-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-162"><a href="#cb83-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-163"><a href="#cb83-163" aria-hidden="true" tabindex="-1"></a>For the independent samples t-test (with homogeneity of variance assumed): </span>
<span id="cb83-166"><a href="#cb83-166" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-167"><a href="#cb83-167" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(achrdg08 <span class="sc">~</span> binary_gender, <span class="at">var.equal =</span> T)</span>
<span id="cb83-168"><a href="#cb83-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-169"><a href="#cb83-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-170"><a href="#cb83-170" aria-hidden="true" tabindex="-1"></a>We will go through the comparison between these two outputs in class together. </span>
<span id="cb83-171"><a href="#cb83-171" aria-hidden="true" tabindex="-1"></a>**If you have any questions about the relation between these two sets of output, please note them now and be prepared ask them in class.**</span>
<span id="cb83-172"><a href="#cb83-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-173"><a href="#cb83-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-174"><a href="#cb83-174" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb83-175"><a href="#cb83-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-176"><a href="#cb83-176" aria-hidden="true" tabindex="-1"></a>When doing regression with a binary predictor: </span>
<span id="cb83-177"><a href="#cb83-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-178"><a href="#cb83-178" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The regression intercept is equal to the mean of the group coded "0".</span>
<span id="cb83-179"><a href="#cb83-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-180"><a href="#cb83-180" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The regression slope is equal to the mean of the group coded "0" subtracted from the mean of the groups coded "1". </span>
<span id="cb83-181"><a href="#cb83-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-182"><a href="#cb83-182" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Testing $H_0: b_1 = 0$ is equivalent to testing the mean difference $H_0: \mu_1 – \mu_0 = 0$</span>
<span id="cb83-183"><a href="#cb83-183" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>i.e., regression with a binary variable is the same as a t-test of means for independent groups.</span>
<span id="cb83-184"><a href="#cb83-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-185"><a href="#cb83-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-186"><a href="#cb83-186" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reference-group coding {#sec-reference-group-coding-4}</span></span>
<span id="cb83-187"><a href="#cb83-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-188"><a href="#cb83-188" aria-hidden="true" tabindex="-1"></a>Now that we know about regression with a binary predictor, let's consider how to extend this approach to contrast coding of categorical predictors with $C ≥ 2$ categories. </span>
<span id="cb83-189"><a href="#cb83-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-190"><a href="#cb83-190" aria-hidden="true" tabindex="-1"></a>The basic idea is to represent the $C$ categories of the predictor in terms of $C – 1$ "dummy variables." Binary coding of a dichotomous predictor is one example of this: We represented a categorical variable with $C = 2$ categories using $1$ binary predictor. </span>
<span id="cb83-191"><a href="#cb83-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-192"><a href="#cb83-192" aria-hidden="true" tabindex="-1"></a>For predictors with $C ≥ 2$ categories, the most common approach to contrast coding is called *reference-group* coding. In R, the approach is called *treatment contrasts* and is the default coding for categorical predictors. </span>
<span id="cb83-193"><a href="#cb83-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-194"><a href="#cb83-194" aria-hidden="true" tabindex="-1"></a>It is called reference-group coding because:</span>
<span id="cb83-195"><a href="#cb83-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-196"><a href="#cb83-196" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The researcher chooses a reference-group.</span>
<span id="cb83-197"><a href="#cb83-197" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The intercept is interpreted as the mean of the reference-group. </span>
<span id="cb83-198"><a href="#cb83-198" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The $C – 1$ regression slopes are interpreted as the mean differences between the $C – 1$ other groups and the reference-group.</span>
<span id="cb83-199"><a href="#cb83-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-200"><a href="#cb83-200" aria-hidden="true" tabindex="-1"></a>Note that reference-group coding is a generalization of binary coding. In the example from Section @sec-binary-predictors-4:</span>
<span id="cb83-201"><a href="#cb83-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-202"><a href="#cb83-202" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Females were the reference-group. </span>
<span id="cb83-203"><a href="#cb83-203" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The intercept was equal to the mean Reading Achievement for females.</span>
<span id="cb83-204"><a href="#cb83-204" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The regression coefficient was equal to the mean difference between males and females. </span>
<span id="cb83-205"><a href="#cb83-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-206"><a href="#cb83-206" aria-hidden="true" tabindex="-1"></a>The rest of this section considers how to generalize this approach to greater than 2 groups.</span>
<span id="cb83-207"><a href="#cb83-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-208"><a href="#cb83-208" aria-hidden="true" tabindex="-1"></a><span class="fu">### A hypothetical example</span></span>
<span id="cb83-209"><a href="#cb83-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-210"><a href="#cb83-210" aria-hidden="true" tabindex="-1"></a>@fig-martital-status1 presents a toy example. The data show the Age and marital status (Mstatus) of 16 hypothetical individuals. Marital status is encoded as </span>
<span id="cb83-211"><a href="#cb83-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-212"><a href="#cb83-212" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Single (never married)</span>
<span id="cb83-213"><a href="#cb83-213" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Married</span>
<span id="cb83-214"><a href="#cb83-214" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Divorced</span>
<span id="cb83-215"><a href="#cb83-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-216"><a href="#cb83-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-217"><a href="#cb83-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-martital-status1, fig.cap = 'Toy Martital Status Example.', fig.align = 'center'}</span></span>
<span id="cb83-218"><a href="#cb83-218" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/marital_status1.png"</span>)</span>
<span id="cb83-219"><a href="#cb83-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-220"><a href="#cb83-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-221"><a href="#cb83-221" aria-hidden="true" tabindex="-1"></a>These 3 categories are represented by two binary variables, denoted $X_1$ and $X_2$. </span>
<span id="cb83-222"><a href="#cb83-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-223"><a href="#cb83-223" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$X_1$ is a binary variable that is equal to 1 when Mstatus is "married", and equal to 0 otherwise. </span>
<span id="cb83-224"><a href="#cb83-224" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$X_2$ is a binary variable that is equal to 1 when Mstatus is "divorced", and equal to 0 otherwise. </span>
<span id="cb83-225"><a href="#cb83-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-226"><a href="#cb83-226" aria-hidden="true" tabindex="-1"></a>The binary variables are often called *dummies* or *indicators*. For example, $X_1$ is a dummy or indicator for married respondents. </span>
<span id="cb83-227"><a href="#cb83-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-228"><a href="#cb83-228" aria-hidden="true" tabindex="-1"></a>In reference-group coding, the group that does not have a dummy variable is the reference group. It is also the group that is coded zero on all of the included dummies. In this example, "Single" is the reference group. </span>
<span id="cb83-229"><a href="#cb83-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-230"><a href="#cb83-230" aria-hidden="true" tabindex="-1"></a>We can more compactly write down the contrast coding in the example using a *contrast matrix* . </span>
<span id="cb83-231"><a href="#cb83-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-232"><a href="#cb83-232" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb83-233"><a href="#cb83-233" aria-hidden="true" tabindex="-1"></a>\begin{matrix} &amp; X_1 &amp; X_2<span class="sc">\\</span> </span>
<span id="cb83-234"><a href="#cb83-234" aria-hidden="true" tabindex="-1"></a>                 \text{Married} &amp; 1 &amp; 0  <span class="sc">\\</span> </span>
<span id="cb83-235"><a href="#cb83-235" aria-hidden="true" tabindex="-1"></a>                 \text{Divorced} &amp; 0 &amp; 1 <span class="sc">\\</span></span>
<span id="cb83-236"><a href="#cb83-236" aria-hidden="true" tabindex="-1"></a>                \text{Single}  &amp; 0 &amp; 0 <span class="sc">\\</span></span>
<span id="cb83-237"><a href="#cb83-237" aria-hidden="true" tabindex="-1"></a>\end{matrix} </span>
<span id="cb83-238"><a href="#cb83-238" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-239"><a href="#cb83-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-240"><a href="#cb83-240" aria-hidden="true" tabindex="-1"></a>This notation is an abbreviated version of the data matrix in @fig-martital-status1. It summarizes how the two indicator variables correspond to the different levels of the categorical variable. As we will see in the @sec-exercises-4, contrast matrices are useful for programming in R. </span>
<span id="cb83-241"><a href="#cb83-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-242"><a href="#cb83-242" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting the regression coefficients {#sec-reference-group-interpretation-4}</span></span>
<span id="cb83-243"><a href="#cb83-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-244"><a href="#cb83-244" aria-hidden="true" tabindex="-1"></a>Regressing Age on the dummies we have: </span>
<span id="cb83-245"><a href="#cb83-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-246"><a href="#cb83-246" aria-hidden="true" tabindex="-1"></a>$$ \widehat Y = b_0 + b_1 X_1 + b_2 X_2. $$</span>
<span id="cb83-247"><a href="#cb83-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-248"><a href="#cb83-248" aria-hidden="true" tabindex="-1"></a>In order to interpret the regression coefficients we can use the same two steps as in @sec-binary-predictors-4</span>
<span id="cb83-249"><a href="#cb83-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-250"><a href="#cb83-250" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 1.* Plug the values for the $X$ variables into the regression equation to get the predicted values for each group</span>
<span id="cb83-251"><a href="#cb83-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-252"><a href="#cb83-252" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-253"><a href="#cb83-253" aria-hidden="true" tabindex="-1"></a>\widehat Y (Single) &amp; = b_0 + b_1 (0) + b_2 (0) = b_0 <span class="sc">\\</span></span>
<span id="cb83-254"><a href="#cb83-254" aria-hidden="true" tabindex="-1"></a>\widehat Y (Married) &amp; = b_0 + b_1 (1) + b_2 (0) = b_0 + b_1 <span class="sc">\\</span> </span>
<span id="cb83-255"><a href="#cb83-255" aria-hidden="true" tabindex="-1"></a>\widehat Y (Divorced) &amp; = b_0 + b_1 (0) + b_2 (1) = b_0 + b_2 </span>
<span id="cb83-256"><a href="#cb83-256" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-257"><a href="#cb83-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-258"><a href="#cb83-258" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 2.* Solve for the model parameters in terms the predicted values. </span>
<span id="cb83-259"><a href="#cb83-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-260"><a href="#cb83-260" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-261"><a href="#cb83-261" aria-hidden="true" tabindex="-1"></a>b_0 &amp; = \widehat Y (Single) <span class="sc">\\</span> </span>
<span id="cb83-262"><a href="#cb83-262" aria-hidden="true" tabindex="-1"></a>b_1 &amp; = \widehat Y (Married) - b_0 = \widehat Y (Married) - \widehat Y (Single) <span class="sc">\\</span> </span>
<span id="cb83-263"><a href="#cb83-263" aria-hidden="true" tabindex="-1"></a>b_2 &amp; = \widehat Y (Divorced) - b_0 = \widehat Y (Divorced) - \widehat Y (Single)</span>
<span id="cb83-264"><a href="#cb83-264" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-265"><a href="#cb83-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-266"><a href="#cb83-266" aria-hidden="true" tabindex="-1"></a>**Using the above equations, please write down an interpretation of the regression parameters for the hypothetical example. (Note: this question is not asking for a numerical answer, it is just asking you to put the above equations into words.)**</span>
<span id="cb83-267"><a href="#cb83-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-268"><a href="#cb83-268" aria-hidden="true" tabindex="-1"></a><span class="fu">### More than 3 categories {#sec-reference-group-more-than-three-4}</span></span>
<span id="cb83-269"><a href="#cb83-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-270"><a href="#cb83-270" aria-hidden="true" tabindex="-1"></a>@fig-martital-status2 extends the example by adding another category for Mstatus ("widowed"). </span>
<span id="cb83-271"><a href="#cb83-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-272"><a href="#cb83-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-martital-status2, fig.cap = 'Toy Martital Status Example, Part 2.', fig.align = 'center'}</span></span>
<span id="cb83-273"><a href="#cb83-273" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/marital_status2.png"</span>)</span>
<span id="cb83-274"><a href="#cb83-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-275"><a href="#cb83-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-276"><a href="#cb83-276" aria-hidden="true" tabindex="-1"></a>Here we are interested in the model</span>
<span id="cb83-277"><a href="#cb83-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-278"><a href="#cb83-278" aria-hidden="true" tabindex="-1"></a>$$\widehat Y = b_0 + b_1 X_1 + b_2 X_2 + b_3 X_3$$</span>
<span id="cb83-279"><a href="#cb83-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-280"><a href="#cb83-280" aria-hidden="true" tabindex="-1"></a>**Please work through the following questions and be prepared to share your answers in class**</span>
<span id="cb83-281"><a href="#cb83-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-282"><a href="#cb83-282" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**How should $X_3$ be coded so that "single" is the reference-group?** </span>
<span id="cb83-283"><a href="#cb83-283" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Write down the contrast matrix for the example.**</span>
<span id="cb83-284"><a href="#cb83-284" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Using the two-step approach illustrated above, write out the interpretation of the regression coefficients.**</span>
<span id="cb83-285"><a href="#cb83-285" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>**Let's imagine that we included an additional dummy variable for "Single" in the model. In this case we would have $C = 4$ dummies in the model rather than $C-1 = 3$ dummies. Please take a moment to write down what you think will happen (Hint: something goes wrong)**</span>
<span id="cb83-286"><a href="#cb83-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-287"><a href="#cb83-287" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary </span></span>
<span id="cb83-288"><a href="#cb83-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-289"><a href="#cb83-289" aria-hidden="true" tabindex="-1"></a>In reference-group coding with a single categorical variable: </span>
<span id="cb83-290"><a href="#cb83-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-291"><a href="#cb83-291" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The reference is group is chosen by the analyst – it is the group that is coded zero on all dummies, or the one that has its indicator omitted from the model.  </span>
<span id="cb83-292"><a href="#cb83-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-293"><a href="#cb83-293" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The intercept is interpreted as the mean of the reference group.</span>
<span id="cb83-294"><a href="#cb83-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-295"><a href="#cb83-295" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The regression coefficients of the dummy variables are interpreted as the difference between the mean of the indicated group and the mean of the reference group.</span>
<span id="cb83-296"><a href="#cb83-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-297"><a href="#cb83-297" aria-hidden="true" tabindex="-1"></a><span class="fu">## Deviation coding {#sec-deviation-coding-4}</span></span>
<span id="cb83-298"><a href="#cb83-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-299"><a href="#cb83-299" aria-hidden="true" tabindex="-1"></a>In some research scenarios, there is a clear reference group. For example, in an experiment, all treatment groups are can be compared to the control group. But in other cases, it is less clear what the reference group should be. In both of the examples we have considered so far (gender and marital status), the choice of reference group was arbitrary. </span>
<span id="cb83-300"><a href="#cb83-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-301"><a href="#cb83-301" aria-hidden="true" tabindex="-1"></a>When there is not a clear reference group, it can be preferable to use other types of contrast coding than reference-group coding. One such approach is called *deviation coding*. In R, this is called *sum-to-zero constrasts*, or *sum* contrasts for short. </span>
<span id="cb83-302"><a href="#cb83-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-303"><a href="#cb83-303" aria-hidden="true" tabindex="-1"></a>The main difference between deviation coding and reference-group coding is the interpretation of the intercept. In deviation coding, it is no longer the mean of the  reference-group, but instead represents the mean of all groups' predicted values. When the groups have equal sample size, the deviation-coded intercept is also equal to overall mean on $Y$. </span>
<span id="cb83-304"><a href="#cb83-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-305"><a href="#cb83-305" aria-hidden="true" tabindex="-1"></a>More specifically, in deviation coding: </span>
<span id="cb83-306"><a href="#cb83-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-307"><a href="#cb83-307" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The intercept is equal to the mean of the predicted values for each category i.e., </span>
<span id="cb83-308"><a href="#cb83-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-309"><a href="#cb83-309" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-310"><a href="#cb83-310" aria-hidden="true" tabindex="-1"></a>b_0 = \frac{\sum_{c=1}^C \widehat Y_c} {C} </span>
<span id="cb83-311"><a href="#cb83-311" aria-hidden="true" tabindex="-1"></a>$$ {#eq-unweighted-mean}</span>
<span id="cb83-312"><a href="#cb83-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-313"><a href="#cb83-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-314"><a href="#cb83-314" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>When the groups have equal sample sizes ($n$), the intercept is also equal to the overall mean on the outcome variable: </span>
<span id="cb83-315"><a href="#cb83-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-316"><a href="#cb83-316" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb83-317"><a href="#cb83-317" aria-hidden="true" tabindex="-1"></a>b_0 = \frac{\sum_{c=1}^C \widehat Y_c} {C} </span>
<span id="cb83-318"><a href="#cb83-318" aria-hidden="true" tabindex="-1"></a> = \frac{\sum_{c=1}^C \bar Y_c}{C} = \frac{\sum_{c=1}^C \left(\frac{\sum_{i=1}^n Y_{ic}}{n}\right)} {C} =  \frac{\sum_{c=1}^C \sum_{i=1}^n Y_{ic}}{nC} = \bar Y </span>
<span id="cb83-319"><a href="#cb83-319" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb83-320"><a href="#cb83-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-321"><a href="#cb83-321" aria-hidden="true" tabindex="-1"></a>The regression slopes compare the each group to the intercept. Consequently, when the groups have equal sample sizes, the regression slopes are interpreted as the deviation of each group mean from the overall mean, which is why it is called deviation coding. </span>
<span id="cb83-322"><a href="#cb83-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-323"><a href="#cb83-323" aria-hidden="true" tabindex="-1"></a>When the groups have unequal sample size, the situation is a bit more complicated. In particular, we have to weight the predicted values in  @eq-unweighted-mean by the group sample sizes. This is addressed in  @sec-extra1-4 (optional). To clarify that intercept in deviation coding is not always equal to $\bar Y$, we refer to it as an "unweighted mean" of group means / predicted scores. </span>
<span id="cb83-324"><a href="#cb83-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-325"><a href="#cb83-325" aria-hidden="true" tabindex="-1"></a>It is important to note that there are still only $C-1$ regression slopes So, one group gets left out of the analysis, and the researcher has to chose which one. This is a shortcoming of deviation coding, which is addressed in @sec-extra2-4 (optional).  </span>
<span id="cb83-326"><a href="#cb83-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-327"><a href="#cb83-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### A hypothetical example {#sec-idela-4}</span></span>
<span id="cb83-328"><a href="#cb83-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-329"><a href="#cb83-329" aria-hidden="true" tabindex="-1"></a>The International Development and Early Learning Assessment (IDELA) is an assessment designed to measure young children's development in literacy, numeracy, social-emotional, and motor domains, in international settings. @fig-idela1 shows the countries in which the IDELA had been used as of 2017 (for more info, see <span class="co">[</span><span class="ot">https://www.savethechildren.net/sites/default/files/libraries/GS_0.pdf</span><span class="co">](https://www.savethechildren.net/sites/default/files/libraries/GS_0.pdf)</span>). </span>
<span id="cb83-330"><a href="#cb83-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-331"><a href="#cb83-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-332"><a href="#cb83-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-idela1, fig.cap = 'IDELA Worldwide Usage, 2017.', fig.align = 'center'}</span></span>
<span id="cb83-333"><a href="#cb83-333" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/idela_map.png"</span>)</span>
<span id="cb83-334"><a href="#cb83-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-335"><a href="#cb83-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-336"><a href="#cb83-336" aria-hidden="true" tabindex="-1"></a>If our goal was to compare countries' IDELA scores, agreeing on which country should serve as the reference group would politically fraught. Therefore, it would be preferable to avoid the problem of choosing a reference group altogether. In particular, deviation coding let's us compare each country’s mean IDELA score to the (unweighted) mean over all of the countries. </span>
<span id="cb83-337"><a href="#cb83-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-338"><a href="#cb83-338" aria-hidden="true" tabindex="-1"></a>@fig-idela2 presents a toy example. The data show the IDELA scores and Country for 16 hypothetical individuals. The countries considered in this example are </span>
<span id="cb83-339"><a href="#cb83-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-340"><a href="#cb83-340" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Ethiopia</span>
<span id="cb83-341"><a href="#cb83-341" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Vietnam</span>
<span id="cb83-342"><a href="#cb83-342" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Boliva</span>
<span id="cb83-343"><a href="#cb83-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-344"><a href="#cb83-344" aria-hidden="true" tabindex="-1"></a>These 3 countries are represented by two binary variables, denoted $X_1$ and $X_2$. </span>
<span id="cb83-345"><a href="#cb83-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-346"><a href="#cb83-346" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$X_1$ is a indicator for Ethiopia</span>
<span id="cb83-347"><a href="#cb83-347" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$X_2$ is a indicator for Vietnam</span>
<span id="cb83-348"><a href="#cb83-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-349"><a href="#cb83-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-350"><a href="#cb83-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-idela2, fig.cap = 'Toy IDELA Example.', fig.align = 'center'}</span></span>
<span id="cb83-351"><a href="#cb83-351" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/idela1.png"</span>)</span>
<span id="cb83-352"><a href="#cb83-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-353"><a href="#cb83-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-354"><a href="#cb83-354" aria-hidden="true" tabindex="-1"></a>Note that the dummy variables are different than for the case of reference-group coding discussed in @sec-reference-group-coding-4. In deviation coding, the dummies always take on values $1, 0, -1$. The same group must receive the code $-1$ for all dummies. The group with the value $-1$ is the group that gets left out of the analysis. </span>
<span id="cb83-355"><a href="#cb83-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-356"><a href="#cb83-356" aria-hidden="true" tabindex="-1"></a>**Please take a moment to write down the contrast matrix for the IDELA example.**</span>
<span id="cb83-357"><a href="#cb83-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-358"><a href="#cb83-358" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting the regression coefficients {#sec-deviation-interpretation-4}</span></span>
<span id="cb83-359"><a href="#cb83-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-360"><a href="#cb83-360" aria-hidden="true" tabindex="-1"></a>Regressing IDELA on the dummies we have: </span>
<span id="cb83-361"><a href="#cb83-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-362"><a href="#cb83-362" aria-hidden="true" tabindex="-1"></a>$$\widehat Y = b_0 + b_1 X_1 + b_2 X_2$$</span>
<span id="cb83-363"><a href="#cb83-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-364"><a href="#cb83-364" aria-hidden="true" tabindex="-1"></a>In order to interpret the regression coefficients, we proceed using the same two steps as in @sec-binary-predictors-4 and @sec-reference-group-coding-4.</span>
<span id="cb83-365"><a href="#cb83-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-366"><a href="#cb83-366" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 1.* Plug the values for $X$ into the regression equation to get the predicted values for each group. </span>
<span id="cb83-367"><a href="#cb83-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-368"><a href="#cb83-368" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-369"><a href="#cb83-369" aria-hidden="true" tabindex="-1"></a>\widehat Y (Ethiopia) &amp; = b_0 + b_1 (1) + b_2 (0) = b_0 + b_1<span class="sc">\\</span></span>
<span id="cb83-370"><a href="#cb83-370" aria-hidden="true" tabindex="-1"></a>\widehat Y (Vietnam) &amp; = b_0 + b_1 (0) + b_2 (1) = b_0 + b_2 <span class="sc">\\</span> </span>
<span id="cb83-371"><a href="#cb83-371" aria-hidden="true" tabindex="-1"></a>\widehat Y (Bolivia) &amp; = b_0 + b_1 (-1) + b_2 (-1) = b_0 - b_1 - b_2 </span>
<span id="cb83-372"><a href="#cb83-372" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-373"><a href="#cb83-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-374"><a href="#cb83-374" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 2.* Solve for the model parameters in terms of the predicted values. </span>
<span id="cb83-375"><a href="#cb83-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-376"><a href="#cb83-376" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-377"><a href="#cb83-377" aria-hidden="true" tabindex="-1"></a>b_1 &amp;= \widehat Y (Ethiopia) - b_0 <span class="sc">\\</span></span>
<span id="cb83-378"><a href="#cb83-378" aria-hidden="true" tabindex="-1"></a>b_2 &amp;= \widehat Y (Vietnam) - b_0 <span class="sc">\\</span></span>
<span id="cb83-379"><a href="#cb83-379" aria-hidden="true" tabindex="-1"></a>b_0 &amp; = \widehat Y (Bolivia) + b_1 + b_2 <span class="sc">\\</span>  </span>
<span id="cb83-380"><a href="#cb83-380" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-381"><a href="#cb83-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-382"><a href="#cb83-382" aria-hidden="true" tabindex="-1"></a>At this point, we want to use the first two lines to substitute in for $b_1$ and $b_2$ in the last line: </span>
<span id="cb83-383"><a href="#cb83-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-384"><a href="#cb83-384" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-385"><a href="#cb83-385" aria-hidden="true" tabindex="-1"></a> b_0 &amp; = \widehat Y (Bolivia) + \widehat Y (Ethiopia) - b_0 + \widehat Y (Vietnam) - b_0 <span class="sc">\\</span></span>
<span id="cb83-386"><a href="#cb83-386" aria-hidden="true" tabindex="-1"></a>\implies &amp; <span class="sc">\\</span> </span>
<span id="cb83-387"><a href="#cb83-387" aria-hidden="true" tabindex="-1"></a>3b_0 &amp; = \widehat Y (Bolivia) + \widehat Y (Ethiopia) + \widehat Y (Vietnam) <span class="sc">\\</span></span>
<span id="cb83-388"><a href="#cb83-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-389"><a href="#cb83-389" aria-hidden="true" tabindex="-1"></a>\implies &amp; <span class="sc">\\</span> </span>
<span id="cb83-390"><a href="#cb83-390" aria-hidden="true" tabindex="-1"></a>b_0 &amp; = \frac{\widehat Y (Bolivia) + \widehat Y (Ethiopia) + \widehat Y (Vietnam)}{3}</span>
<span id="cb83-391"><a href="#cb83-391" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-392"><a href="#cb83-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-393"><a href="#cb83-393" aria-hidden="true" tabindex="-1"></a>In the last line we see that $b_0$ is equal to the (unweighted) mean of the predicted values. </span>
<span id="cb83-394"><a href="#cb83-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-395"><a href="#cb83-395" aria-hidden="true" tabindex="-1"></a>**Using the above equations, please write down an interpretation of the regression parameters for the hypothetical example.  (Note: this question is not asking for a numerical answer, it is just asking you to put the above equations into words.)**</span>
<span id="cb83-396"><a href="#cb83-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-397"><a href="#cb83-397" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb83-398"><a href="#cb83-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-399"><a href="#cb83-399" aria-hidden="true" tabindex="-1"></a>In deviation coding with a single categorical variable: </span>
<span id="cb83-400"><a href="#cb83-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-401"><a href="#cb83-401" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The intercept is interpreted as the unweighted mean of the groups' means, which is equal to the overall mean on the $Y$ variable when the groups have equal sample sizes. </span>
<span id="cb83-402"><a href="#cb83-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-403"><a href="#cb83-403" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The regression slopes on the dummy variables are interpreted as the difference between the mean of the indicated group and the unweighted mean of the groups.</span>
<span id="cb83-404"><a href="#cb83-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-405"><a href="#cb83-405" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>There are still only $C - 1$ regression coefficients, so one group gets left out (see extra material for how to get around this).</span>
<span id="cb83-406"><a href="#cb83-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-407"><a href="#cb83-407" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extra: Deviation coding with unequal sample sizes* {#sec-extra1-4}</span></span>
<span id="cb83-408"><a href="#cb83-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-409"><a href="#cb83-409" aria-hidden="true" tabindex="-1"></a>When groups have unequal sample size, the unweighted mean of the group means is not equial the overall mean of the $Y$ variable. This is not always a problem. In particular, in the IDELA example, it is reasonable that each country should receive equal weight, even if the size of the samples in each country differed.</span>
<span id="cb83-410"><a href="#cb83-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-411"><a href="#cb83-411" aria-hidden="true" tabindex="-1"></a>However, if you want to compare each groups' mean to the overall mean on $Y$, deviation coding can be adjusted by replacing the dummy-coded value $-1$ with the ratio of indicated group's sample size to the omitted group's sample size. An example for 3 groups is shown below. </span>
<span id="cb83-412"><a href="#cb83-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-413"><a href="#cb83-413" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb83-414"><a href="#cb83-414" aria-hidden="true" tabindex="-1"></a>\begin{matrix} &amp; \text{Dummy 1}&amp; \text{Dummy 2}<span class="sc">\\</span> </span>
<span id="cb83-415"><a href="#cb83-415" aria-hidden="true" tabindex="-1"></a>                   \text{Group 1} &amp; 1 &amp; 0  <span class="sc">\\</span> </span>
<span id="cb83-416"><a href="#cb83-416" aria-hidden="true" tabindex="-1"></a>                   \text{Group 2} &amp; 0 &amp; 1 <span class="sc">\\</span></span>
<span id="cb83-417"><a href="#cb83-417" aria-hidden="true" tabindex="-1"></a>                  \text{Group 3}  &amp; - n_1 /n_3 &amp; - n_2 / n_3 <span class="sc">\\</span></span>
<span id="cb83-418"><a href="#cb83-418" aria-hidden="true" tabindex="-1"></a>\end{matrix} </span>
<span id="cb83-419"><a href="#cb83-419" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-420"><a href="#cb83-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-421"><a href="#cb83-421" aria-hidden="true" tabindex="-1"></a>You can use the 2-step procedure to show that this coding, called *weighted deviation coding*, results in </span>
<span id="cb83-422"><a href="#cb83-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-423"><a href="#cb83-423" aria-hidden="true" tabindex="-1"></a>\begin{equation}</span>
<span id="cb83-424"><a href="#cb83-424" aria-hidden="true" tabindex="-1"></a>b_0 = \frac{n_1 \widehat Y( \text{Group 1}) + n_2 \widehat Y( \text{Group 2}) + n_3 \widehat Y( \text{Group 3})}{n_1 + n_2 + n_3}</span>
<span id="cb83-425"><a href="#cb83-425" aria-hidden="true" tabindex="-1"></a>\end{equation}</span>
<span id="cb83-426"><a href="#cb83-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-427"><a href="#cb83-427" aria-hidden="true" tabindex="-1"></a>Replacing $\widehat Y( \text{Group }c )$ with $\bar Y_c$ you can also show that $b_0 = \bar Y$, using the rules of summation algebra. </span>
<span id="cb83-428"><a href="#cb83-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-429"><a href="#cb83-429" aria-hidden="true" tabindex="-1"></a>The punchline: unlike the case for the deviation coding, the intercept in *weighted deviation coding*  is always equal to the overall mean on the outcome variance, regardless of the sample sizes of the groups. In R, you can use the package <span class="in">`wec`</span> for weighted effect coding. </span>
<span id="cb83-430"><a href="#cb83-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-431"><a href="#cb83-431" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extra: Deviation coding with all groups included* {#sec-extra2-4}</span></span>
<span id="cb83-432"><a href="#cb83-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-433"><a href="#cb83-433" aria-hidden="true" tabindex="-1"></a>Another shortcoming of deviation coding is that it requires leaving one group out of the model. As a work around, one can instead use the following approach. Note that this approach will affect the statistical significance of R-squared, so you should only use it if you aren't interested in reporting R-squared (or are willing to do some more fiddling around with R). </span>
<span id="cb83-434"><a href="#cb83-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-435"><a href="#cb83-435" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Step 1: Center the $Y$ variable so that $\bar Y = 0$. </span>
<span id="cb83-436"><a href="#cb83-436" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Step 2: Compute binary dummy variables (reference-group coding) for all $C$ groups, $X_1, X_2, \dots, X_C$ </span>
<span id="cb83-437"><a href="#cb83-437" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Step 3: Regress $Y$ on the all $C$ dummy variables, without the intercept in the model: </span>
<span id="cb83-438"><a href="#cb83-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-439"><a href="#cb83-439" aria-hidden="true" tabindex="-1"></a>$$\hat Y = b_1X_1 +  b_2 X_2 + \dots + b_cX_C.$$</span>
<span id="cb83-440"><a href="#cb83-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-441"><a href="#cb83-441" aria-hidden="true" tabindex="-1"></a>Using the two step approach, it is easy to show that the regression coefficients are just the means of the indicated group. Since the overall mean of $Y$ is zero (because of Step 1), the group means can be interpreted as deviations from the overall mean on $Y$. </span>
<span id="cb83-442"><a href="#cb83-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-443"><a href="#cb83-443" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`lm`</span> function in R, you can remove the intercept from the model using <span class="in">`-1`</span> in the formula syntax: </span>
<span id="cb83-444"><a href="#cb83-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-445"><a href="#cb83-445" aria-hidden="true" tabindex="-1"></a><span class="in">`Y ~ -1 + X1 + ...`</span> </span>
<span id="cb83-446"><a href="#cb83-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-447"><a href="#cb83-447" aria-hidden="true" tabindex="-1"></a>As noted, this will affect the statistical significance of R-squared, as reported in <span class="in">`summary(lm)`</span>. So, you shouldn't use this approach when you want to report R-squared. The next two paragraphs explain why, but the explanation requires some material we won't discuss until @sec-chap-6. </span>
<span id="cb83-448"><a href="#cb83-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-449"><a href="#cb83-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-450"><a href="#cb83-450" aria-hidden="true" tabindex="-1"></a>The F-test of R-squared can be computed by comparing two different models, a reference model with no predictors and a focal model with the predictors. The reference model used by <span class="in">`lm`</span> depends on whether the intercept is included in the focal model. If the focal model has an intercept, the reference model also has an intercept. In the focal model omits the intercept, the reference also omits the intercept.  </span>
<span id="cb83-451"><a href="#cb83-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-452"><a href="#cb83-452" aria-hidden="true" tabindex="-1"></a>In the present context, the focal model omits the intercept and use $C$ dummies This model has the same R-squared as if we had used the intercept and $C-1$ dummies. However, the F-statistic for the test of R-squared (as reported by <span class="in">`summary(lm)`</span>) is different for the two approaches, because of the choice of reference model. You can change the reference model, but it takes a bit of fiddling around. If you are interested, just ask in class. </span>
<span id="cb83-453"><a href="#cb83-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-454"><a href="#cb83-454" aria-hidden="true" tabindex="-1"></a><span class="fu">## Relation with ANOVA</span></span>
<span id="cb83-455"><a href="#cb83-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-456"><a href="#cb83-456" aria-hidden="true" tabindex="-1"></a>As mentioned in @sec-chap-3, the F-test of R-squared is equivalent to simultaneously testing whether all of the regression slopes are equal to zero. In symbols:</span>
<span id="cb83-457"><a href="#cb83-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-458"><a href="#cb83-458" aria-hidden="true" tabindex="-1"></a>Testing </span>
<span id="cb83-459"><a href="#cb83-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-460"><a href="#cb83-460" aria-hidden="true" tabindex="-1"></a>$$H_0: R^2 = 0$$ </span>
<span id="cb83-461"><a href="#cb83-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-462"><a href="#cb83-462" aria-hidden="true" tabindex="-1"></a>is equivalent to testing </span>
<span id="cb83-463"><a href="#cb83-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-464"><a href="#cb83-464" aria-hidden="true" tabindex="-1"></a>$$H_0: b_1 = b_2 = \cdots = b_{C-1} = 0$$ </span>
<span id="cb83-465"><a href="#cb83-465" aria-hidden="true" tabindex="-1"></a>We have see above that the regression slopes can be interpreted in terms of group-mean differences. For example, under reference-group coding, we can re-write the null hypothesis above as: </span>
<span id="cb83-466"><a href="#cb83-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-467"><a href="#cb83-467" aria-hidden="true" tabindex="-1"></a>$$H_0: \bar Y_1 - \bar Y_C = \bar Y_2 - \bar Y_C  = \cdots = \bar Y_{C-1} - \bar Y_C  = 0$$ </span>
<span id="cb83-468"><a href="#cb83-468" aria-hidden="true" tabindex="-1"></a>In this notation, we let $C$ denote the reference group. If we add $\bar Y_C$ to each equality in the null hypothesis, we have </span>
<span id="cb83-469"><a href="#cb83-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-470"><a href="#cb83-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-471"><a href="#cb83-471" aria-hidden="true" tabindex="-1"></a>$$H_0: \bar Y_1 = \bar Y_2  = \cdots = \bar Y_{C-1}  =  \bar Y_C $$ </span>
<span id="cb83-472"><a href="#cb83-472" aria-hidden="true" tabindex="-1"></a>Note that this is the same null hypothesis as one-way ANOVA -- i.e., all the group means are equal. Consequently, the F-test of R-squared using a categorical predictor is equivalent to the F-test of the omnibus hypothesis in one-way ANOVA (assuming homoskedasticity). In @sec-exercises-4, we show how the two approaches produce the same numerical values. </span>
<span id="cb83-473"><a href="#cb83-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-474"><a href="#cb83-474" aria-hidden="true" tabindex="-1"></a>Although regression with a categorical predictor is mathematically equivalent to one-way ANOVA, you may have noticed that the two approahces are not used in the same way. In ANOVA, we first conduct an F-test of the omnibus hypothesis, and, if the test is significant, we follow-up by comparing the groups using procedures that control for familywise error rate. In regression, we just report the F-test along with the test of the individual contrasts, without any discussion of familywise error rate control. Which approach is correct? Depends who you ask.... </span>
<span id="cb83-475"><a href="#cb83-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-476"><a href="#cb83-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-477"><a href="#cb83-477" aria-hidden="true" tabindex="-1"></a><span class="fu">## Some details about categorical data* {#sec-categorical-results-4}</span></span>
<span id="cb83-478"><a href="#cb83-478" aria-hidden="true" tabindex="-1"></a>Check back later for: </span>
<span id="cb83-479"><a href="#cb83-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-480"><a href="#cb83-480" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>mean and variance of binary variables</span>
<span id="cb83-481"><a href="#cb83-481" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>covariance between binary variables and between binary and continuous</span>
<span id="cb83-482"><a href="#cb83-482" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>regression coefficient when X is binary </span>
<span id="cb83-483"><a href="#cb83-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-484"><a href="#cb83-484" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workbook{#sec-workbook-4}</span></span>
<span id="cb83-485"><a href="#cb83-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-486"><a href="#cb83-486" aria-hidden="true" tabindex="-1"></a>This section collects the questions asked in this chapter. The lesson for this chapter will focus on discussing these questions and then working on the exercises in @sec-exercises-4. The lesson will **not** be a lecture that reviews all of the material in the chapter! So, if you haven't written down / thought about the answers to these questions before class, the lesson will not be very useful for you. Please engage with each question by writing down one or more answers, asking clarifying questions about related material, posing follow up questions, etc. </span>
<span id="cb83-487"><a href="#cb83-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-488"><a href="#cb83-488" aria-hidden="true" tabindex="-1"></a>@sec-social-constructs-4</span>
<span id="cb83-489"><a href="#cb83-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-490"><a href="#cb83-490" aria-hidden="true" tabindex="-1"></a>Please take a moment to write down your thoughts on the tensions that arise when conceptualizing social constructs such as gender or race as categorical, and I will invite you to share you thoughts in class.</span>
<span id="cb83-491"><a href="#cb83-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-492"><a href="#cb83-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-493"><a href="#cb83-493" aria-hidden="true" tabindex="-1"></a>@sec-binary-predictors-4</span>
<span id="cb83-494"><a href="#cb83-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-495"><a href="#cb83-495" aria-hidden="true" tabindex="-1"></a>Please take a moment to write down how the regression output is related to the Figure. In particular, what is $\bar Y_0$ equal to, what is equal $\bar Y_0$ to, and what is their difference equal to?</span>
<span id="cb83-496"><a href="#cb83-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-497"><a href="#cb83-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig.align = 'center', fig.width=5}</span></span>
<span id="cb83-498"><a href="#cb83-498" aria-hidden="true" tabindex="-1"></a><span class="co"># Don't read this unless you really like working on graphics :) </span></span>
<span id="cb83-499"><a href="#cb83-499" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>) <span class="sc">*</span> <span class="dv">1</span> </span>
<span id="cb83-500"><a href="#cb83-500" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(binary_gender, achrdg08, </span>
<span id="cb83-501"><a href="#cb83-501" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"#4B9CD3"</span>, </span>
<span id="cb83-502"><a href="#cb83-502" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"binary gender (Female = 0, Male = 1)"</span>,</span>
<span id="cb83-503"><a href="#cb83-503" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Reading (Grade 8)"</span>)</span>
<span id="cb83-504"><a href="#cb83-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-505"><a href="#cb83-505" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(achrdg08, binary_gender, mean)</span>
<span id="cb83-506"><a href="#cb83-506" aria-hidden="true" tabindex="-1"></a>labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(Y)[<span class="dv">0</span>]), <span class="fu">expression</span>(<span class="fu">bar</span>(Y)[<span class="dv">1</span>]))</span>
<span id="cb83-507"><a href="#cb83-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-508"><a href="#cb83-508" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(.<span class="dv">1</span>, .<span class="dv">9</span>), <span class="at">y =</span> means, <span class="at">labels =</span> labels, <span class="at">cex =</span> <span class="fl">1.5</span>) </span>
<span id="cb83-509"><a href="#cb83-509" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y =</span> means, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"_"</span>, <span class="st">"_"</span>), <span class="at">cex =</span> <span class="dv">2</span>) </span>
<span id="cb83-510"><a href="#cb83-510" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-511"><a href="#cb83-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-514"><a href="#cb83-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-515"><a href="#cb83-515" aria-hidden="true" tabindex="-1"></a><span class="co"># convert "Female / Male" coding to binary</span></span>
<span id="cb83-516"><a href="#cb83-516" aria-hidden="true" tabindex="-1"></a>gender <span class="ot">&lt;-</span> NELS<span class="sc">$</span>gender</span>
<span id="cb83-517"><a href="#cb83-517" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>)<span class="sc">*</span><span class="dv">1</span></span>
<span id="cb83-518"><a href="#cb83-518" aria-hidden="true" tabindex="-1"></a>mod_binary <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> binary_gender)</span>
<span id="cb83-519"><a href="#cb83-519" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(mod_binary)</span>
<span id="cb83-520"><a href="#cb83-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-521"><a href="#cb83-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-522"><a href="#cb83-522" aria-hidden="true" tabindex="-1"></a>@sec-t-test-4</span>
<span id="cb83-523"><a href="#cb83-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-524"><a href="#cb83-524" aria-hidden="true" tabindex="-1"></a>We will go through the comparison between these two outputs in class together. If you have any questions about the relation between these two sets of output, please note them now and be prepared ask them in class.</span>
<span id="cb83-525"><a href="#cb83-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-526"><a href="#cb83-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-527"><a href="#cb83-527" aria-hidden="true" tabindex="-1"></a>Regression with a binary predictor: </span>
<span id="cb83-530"><a href="#cb83-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-531"><a href="#cb83-531" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_binary)</span>
<span id="cb83-532"><a href="#cb83-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-533"><a href="#cb83-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-534"><a href="#cb83-534" aria-hidden="true" tabindex="-1"></a>Independent samples t-test (with homogeneity of variance assumed): </span>
<span id="cb83-535"><a href="#cb83-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-538"><a href="#cb83-538" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-539"><a href="#cb83-539" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(achrdg08 <span class="sc">~</span> binary_gender, <span class="at">var.equal =</span> T)</span>
<span id="cb83-540"><a href="#cb83-540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-541"><a href="#cb83-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-542"><a href="#cb83-542" aria-hidden="true" tabindex="-1"></a>@sec-reference-group-interpretation-4</span>
<span id="cb83-543"><a href="#cb83-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-544"><a href="#cb83-544" aria-hidden="true" tabindex="-1"></a>Regressing Age on the dummies we have: </span>
<span id="cb83-545"><a href="#cb83-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-546"><a href="#cb83-546" aria-hidden="true" tabindex="-1"></a>$$ \widehat Y = b_0 + b_1 X_1 + b_2 X_2 $$</span>
<span id="cb83-547"><a href="#cb83-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-548"><a href="#cb83-548" aria-hidden="true" tabindex="-1"></a>In order to interpret the regression coefficients we can use the same two steps as in @sec-binary-predictors-4</span>
<span id="cb83-549"><a href="#cb83-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-550"><a href="#cb83-550" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 1.* Plug the values for the $X$ variables into the regression equation to get the predicted values for each group</span>
<span id="cb83-551"><a href="#cb83-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-552"><a href="#cb83-552" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-553"><a href="#cb83-553" aria-hidden="true" tabindex="-1"></a>\widehat Y (Single) &amp; = b_0 + b_1 (0) + b_2 (0) = b_0 <span class="sc">\\</span></span>
<span id="cb83-554"><a href="#cb83-554" aria-hidden="true" tabindex="-1"></a>\widehat Y (Married) &amp; = b_0 + b_1 (1) + b_2 (0) = b_0 + b_1 <span class="sc">\\</span> </span>
<span id="cb83-555"><a href="#cb83-555" aria-hidden="true" tabindex="-1"></a>\widehat Y (Divorced) &amp; = b_0 + b_1 (0) + b_2 (1) = b_0 + b_2 </span>
<span id="cb83-556"><a href="#cb83-556" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-557"><a href="#cb83-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-558"><a href="#cb83-558" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 2.* Solve for the model parameters in terms the predicted values. </span>
<span id="cb83-559"><a href="#cb83-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-560"><a href="#cb83-560" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-561"><a href="#cb83-561" aria-hidden="true" tabindex="-1"></a>b_0 &amp; = \widehat Y (Single) <span class="sc">\\</span> </span>
<span id="cb83-562"><a href="#cb83-562" aria-hidden="true" tabindex="-1"></a>b_1 &amp; = \widehat Y (Married) - b_0 = \widehat Y (Married) - \widehat Y (Single) <span class="sc">\\</span> </span>
<span id="cb83-563"><a href="#cb83-563" aria-hidden="true" tabindex="-1"></a>b_2 &amp; = \widehat Y (Divorced) - b_0 = \widehat Y (Divorced) - \widehat Y (Single)</span>
<span id="cb83-564"><a href="#cb83-564" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-565"><a href="#cb83-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-566"><a href="#cb83-566" aria-hidden="true" tabindex="-1"></a>Using the above equations, please write down an interpretation of the regression parameters for the hypothetical example. (Note: this question is not asking for a numerical answer, it is just asking you to put the above equations into words.)</span>
<span id="cb83-567"><a href="#cb83-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-568"><a href="#cb83-568" aria-hidden="true" tabindex="-1"></a>@sec-reference-group-more-than-three-4</span>
<span id="cb83-569"><a href="#cb83-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-570"><a href="#cb83-570" aria-hidden="true" tabindex="-1"></a>The Mstatus example with 4 categories: </span>
<span id="cb83-571"><a href="#cb83-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-572"><a href="#cb83-572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.align = 'center'}</span></span>
<span id="cb83-573"><a href="#cb83-573" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/marital_status2.png"</span>)</span>
<span id="cb83-574"><a href="#cb83-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-575"><a href="#cb83-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-576"><a href="#cb83-576" aria-hidden="true" tabindex="-1"></a>Here we are interested in the model: </span>
<span id="cb83-577"><a href="#cb83-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-578"><a href="#cb83-578" aria-hidden="true" tabindex="-1"></a>$$\widehat Y = b_0 + b_1 X_1 + b_2 X_2 + b_3 X_3$$</span>
<span id="cb83-579"><a href="#cb83-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-580"><a href="#cb83-580" aria-hidden="true" tabindex="-1"></a>Please work through the following questions and be prepared to share your answers in class</span>
<span id="cb83-581"><a href="#cb83-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-582"><a href="#cb83-582" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>How should $X_3$ be coded so that "single" is the reference-group? </span>
<span id="cb83-583"><a href="#cb83-583" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Write down the contrast matrix for the example.</span>
<span id="cb83-584"><a href="#cb83-584" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Using the two-step approach illustrated above, write out the interpretation of the regression coefficients.</span>
<span id="cb83-585"><a href="#cb83-585" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Let's imagine that we included an additional dummy variable for "Single" in the model. In this case we would have $C = 4$ dummies in the model rather than $C-1 = 3$ dummies. Please take a moment to write down what you think will happen (Hint: something goes wrong).</span>
<span id="cb83-586"><a href="#cb83-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-587"><a href="#cb83-587" aria-hidden="true" tabindex="-1"></a>@sec-idela-4</span>
<span id="cb83-588"><a href="#cb83-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-589"><a href="#cb83-589" aria-hidden="true" tabindex="-1"></a>Please take a moment to write down the contrast matrix for the IDELA example: </span>
<span id="cb83-590"><a href="#cb83-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-591"><a href="#cb83-591" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb83-592"><a href="#cb83-592" aria-hidden="true" tabindex="-1"></a>\begin{matrix} &amp;  X_1 &amp; X_2 <span class="sc">\\</span> </span>
<span id="cb83-593"><a href="#cb83-593" aria-hidden="true" tabindex="-1"></a>                  \text{Ethiopia} &amp; ? &amp; ? <span class="sc">\\</span> </span>
<span id="cb83-594"><a href="#cb83-594" aria-hidden="true" tabindex="-1"></a>                  \text{Vietnam} &amp;?  &amp; ? <span class="sc">\\</span></span>
<span id="cb83-595"><a href="#cb83-595" aria-hidden="true" tabindex="-1"></a>                  \text{Bolivia}  &amp; ? &amp; ? <span class="sc">\\</span></span>
<span id="cb83-596"><a href="#cb83-596" aria-hidden="true" tabindex="-1"></a>\end{matrix} </span>
<span id="cb83-597"><a href="#cb83-597" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb83-598"><a href="#cb83-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-599"><a href="#cb83-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-600"><a href="#cb83-600" aria-hidden="true" tabindex="-1"></a>@sec-deviation-interpretation-4</span>
<span id="cb83-601"><a href="#cb83-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-602"><a href="#cb83-602" aria-hidden="true" tabindex="-1"></a>Regressing IDELA on the dummies we have: </span>
<span id="cb83-603"><a href="#cb83-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-604"><a href="#cb83-604" aria-hidden="true" tabindex="-1"></a>$$\widehat Y = b_0 + b_1 X_1 + b_2 X_2$$</span>
<span id="cb83-605"><a href="#cb83-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-606"><a href="#cb83-606" aria-hidden="true" tabindex="-1"></a>In order to interpret the regression coefficients, we proceed using the same two steps as in @sec-binary-predictors-4 and @sec-reference-group-coding-4.</span>
<span id="cb83-607"><a href="#cb83-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-608"><a href="#cb83-608" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 1.* Plug the values for $X$ into the regression equation to get the predicted values for each group. </span>
<span id="cb83-609"><a href="#cb83-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-610"><a href="#cb83-610" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-611"><a href="#cb83-611" aria-hidden="true" tabindex="-1"></a>\widehat Y (Ethiopia) &amp; = b_0 + b_1 (1) + b_2 (0) = b_0 + b_1<span class="sc">\\</span></span>
<span id="cb83-612"><a href="#cb83-612" aria-hidden="true" tabindex="-1"></a>\widehat Y (Vietnam) &amp; = b_0 + b_1 (0) + b_2 (1) = b_0 + b_2 <span class="sc">\\</span> </span>
<span id="cb83-613"><a href="#cb83-613" aria-hidden="true" tabindex="-1"></a>\widehat Y (Bolivia) &amp; = b_0 + b_1 (-1) + b_2 (-1) = b_0 - b_1 - b_2 </span>
<span id="cb83-614"><a href="#cb83-614" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-615"><a href="#cb83-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-616"><a href="#cb83-616" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>*Step 2.* Solve for the model parameters in terms of the predicted values. </span>
<span id="cb83-617"><a href="#cb83-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-618"><a href="#cb83-618" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-619"><a href="#cb83-619" aria-hidden="true" tabindex="-1"></a>b_1 &amp;= \widehat Y (Ethiopia) - b_0 <span class="sc">\\</span></span>
<span id="cb83-620"><a href="#cb83-620" aria-hidden="true" tabindex="-1"></a>b_2 &amp;= \widehat Y (Vietnam) - b_0 <span class="sc">\\</span></span>
<span id="cb83-621"><a href="#cb83-621" aria-hidden="true" tabindex="-1"></a>b_0 &amp; = \widehat Y (Bolivia) + b_1 + b_2 <span class="sc">\\</span>  </span>
<span id="cb83-622"><a href="#cb83-622" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-623"><a href="#cb83-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-624"><a href="#cb83-624" aria-hidden="true" tabindex="-1"></a>At this point, we want to use the first two lines to substitute in for $b_1$ and $b_2$ in the last line, which leads to  </span>
<span id="cb83-625"><a href="#cb83-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-626"><a href="#cb83-626" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb83-627"><a href="#cb83-627" aria-hidden="true" tabindex="-1"></a>b_0 &amp; = \frac{\widehat Y (Bolivia) + \widehat Y (Ethiopia) + \widehat Y (Vietnam)}{3}</span>
<span id="cb83-628"><a href="#cb83-628" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb83-629"><a href="#cb83-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-630"><a href="#cb83-630" aria-hidden="true" tabindex="-1"></a>In the last line we see that $b_0$ is equal to the (unweighted) mean of the predicted values. </span>
<span id="cb83-631"><a href="#cb83-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-632"><a href="#cb83-632" aria-hidden="true" tabindex="-1"></a>Using the above equations, please write down an interpretation of the regression parameters for the hypothetical example.  (Note: this question is not asking for a numerical answer, it is just asking you to put the above equations into words.)</span>
<span id="cb83-633"><a href="#cb83-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-634"><a href="#cb83-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-635"><a href="#cb83-635" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises {#sec-exercises-4}</span></span>
<span id="cb83-636"><a href="#cb83-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-637"><a href="#cb83-637" aria-hidden="true" tabindex="-1"></a>These exercises provide an overview of contrast coding with categorical predictors in R. Two preliminary topics are also discussed: linear regression with a binary predictor, and the <span class="in">`factor`</span> data class in R.  We will go through this material in class together, so you don't need to work on it before class (but you can if you want.) </span>
<span id="cb83-638"><a href="#cb83-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-639"><a href="#cb83-639" aria-hidden="true" tabindex="-1"></a>Before staring this section, you may find it useful to scroll to the top of the page, click on the "&lt;/&gt; Code" menu, and select "Show All Code."</span>
<span id="cb83-640"><a href="#cb83-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-641"><a href="#cb83-641" aria-hidden="true" tabindex="-1"></a><span class="fu">### A single binary predictor</span></span>
<span id="cb83-642"><a href="#cb83-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-643"><a href="#cb83-643" aria-hidden="true" tabindex="-1"></a>Regression with a single binary predictor is equivalent to the independent samples t-test of group means. Let's illustrate this using the NELS dataset with Reading achievement in grade 8 (<span class="in">`achrdg08`</span>) as the outcome and <span class="in">`gender`</span> as the predictor. Although gender need not be conceptualized as dichotomous or even categorical, the variable <span class="in">`gender`</span> reported in NELS data is dichotomous, with values "Female" and "Male". </span>
<span id="cb83-644"><a href="#cb83-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-645"><a href="#cb83-645" aria-hidden="true" tabindex="-1"></a>R treats variables like <span class="in">`gender`</span> as "factors". Factors have special properties that we are going to work with later on, but for now let's recode <span class="in">`gender`</span> to <span class="in">`binary_gender`</span> by setting <span class="in">`Female = 0`</span> and <span class="in">`Male = 1`</span></span>
<span id="cb83-646"><a href="#cb83-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-647"><a href="#cb83-647" aria-hidden="true" tabindex="-1"></a><span class="fu">### Recoding a factor to numeric</span></span>
<span id="cb83-648"><a href="#cb83-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-651"><a href="#cb83-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-652"><a href="#cb83-652" aria-hidden="true" tabindex="-1"></a><span class="co"># load("NELS.RData")</span></span>
<span id="cb83-653"><a href="#cb83-653" aria-hidden="true" tabindex="-1"></a><span class="co"># attach(NELS)</span></span>
<span id="cb83-654"><a href="#cb83-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-655"><a href="#cb83-655" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that gender is non-numeric -- it is a factor with levels "Female" and "Male"</span></span>
<span id="cb83-656"><a href="#cb83-656" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gender)</span>
<span id="cb83-657"><a href="#cb83-657" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(gender)</span>
<span id="cb83-658"><a href="#cb83-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-659"><a href="#cb83-659" aria-hidden="true" tabindex="-1"></a><span class="co"># A trick to create a binary indicator for males   </span></span>
<span id="cb83-660"><a href="#cb83-660" aria-hidden="true" tabindex="-1"></a>binary_gender <span class="ot">&lt;-</span> (gender <span class="sc">==</span> <span class="st">"Male"</span>) <span class="sc">*</span> <span class="dv">1</span> </span>
<span id="cb83-661"><a href="#cb83-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-662"><a href="#cb83-662" aria-hidden="true" tabindex="-1"></a><span class="co"># Check that the two variables are telling us the same thing</span></span>
<span id="cb83-663"><a href="#cb83-663" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gender, binary_gender)</span>
<span id="cb83-664"><a href="#cb83-664" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-665"><a href="#cb83-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-666"><a href="#cb83-666" aria-hidden="true" tabindex="-1"></a>It is often hassle to get from factor to numeric or vice versa. Above we used a hack by of first creating a logical vector (<span class="in">`gender == "Male"`</span>) and then coercing the logical vector to binary by multiplying it by 1. Other strategies can be used. See <span class="in">`help(factor)`</span> for more information. </span>
<span id="cb83-667"><a href="#cb83-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-668"><a href="#cb83-668" aria-hidden="true" tabindex="-1"></a><span class="fu">### Binary predictors and independent samples t-tests</span></span>
<span id="cb83-669"><a href="#cb83-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-670"><a href="#cb83-670" aria-hidden="true" tabindex="-1"></a>Now let's get back to regressing Reading Achievement (<span class="in">`achrdg08`</span>) on <span class="in">`binary_gender`</span>, and comparing this to an independent samples t-test using the same two variables.</span>
<span id="cb83-671"><a href="#cb83-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-674"><a href="#cb83-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-675"><a href="#cb83-675" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression with a binary variable</span></span>
<span id="cb83-676"><a href="#cb83-676" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> binary_gender)</span>
<span id="cb83-677"><a href="#cb83-677" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span>
<span id="cb83-678"><a href="#cb83-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-679"><a href="#cb83-679" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to the output of t-test</span></span>
<span id="cb83-680"><a href="#cb83-680" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(achrdg08 <span class="sc">~</span> binary_gender, <span class="at">var.equal =</span> T)</span>
<span id="cb83-681"><a href="#cb83-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-682"><a href="#cb83-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-683"><a href="#cb83-683" aria-hidden="true" tabindex="-1"></a>Note that:</span>
<span id="cb83-684"><a href="#cb83-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-685"><a href="#cb83-685" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The intercept in <span class="in">`mod1`</span> is equal the mean of the group coded 0 (females) in the t-test: </span>
<span id="cb83-686"><a href="#cb83-686" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-687"><a href="#cb83-687" aria-hidden="true" tabindex="-1"></a>$$b_0 = \bar Y_0 = 56.4678$$</span>
<span id="cb83-688"><a href="#cb83-688" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-689"><a href="#cb83-689" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The b-weight in <span class="in">`mod1`</span> is equal to difference between the means:</span>
<span id="cb83-690"><a href="#cb83-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-691"><a href="#cb83-691" aria-hidden="true" tabindex="-1"></a>$$b_1 = \bar Y_1 - \bar Y_0 = 55.54546 - 56.4678 = -0.9223$$</span>
<span id="cb83-692"><a href="#cb83-692" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-693"><a href="#cb83-693" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The t-test of the b-weight, and its p-value, are equivalent to the t-test mean difference (except for the sign): </span>
<span id="cb83-694"><a href="#cb83-694" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-695"><a href="#cb83-695" aria-hidden="true" tabindex="-1"></a>  $$ t(498) = 1.1633, p = .245$$</span>
<span id="cb83-696"><a href="#cb83-696" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-697"><a href="#cb83-697" aria-hidden="true" tabindex="-1"></a>In summary, a t-test of a b-weight of a binary predictor is equal equivalent to a t-test of the mean difference. </span>
<span id="cb83-698"><a href="#cb83-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-699"><a href="#cb83-699" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reference-group coding</span></span>
<span id="cb83-700"><a href="#cb83-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-701"><a href="#cb83-701" aria-hidden="true" tabindex="-1"></a>As discussed in Section \@ref(reference-group-coding-5), the basic idea of contrast coding is to replace a categorical variable with $C$ categories with $C-1$ "dummy" variables. In reference-group coding, the dummy variables are binary, and the resulting interpretation is: </span>
<span id="cb83-702"><a href="#cb83-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-703"><a href="#cb83-703" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The intercept is interpreted as the mean of the reference group. The reference is group is chosen by the analyst – it is the group that is coded zero on all dummies, or the group whose dummy variable is "left out" of the $C-1$ dummy variables.  </span>
<span id="cb83-704"><a href="#cb83-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-705"><a href="#cb83-705" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The regression coefficients of the dummy variables are interpreted as the difference between the mean of the indicated group and the mean of the reference group</span>
<span id="cb83-706"><a href="#cb83-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-707"><a href="#cb83-707" aria-hidden="true" tabindex="-1"></a>Reference-group coding is the default contrast coding in R. However, in order for contrast coding to be implemented, our categorical predictor needs to be represented in R as a <span class="in">`factor`</span>.</span>
<span id="cb83-708"><a href="#cb83-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-709"><a href="#cb83-709" aria-hidden="true" tabindex="-1"></a><span class="fu">### More about factors</span></span>
<span id="cb83-710"><a href="#cb83-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-711"><a href="#cb83-711" aria-hidden="true" tabindex="-1"></a>Factors are the way that R deals with categorical data. If you want to know if your variable is a factor or not, you can use the functions <span class="in">`class`</span> or <span class="in">`is.factor`</span>. Let's illustrate this with the <span class="in">`urban`</span> variable from NELS.</span>
<span id="cb83-712"><a href="#cb83-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-715"><a href="#cb83-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-716"><a href="#cb83-716" aria-hidden="true" tabindex="-1"></a><span class="co"># Two ways of checking what type a variable is </span></span>
<span id="cb83-717"><a href="#cb83-717" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(urban)</span>
<span id="cb83-718"><a href="#cb83-718" aria-hidden="true" tabindex="-1"></a><span class="fu">is.factor</span>(urban)</span>
<span id="cb83-719"><a href="#cb83-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-720"><a href="#cb83-720" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out the levels of a factor using "levels"</span></span>
<span id="cb83-721"><a href="#cb83-721" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(urban)</span>
<span id="cb83-722"><a href="#cb83-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-723"><a href="#cb83-723" aria-hidden="true" tabindex="-1"></a><span class="co"># Find out what contrast coding R is using for a factor "constrasts"</span></span>
<span id="cb83-724"><a href="#cb83-724" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span>
<span id="cb83-725"><a href="#cb83-725" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-726"><a href="#cb83-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-727"><a href="#cb83-727" aria-hidden="true" tabindex="-1"></a>In the above code, we see that <span class="in">`urban`</span> is a factor with 3 levels and the default reference-group contrasts are set up so that <span class="in">`Rural`</span> is the reference group. Below we will show how to change the contrasts for a variable. </span>
<span id="cb83-728"><a href="#cb83-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-729"><a href="#cb83-729" aria-hidden="true" tabindex="-1"></a>If we are working with a variable that is not a factor, but we want R to treat it as a factor, we can use the <span class="in">`factor`</span> command. Let's illustrate this by turning <span class="in">`binary_gender`</span> back into a factor. </span>
<span id="cb83-730"><a href="#cb83-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-733"><a href="#cb83-733" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-734"><a href="#cb83-734" aria-hidden="true" tabindex="-1"></a><span class="co"># Change a numeric variable into a factor</span></span>
<span id="cb83-735"><a href="#cb83-735" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(binary_gender)</span>
<span id="cb83-736"><a href="#cb83-736" aria-hidden="true" tabindex="-1"></a>factor_gender <span class="ot">&lt;-</span> <span class="fu">factor</span>(binary_gender)</span>
<span id="cb83-737"><a href="#cb83-737" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(factor_gender)</span>
<span id="cb83-738"><a href="#cb83-738" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(factor_gender)</span>
<span id="cb83-739"><a href="#cb83-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-740"><a href="#cb83-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-741"><a href="#cb83-741" aria-hidden="true" tabindex="-1"></a>We can also use the <span class="in">`levels`</span> function to tell R what labels we want it to use for our factor. <span class="in">`levels`</span> should be assigned a text vector with length equal to the number of levels of the variable. The entries of the assigned vector will be the new level names of the factor. </span>
<span id="cb83-742"><a href="#cb83-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-745"><a href="#cb83-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-746"><a href="#cb83-746" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the levels of factor_gender to "F" and "M"</span></span>
<span id="cb83-747"><a href="#cb83-747" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(factor_gender) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>)</span>
<span id="cb83-748"><a href="#cb83-748" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(factor_gender)</span>
<span id="cb83-749"><a href="#cb83-749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-750"><a href="#cb83-750" aria-hidden="true" tabindex="-1"></a><span class="fu">### Back to reference-group coding</span></span>
<span id="cb83-751"><a href="#cb83-751" aria-hidden="true" tabindex="-1"></a>OK, back to reference coding. Let's see what <span class="in">`lm`</span> does when we regress <span class="in">`achrdg08`</span> on <span class="in">`urban`</span>. </span>
<span id="cb83-752"><a href="#cb83-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-755"><a href="#cb83-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-756"><a href="#cb83-756" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb83-757"><a href="#cb83-757" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span>
<span id="cb83-758"><a href="#cb83-758" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-759"><a href="#cb83-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-760"><a href="#cb83-760" aria-hidden="true" tabindex="-1"></a>In the output, we see that two regression coefficients are reported, one for <span class="in">`Suburban`</span> and one for <span class="in">`Urban`</span>. As discussed in Section \@ref(reference-group-coding-5), these coefficients are the mean difference between the indicated group and the reference group (<span class="in">`Rural`</span>). </span>
<span id="cb83-761"><a href="#cb83-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-762"><a href="#cb83-762" aria-hidden="true" tabindex="-1"></a>We can see that Urban students scores significantly higher than Rural students (3.125 percentage points), but there was no significant difference between Rural and Suburban students. </span>
<span id="cb83-763"><a href="#cb83-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-764"><a href="#cb83-764" aria-hidden="true" tabindex="-1"></a>The intercept is the mean of the reference group (<span class="in">`rural`</span>) -- about 55% on the reading test. </span>
<span id="cb83-765"><a href="#cb83-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-766"><a href="#cb83-766" aria-hidden="true" tabindex="-1"></a>Note the R-squared -- Urbanicity accounts for about 2% of the variation reading achievement. As usual, the F-test of R-squared has degrees of freedom $K$ and $N - K -1$, but now $K$ (the number of predictors) is equal to $C - 1$ -- the number of categories minus one.</span>
<span id="cb83-767"><a href="#cb83-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-768"><a href="#cb83-768" aria-hidden="true" tabindex="-1"></a><span class="fu">### Changing the reference group</span></span>
<span id="cb83-769"><a href="#cb83-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-770"><a href="#cb83-770" aria-hidden="true" tabindex="-1"></a>What if we wanted to use a group other than <span class="in">`Rural`</span> as the reference group? We can chose a different reference group using the <span class="in">`cont.treatment`</span> function. This function takes two arguments</span>
<span id="cb83-771"><a href="#cb83-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-772"><a href="#cb83-772" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`n`</span> tells R how many levels there</span>
<span id="cb83-773"><a href="#cb83-773" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span><span class="in">`base`</span> tells R which level should be the reference group </span>
<span id="cb83-774"><a href="#cb83-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-777"><a href="#cb83-777" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-778"><a href="#cb83-778" aria-hidden="true" tabindex="-1"></a><span class="co"># The current reference group is Rural</span></span>
<span id="cb83-779"><a href="#cb83-779" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span>
<span id="cb83-780"><a href="#cb83-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-781"><a href="#cb83-781" aria-hidden="true" tabindex="-1"></a><span class="co"># Chance the reference group to the Urban (i.e., the last level)</span></span>
<span id="cb83-782"><a href="#cb83-782" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban) <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">base =</span> <span class="dv">3</span>)</span>
<span id="cb83-783"><a href="#cb83-783" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span>
<span id="cb83-784"><a href="#cb83-784" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-785"><a href="#cb83-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-786"><a href="#cb83-786" aria-hidden="true" tabindex="-1"></a>Note that when we first ran <span class="in">`contrasts(urban)`</span>, the column names were names of the levels.  But after changing the reference group, the column names are just the numbers 1 and 2. To help interpret the <span class="in">`lm`</span> output, it is helpful to name the contrast levels appropriately</span>
<span id="cb83-787"><a href="#cb83-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-790"><a href="#cb83-790" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-791"><a href="#cb83-791" aria-hidden="true" tabindex="-1"></a><span class="co"># Naming our new contrasts</span></span>
<span id="cb83-792"><a href="#cb83-792" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(urban)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rural"</span>, <span class="st">"Suburban"</span>)</span>
<span id="cb83-793"><a href="#cb83-793" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span>
<span id="cb83-794"><a href="#cb83-794" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-795"><a href="#cb83-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-796"><a href="#cb83-796" aria-hidden="true" tabindex="-1"></a>Now we are ready to run our regression again, this time using a different reference group.</span>
<span id="cb83-797"><a href="#cb83-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-800"><a href="#cb83-800" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-801"><a href="#cb83-801" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb83-802"><a href="#cb83-802" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)</span>
<span id="cb83-803"><a href="#cb83-803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-804"><a href="#cb83-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-805"><a href="#cb83-805" aria-hidden="true" tabindex="-1"></a>Compared to the output from <span class="in">`mod2`</span>, note that </span>
<span id="cb83-806"><a href="#cb83-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-807"><a href="#cb83-807" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The intercept now represents the mean reading scores of the Urban group, because this is the new reference group.</span>
<span id="cb83-808"><a href="#cb83-808" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-809"><a href="#cb83-809" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The regression coefficients now represent the mean difference between the indicated group with the new reference group.</span>
<span id="cb83-810"><a href="#cb83-810" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-811"><a href="#cb83-811" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The R-square and F stay the same -- in other words, the total amount of variation explained by the variable <span class="in">`urban`</span> does not change, just because we changed the reference group. </span>
<span id="cb83-812"><a href="#cb83-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-813"><a href="#cb83-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-814"><a href="#cb83-814" aria-hidden="true" tabindex="-1"></a><span class="fu">### Deviation coding</span></span>
<span id="cb83-815"><a href="#cb83-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-816"><a href="#cb83-816" aria-hidden="true" tabindex="-1"></a>It is possible to change R's default contrast coding to one of the other built-in contrasts (see <span class="in">`help(contrasts)`</span> for more information on the built in contrasts).</span>
<span id="cb83-817"><a href="#cb83-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-818"><a href="#cb83-818" aria-hidden="true" tabindex="-1"></a>For instance, to change to deviation coding, we use R's <span class="in">`contr.sum`</span> function and tell it how many levels there are for the factor (<span class="in">`n`</span>). In deviation coding, the intercept is equal to the unweighted mean of the predicted values, and the regression coefficients are difference between the indicated group and the unweighted mean. </span>
<span id="cb83-819"><a href="#cb83-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-822"><a href="#cb83-822" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-823"><a href="#cb83-823" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban) <span class="ot">&lt;-</span> <span class="fu">contr.sum</span>(<span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb83-824"><a href="#cb83-824" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban)</span>
<span id="cb83-825"><a href="#cb83-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-826"><a href="#cb83-826" aria-hidden="true" tabindex="-1"></a><span class="co"># As above, it is helpful to name the contrasts using "colnames"</span></span>
<span id="cb83-827"><a href="#cb83-827" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(urban)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Rural"</span>, <span class="st">"Suburban"</span>)</span>
<span id="cb83-828"><a href="#cb83-828" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-829"><a href="#cb83-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-830"><a href="#cb83-830" aria-hidden="true" tabindex="-1"></a>Now we are all set to use deviation coding with <span class="in">`lm`</span>.</span>
<span id="cb83-831"><a href="#cb83-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-834"><a href="#cb83-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-835"><a href="#cb83-835" aria-hidden="true" tabindex="-1"></a>mod4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span>  urban)</span>
<span id="cb83-836"><a href="#cb83-836" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span>
<span id="cb83-837"><a href="#cb83-837" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-838"><a href="#cb83-838" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-839"><a href="#cb83-839" aria-hidden="true" tabindex="-1"></a>Note the following things about the output: </span>
<span id="cb83-840"><a href="#cb83-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-841"><a href="#cb83-841" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The regression coefficients compare each group's mean to the unweighted mean of the groups. Rural and Suburban students are below the unweighted mean, but the difference is only significant for Rural. </span>
<span id="cb83-842"><a href="#cb83-842" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-843"><a href="#cb83-843" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Although the output looks similar to that of <span class="in">`mod3`</span>, the coefficients are all different and they all have different interpretations. The <span class="in">`lm`</span> output doesn't tell us this, we have to know what is going on under the hood. </span>
<span id="cb83-844"><a href="#cb83-844" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-845"><a href="#cb83-845" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The R-square does not change from <span class="in">`mod2`</span> -- again, the type of contrast coding used doesn't affect how much variation is explained by the predictor.  </span>
<span id="cb83-846"><a href="#cb83-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-847"><a href="#cb83-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-848"><a href="#cb83-848" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extra: Relation to ANOVA  </span></span>
<span id="cb83-849"><a href="#cb83-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-850"><a href="#cb83-850" aria-hidden="true" tabindex="-1"></a>As our next exercise, let's compare the output of <span class="in">`lm`</span> and the output of <span class="in">`aov`</span> -- R's module for Analysis of Variance. If regression and ANOVA are really doing the same thing, we should be able to illustrate it with these two modules. Note that if you check out <span class="in">`help(aov)`</span>, it explicitly states that <span class="in">`aov`</span> uses the <span class="in">`lm`</span> function, so, finding that the two approaches give similar output shouldn't be a big surprise!</span>
<span id="cb83-851"><a href="#cb83-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-852"><a href="#cb83-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-855"><a href="#cb83-855" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-856"><a href="#cb83-856" aria-hidden="true" tabindex="-1"></a><span class="co"># Run our model as an ANOVA</span></span>
<span id="cb83-857"><a href="#cb83-857" aria-hidden="true" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(achrdg08 <span class="sc">~</span> urban)</span>
<span id="cb83-858"><a href="#cb83-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-859"><a href="#cb83-859" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the output with lm</span></span>
<span id="cb83-860"><a href="#cb83-860" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov1)</span>
<span id="cb83-861"><a href="#cb83-861" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span>
<span id="cb83-862"><a href="#cb83-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-863"><a href="#cb83-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-864"><a href="#cb83-864" aria-hidden="true" tabindex="-1"></a>If we compare the output from <span class="in">`aov`</span> to the F-test reported by <span class="in">`lm`</span> we see that the F-stat, degrees of freedom, and p-value are all identical. If we compute eta-squared from aov, we also find that it is equal to the R-squared value from <span class="in">`lm`</span>. </span>
<span id="cb83-865"><a href="#cb83-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-868"><a href="#cb83-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-869"><a href="#cb83-869" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute eta-squared from aov output</span></span>
<span id="cb83-870"><a href="#cb83-870" aria-hidden="true" tabindex="-1"></a><span class="dv">741</span> <span class="sc">/</span> (<span class="dv">741</span> <span class="sc">+</span> <span class="dv">38163</span>)</span>
<span id="cb83-871"><a href="#cb83-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-872"><a href="#cb83-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-873"><a href="#cb83-873" aria-hidden="true" tabindex="-1"></a>In short, ANOVA and regression are doing the same thing: R-squared is the same as omega-squared and the ANOVA omnibus F-test is the same as the F-test of R-squared. The main difference is that <span class="in">`lm`</span> focuses on contrasts for analyzing and interpreting the group differences, whereas ANOVA focuses on the F-test of the omnibus hypothesis and the procedures for analyzing group difference are conducted as a follow-up step.</span>
<span id="cb83-874"><a href="#cb83-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-875"><a href="#cb83-875" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extra: Group-mean coding</span></span>
<span id="cb83-876"><a href="#cb83-876" aria-hidden="true" tabindex="-1"></a>As a step towards addresses the issues with deviation coding, let's consider another coding procedure. If we omit the intercept term, all of the reference-group coded dummies can be included and the regression coefficients now correspond to means of each group. We omit the intercept using <span class="in">`-1`</span> in the model formula. </span>
<span id="cb83-877"><a href="#cb83-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-880"><a href="#cb83-880" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-881"><a href="#cb83-881" aria-hidden="true" tabindex="-1"></a><span class="co"># Omit the intercept using -1</span></span>
<span id="cb83-882"><a href="#cb83-882" aria-hidden="true" tabindex="-1"></a>mod5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(achrdg08 <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> urban)</span>
<span id="cb83-883"><a href="#cb83-883" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod5)</span>
<span id="cb83-884"><a href="#cb83-884" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-885"><a href="#cb83-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-886"><a href="#cb83-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-887"><a href="#cb83-887" aria-hidden="true" tabindex="-1"></a>Note the following things about the output: </span>
<span id="cb83-888"><a href="#cb83-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-889"><a href="#cb83-889" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The coefficients are no **longer interpreted mean differences**, just the raw means. </span>
<span id="cb83-890"><a href="#cb83-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-891"><a href="#cb83-891" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The R-square and F-test **do** change from <span class="in">`mod2`</span>. When the intercept is omitted, R-squared can no longer interpretated as a proportion of variance   unless the variable $Y$ variable is centered. When the intercept is omitted, it also changes the degrees of freedom in the F-test, because there are now 3 predictors instead of 2. In general, when the intercept is omitted, R-square and its F-test do not have the usual interpretation. When reporting R-squared and its F-test, we should use a model with the intercept.  </span>
<span id="cb83-892"><a href="#cb83-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-893"><a href="#cb83-893" aria-hidden="true" tabindex="-1"></a>By itself, group mean coding is not very interesting uninteresting -- we don't usually want to test whether the group means are different from zero. However, we will see in the next section that it can be used to provide an alternative to deviation coding. </span>
<span id="cb83-894"><a href="#cb83-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-895"><a href="#cb83-895" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extra: Weighted versus unweighted deviation coding</span></span>
<span id="cb83-896"><a href="#cb83-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-897"><a href="#cb83-897" aria-hidden="true" tabindex="-1"></a>This section presents a "hack" for addressing the two main issues with deviation coding noted in Section \@ref(deviation-coding-5). This is a hack in the sense that we are working around R's usual procedures rather than replacing them with a completely new procedure. The result of this hack is to provide deviation coding in which comparisons are made to grand mean on the outcome for all $C$ categories, not just $C-1$ categories. As a side effect, the F-test for the R-squared statistic is no longer correct, so you should not use this approach to report R-squared. </span>
<span id="cb83-898"><a href="#cb83-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-899"><a href="#cb83-899" aria-hidden="true" tabindex="-1"></a>First, note that the group sample sizes are not equal for <span class="in">`ubran`</span></span>
<span id="cb83-900"><a href="#cb83-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-903"><a href="#cb83-903" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-904"><a href="#cb83-904" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(urban)</span>
<span id="cb83-905"><a href="#cb83-905" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-906"><a href="#cb83-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-907"><a href="#cb83-907" aria-hidden="true" tabindex="-1"></a>Because of this, the unweighted mean of the group means (i.e., the intercept in <span class="in">`mod4`</span> above) is not equal to the overall mean on <span class="in">`achrdg08`</span> -- we can see that the overall mean and the unweighted group means are slightly different for these data: </span>
<span id="cb83-908"><a href="#cb83-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-911"><a href="#cb83-911" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-912"><a href="#cb83-912" aria-hidden="true" tabindex="-1"></a>group_means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(achrdg08, <span class="at">INDEX =</span> urban, <span class="at">FUN =</span> mean)</span>
<span id="cb83-913"><a href="#cb83-913" aria-hidden="true" tabindex="-1"></a>group_means</span>
<span id="cb83-914"><a href="#cb83-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-915"><a href="#cb83-915" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare the overall mean and the unweighted mean of the group means</span></span>
<span id="cb83-916"><a href="#cb83-916" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the outcome variable</span></span>
<span id="cb83-917"><a href="#cb83-917" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fu">mean</span>(achrdg08)</span>
<span id="cb83-918"><a href="#cb83-918" aria-hidden="true" tabindex="-1"></a>ybar</span>
<span id="cb83-919"><a href="#cb83-919" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(group_means)</span>
<span id="cb83-920"><a href="#cb83-920" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-921"><a href="#cb83-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-922"><a href="#cb83-922" aria-hidden="true" tabindex="-1"></a>Note that the intercept in <span class="in">`mod4`</span> is not equal to the overall mean, <span class="in">`ybar`</span>, but is instead equal to the unweighted average of the group means, <span class="in">`mean(group_means)`</span>. the difference isnt very big in this example, but it can be quite drastic with highly unequal sample sizes. </span>
<span id="cb83-923"><a href="#cb83-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-924"><a href="#cb83-924" aria-hidden="true" tabindex="-1"></a>If you would like to compare the groups to the overall mean when the sample sizes are unequal, the simplest way to do this in R is by first centering the Y variable and then using group mean coding.  </span>
<span id="cb83-925"><a href="#cb83-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-926"><a href="#cb83-926" aria-hidden="true" tabindex="-1"></a>After centering, the grand mean of $Y$ is zero, and so the group means represent deviations from the grand mean (i.e., deviations from zero) and the tests of the regression coefficients are tests of whether the group means are different from the grand mean. </span>
<span id="cb83-927"><a href="#cb83-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-930"><a href="#cb83-930" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb83-931"><a href="#cb83-931" aria-hidden="true" tabindex="-1"></a><span class="co"># Change the contrasts back to reference group</span></span>
<span id="cb83-932"><a href="#cb83-932" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(urban) <span class="ot">&lt;-</span> <span class="fu">contr.treatment</span>(<span class="at">n =</span> <span class="dv">3</span>, <span class="at">base  =</span> <span class="dv">1</span>)</span>
<span id="cb83-933"><a href="#cb83-933" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(<span class="fu">contrasts</span>(urban)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Suburban"</span>, <span class="st">"Urban"</span>)</span>
<span id="cb83-934"><a href="#cb83-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-935"><a href="#cb83-935" aria-hidden="true" tabindex="-1"></a><span class="co"># Center the outcome variable</span></span>
<span id="cb83-936"><a href="#cb83-936" aria-hidden="true" tabindex="-1"></a>dev_achrdg08 <span class="ot">&lt;-</span> achrdg08 <span class="sc">-</span> ybar</span>
<span id="cb83-937"><a href="#cb83-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-938"><a href="#cb83-938" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the regression with group mean coding</span></span>
<span id="cb83-939"><a href="#cb83-939" aria-hidden="true" tabindex="-1"></a>mod6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(dev_achrdg08 <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> urban)</span>
<span id="cb83-940"><a href="#cb83-940" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod6)</span>
<span id="cb83-941"><a href="#cb83-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb83-942"><a href="#cb83-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-943"><a href="#cb83-943" aria-hidden="true" tabindex="-1"></a>Note the following things about the output: </span>
<span id="cb83-944"><a href="#cb83-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-945"><a href="#cb83-945" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The regression coefficients compare each group's mean to the overall mean on the outcome. Urban students are significantly above average, Rural and Suburban students are below average but the difference is not significant. </span>
<span id="cb83-946"><a href="#cb83-946" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb83-947"><a href="#cb83-947" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>The R-square is the same as <span class="in">`mod2`</span> because the Y variable is centered, but the F test **does** change from <span class="in">`mod2`</span>, because there are now 3 variables included in the model. In general, when the intercept is omitted, R-square and its F-test do not have the usual interpretation. So, when reporting R-squared and F-test, we should use a model with the intercept, rather than the approach outlined here. </span>
<span id="cb83-948"><a href="#cb83-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-949"><a href="#cb83-949" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = F}</span></span>
<span id="cb83-950"><a href="#cb83-950" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(NELS)</span>
<span id="cb83-951"><a href="#cb83-951" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>