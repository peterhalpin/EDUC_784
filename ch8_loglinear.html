<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>EDUC 784 - 8&nbsp; Log-linear regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch7_assumption_checking.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch8_loglinear.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Log-linear regression</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">EDUC 784</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1_review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2_simple_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simple regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3_two_predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Two predictors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4_categorical_predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Categorical predictors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5_interactions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Interactions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6_model_building.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model building</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7_assumption_checking.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Assumption checking</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch8_loglinear.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Log-linear regression</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-math-review-8" id="toc-sec-math-review-8" class="nav-link active" data-scroll-target="#sec-math-review-8"><span class="header-section-number">8.1</span> Math review</a>
  <ul class="collapse">
  <li><a href="#natural-logarithm" id="toc-natural-logarithm" class="nav-link" data-scroll-target="#natural-logarithm"><span class="header-section-number">8.1.1</span> Natural logarithm</a></li>
  <li><a href="#log-and-exp" id="toc-log-and-exp" class="nav-link" data-scroll-target="#log-and-exp"><span class="header-section-number">8.1.2</span> log and exp</a></li>
  <li><a href="#pop-quiz" id="toc-pop-quiz" class="nav-link" data-scroll-target="#pop-quiz"><span class="header-section-number">8.1.3</span> Pop quiz</a></li>
  <li><a href="#rules-for-log-and-exp" id="toc-rules-for-log-and-exp" class="nav-link" data-scroll-target="#rules-for-log-and-exp"><span class="header-section-number">8.1.4</span> Rules for log and exp*</a></li>
  </ul></li>
  <li><a href="#the-log-linear-model" id="toc-the-log-linear-model" class="nav-link" data-scroll-target="#the-log-linear-model"><span class="header-section-number">8.2</span> The log-linear model</a></li>
  <li><a href="#sec-distribution-8" id="toc-sec-distribution-8" class="nav-link" data-scroll-target="#sec-distribution-8"><span class="header-section-number">8.3</span> Distribution of <span class="math inline">\(\log(Y)\)</span></a>
  <ul class="collapse">
  <li><a href="#why-logx1" id="toc-why-logx1" class="nav-link" data-scroll-target="#why-logx1"><span class="header-section-number">8.3.1</span> Why <span class="math inline">\(\log(x+1)\)</span>?</a></li>
  <li><a href="#what-about-negative-values-of-x" id="toc-what-about-negative-values-of-x" class="nav-link" data-scroll-target="#what-about-negative-values-of-x"><span class="header-section-number">8.3.2</span> What about negative values of <span class="math inline">\(x\)</span>?</a></li>
  <li><a href="#skew-versus-censoring" id="toc-skew-versus-censoring" class="nav-link" data-scroll-target="#skew-versus-censoring"><span class="header-section-number">8.3.3</span> Skew versus censoring</a></li>
  <li><a href="#final-comments-on-dealing-with-skew" id="toc-final-comments-on-dealing-with-skew" class="nav-link" data-scroll-target="#final-comments-on-dealing-with-skew"><span class="header-section-number">8.3.4</span> Final comments on dealing with skew</a></li>
  </ul></li>
  <li><a href="#sec-relationship-8" id="toc-sec-relationship-8" class="nav-link" data-scroll-target="#sec-relationship-8"><span class="header-section-number">8.4</span> Relationship with <span class="math inline">\(X\)</span></a></li>
  <li><a href="#sec-interpretation-8" id="toc-sec-interpretation-8" class="nav-link" data-scroll-target="#sec-interpretation-8"><span class="header-section-number">8.5</span> Interpretation</a>
  <ul class="collapse">
  <li><a href="#sec-approximate-8" id="toc-sec-approximate-8" class="nav-link" data-scroll-target="#sec-approximate-8"><span class="header-section-number">8.5.1</span> Approximate interpretation</a></li>
  <li><a href="#a-hypothetical-example" id="toc-a-hypothetical-example" class="nav-link" data-scroll-target="#a-hypothetical-example"><span class="header-section-number">8.5.2</span> A hypothetical example</a></li>
  <li><a href="#sec-exact-9" id="toc-sec-exact-9" class="nav-link" data-scroll-target="#sec-exact-9"><span class="header-section-number">8.5.3</span> Exact interpretation</a></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">8.5.4</span> Summary</a></li>
  <li><a href="#sec-derivation-8" id="toc-sec-derivation-8" class="nav-link" data-scroll-target="#sec-derivation-8"><span class="header-section-number">8.5.5</span> Derivation of Equation&nbsp;<span>8.2</span> *</a></li>
  </ul></li>
  <li><a href="#sec-worked-example-8" id="toc-sec-worked-example-8" class="nav-link" data-scroll-target="#sec-worked-example-8"><span class="header-section-number">8.6</span> Worked example</a>
  <ul class="collapse">
  <li><a href="#log-linear-regression-of-wages-on-education" id="toc-log-linear-regression-of-wages-on-education" class="nav-link" data-scroll-target="#log-linear-regression-of-wages-on-education"><span class="header-section-number">8.6.1</span> Log-linear regression of Wages on Education</a></li>
  </ul></li>
  <li><a href="#sec-workbook-8" id="toc-sec-workbook-8" class="nav-link" data-scroll-target="#sec-workbook-8"><span class="header-section-number">8.7</span> Workbook</a></li>
  <li><a href="#exercises-9" id="toc-exercises-9" class="nav-link" data-scroll-target="#exercises-9"><span class="header-section-number">8.8</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#linear-regression-of-wages-on-education" id="toc-linear-regression-of-wages-on-education" class="nav-link" data-scroll-target="#linear-regression-of-wages-on-education"><span class="header-section-number">8.8.1</span> Linear regression of Wages on Education</a></li>
  <li><a href="#log-linear-regression-of-wages-on-education-1" id="toc-log-linear-regression-of-wages-on-education-1" class="nav-link" data-scroll-target="#log-linear-regression-of-wages-on-education-1"><span class="header-section-number">8.8.2</span> Log-linear regression of Wages on Education</a></li>
  </ul></li>
  <li><a href="#write-up" id="toc-write-up" class="nav-link" data-scroll-target="#write-up"><span class="header-section-number">8.9</span> Write up</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-chap-8" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Log-linear regression</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In the previous chapter we considered how to check the population assumptions of linear regression for a given data set. In this chapter we discuss one way to deal with assumption violations – by “transforming” the <span class="math inline">\(Y\)</span> variable. In general, a transformation is just a function we apply to a variable to change it into another variable. We have already seen some examples of transformations: centering or deviation scores, standardizing or z-scores, and percentiles.</p>
<p>In this chapter we will apply the log transformation to the <span class="math inline">\(Y\)</span> variable in a regression model, which results in the log-linear regression model. This transformation is widely used to address skew in the <span class="math inline">\(Y\)</span> variable / residuals, and it also serves to illustrate the overall approach to transforming the <span class="math inline">\(Y\)</span> variable in a regression model to address assumption violations.</p>
<p>There are two big themes to this chapter. First, whenever we apply a non-linear transform to the <span class="math inline">\(Y\)</span> variable in a regression model, it always has three types of consequences. It affects:</p>
<ol type="1">
<li>The distribution of the variable / residuals.</li>
<li>The (non-)linearity of its relationship with predictor variables.</li>
<li>The interpretation of the regression coefficients.</li>
</ol>
<p>We have to consider all three of these consequences when transforming the <span class="math inline">\(Y\)</span> variable. In particular, we might find that addressing one problem (e.g., non-normality) can create other problems (e.g., nonlinearity). The moral is that addressing assumption violations by transforming the <span class="math inline">\(Y\)</span> variable is not always as straightforward as we might hope.</p>
<p>The other big theme of this chapter is the overall strategy for dealing with assumption violations. In particular, when we are faced with data that are not compatible with the assumptions of regression modeling, we often proceed as follows:</p>
<ol type="1">
<li><p>Transform the data to make them compatible with linear regression (or some other model we know how to use).</p></li>
<li><p>Run the analysis on the transformed data.</p></li>
<li><p>“Reverse-transform” the results of the analysis so that they are interpretable in terms of the original variable(s).</p></li>
</ol>
<p>We will see this “transform<span class="math inline">\(\rightarrow\)</span>analyze<span class="math inline">\(\rightarrow\)</span>reverse- transform” strategy in this chapter, and again when we cover logistic regression in <span class="quarto-unresolved-ref">?sec-chap-10</span>. Both of these approaches are exemplars of <em>generalized linear modeling</em>, which is an advanced regression topic that formalizes the intuitive idea behind this approach.</p>
<p>This chapter addresses transformations of the <span class="math inline">\(Y\)</span>-variable only. Another approach for dealing with assumption violations in linear regression is to transform one or more of the <span class="math inline">\(X\)</span> variables instead of (or in addition to) the <span class="math inline">\(Y\)</span> variable. These approaches are discussed in the next chapter.</p>
<section id="sec-math-review-8" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sec-math-review-8"><span class="header-section-number">8.1</span> Math review</h2>
<p>Let’s start with a review the requisite math – logs and exponents. We are going to use these concepts later in the course as well, so it is worth sorting them out. If you haven’t seen logs or exponents in while, brace yourself. This fist section of the math review covers the basic interpretation of logs and their utility for reducing skewness. The following sections add some details.</p>
<p>In this math review, we use the lowercase symbols <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> for generic mathematical variables. These symbols do not correspond to the uppercase symbols <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> in regression notation. So, e.g., <span class="math inline">\(x\)</span> is not a predictor, its just a generic variable.</p>
<p>The function <span class="math inline">\(\log_{10}(x)\)</span> returns the power to which we need to raise 10 to get the value <span class="math inline">\(x\)</span>. It answers the question: <span class="math inline">\(10^? = x\)</span>.</p>
<p>Some examples:</p>
<ul>
<li><span class="math inline">\(\log_{10}(10) = 1\)</span>, because <span class="math inline">\(10^1 = 10\)</span></li>
<li><span class="math inline">\(\log_{10}(100) = 2\)</span>, because <span class="math inline">\(10^2 = 100\)</span></li>
<li><span class="math inline">\(\log_{10}(1000) = 3\)</span>, because <span class="math inline">\(10^3 = 1000\)</span></li>
<li>…</li>
</ul>
<p>In <a href="#fig-logx">Figure&nbsp;<span>8.1</span></a>, the three values computed above are shown as vertical dashed lines. In general, the plots shows that for every order of magnitude that <span class="math inline">\(x\)</span> increases (e.g., from 10 to 100, or from 100 to 1000), its log only increases by one unit. Intuitively, this means that “big differences” on <span class="math inline">\(x\)</span> translate into “small differences” on <span class="math inline">\(\log(x)\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-logx" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/logx.png" class="img-fluid figure-img" width="648"></p>
<figcaption class="figure-caption">Figure&nbsp;8.1: Log base 10</figcaption>
</figure>
</div>
</div>
</div>
<p>This “compression” of large values down to a smaller scale turns out to be useful for dealing with positive skew, as illustrated in <a href="#fig-logdata">Figure&nbsp;<span>8.2</span></a>. This is a main reason that the log transform is widely used – to reduce positive skew.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-logdata" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch8_loglinear_files/figure-html/fig-logdata-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.2: Log transform and positive skew</figcaption>
</figure>
</div>
</div>
</div>
<section id="natural-logarithm" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="natural-logarithm"><span class="header-section-number">8.1.1</span> Natural logarithm</h3>
<p>The symbol <span class="math inline">\(\log_{10}\)</span> is read “log base 10”. In statistics, we usually use a different base – log base <span class="math inline">\(e\)</span>. Here <span class="math inline">\(e = 2.7182...\)</span> is an irrational number called <em>Euler’s number</em>. We will see later on that using <span class="math inline">\(\log_e\)</span> makes the interpretation of log-linear regression simpler. Note that in this context, <span class="math inline">\(e\)</span> is not the residual from a regression model. Whether <span class="math inline">\(e\)</span> denotes Euler’s number or regression residuals should be clear from context.</p>
<p>Regardless of which base we use, logs have the same overall compression effect, as shown in <a href="#fig-loge">Figure&nbsp;<span>8.3</span></a>. For example, <span class="math inline">\(\log_{10}(1000) = 3\)</span> and <span class="math inline">\(\log_{e}(1000) \approx 7\)</span> – both numbers are much smaller than <span class="math inline">\(1000\)</span>, which means that both functions achieve the same overall result of making big values into smaller values. The same is true when applied to real data – in fact, the right hand panel in <a href="#fig-logdata">Figure&nbsp;<span>8.2</span></a> was computed using <span class="math inline">\(\log_e\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-loge" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/loge.png" class="img-fluid figure-img" width="750"></p>
<figcaption class="figure-caption">Figure&nbsp;8.3: Log base 10 vs log base e</figcaption>
</figure>
</div>
</div>
</div>
<p>Log base <span class="math inline">\(e\)</span>, or <span class="math inline">\(\log_e\)</span>,is called the <em>natural logarithm</em> and often denoted “<span class="math inline">\(\ln\)</span>”. But <span class="math inline">\(\ln\)</span> can be hard to read so we will just stick with <span class="math inline">\(\log\)</span> and omit the base symbol when we mean <span class="math inline">\(\log_e\)</span>. This is consistent with what R’s <code>log</code> function does – its default base is <span class="math inline">\(e\)</span>.</p>
</section>
<section id="log-and-exp" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="log-and-exp"><span class="header-section-number">8.1.2</span> log and exp</h3>
<p>Recall that our overall modeling strategy in log-linear regression is “transform<span class="math inline">\(\rightarrow\)</span>analyze<span class="math inline">\(\rightarrow\)</span>reverse- transform”. In mathematics, the reverse transform is called the <em>inverse</em> of the original function. The inverse of the logarithm is exponentiation. So, if we start by log-transforming our <span class="math inline">\(Y\)</span>-variable, we are going to end up doing exponents later on.</p>
<p>To see how <span class="math inline">\(\log\)</span> and <span class="math inline">\(\exp\)</span> work together, let’s start with the number <span class="math inline">\(x= 100\)</span>, and take the log of that number:</p>
<p><span class="math display">\[ \log(100) =  4.60517 \]</span> This equation tells us that if we raise <span class="math inline">\(e\)</span> to the power of <span class="math inline">\(4.60517\)</span> the result will be <span class="math inline">\(100\)</span>. We can think of <span class="math inline">\(x = 100\)</span> as our original data and <span class="math inline">\(y = 4.60517\)</span> as our transformed value.</p>
<p>By definition of the logarithm, we can equivalently write <span class="math inline">\(\log(100) = 4.60517\)</span> as</p>
<p><span class="math display">\[e^{4.60517} = 100. \]</span> This equation uses exponents (raise <span class="math inline">\(e\)</span> to a power) rather than logs, but it communicates the same information as the previous equation. In our second equation, we take the output of the log (<span class="math inline">\(y = 4.60517\)</span>) and use it as input to the exponent. The exponent then returns the original value of <span class="math inline">\(x = 100\)</span>.</p>
<p>The mathematical symbol <span class="math inline">\(\exp(y)\)</span> is often used instead of <span class="math inline">\(e^y\)</span> to avoid having to write complicated expressions in the superscript. So we can more clearly write the above equation as</p>
<p><span class="math display">\[\exp(4.60517) = 100. \]</span> This is just a change of notation so we don’t have to typeset superscripts.</p>
<p>To summarize: the two equations presented below are equivalent by definition:</p>
<p><span class="math display">\[ \log(100) =  4.60517 \quad \text{and} \quad \exp (4.60517 ) = 100.\]</span></p>
<p>In the first one, we take the input value <span class="math inline">\(x = 100\)</span> and transform it using the logarithm, which gives us the transformed value <span class="math inline">\(y = 4.60517\)</span>. In the second equation, we take the transformed value <span class="math inline">\(y = 4.60517\)</span> as input into the exponent, which gives us back the original value of <span class="math inline">\(x = 100\)</span>.</p>
<p>In general, the relationship between the two functions is:</p>
<p><span class="math display">\[\log(x) = y \quad  \text{and} \quad \exp (y) = x. \]</span></p>
</section>
<section id="pop-quiz" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="pop-quiz"><span class="header-section-number">8.1.3</span> Pop quiz</h3>
<p>I’ll ask some questions like the following to start class off. <strong>Please write down your answers and be prepared to share them in class</strong>. You check your answers by pasting the questions into <span class="math inline">\(R\)</span> or Google’s search bar.</p>
<ul>
<li><span class="math inline">\(\log(2.7182) = ?\)</span></li>
<li><span class="math inline">\(\log(1) = ?\)</span></li>
<li><span class="math inline">\(\log(0) = ?\)</span></li>
<li><span class="math inline">\(\log(-1) = ?\)</span></li>
<li><span class="math inline">\(\exp(1) = ?\)</span></li>
<li><span class="math inline">\(\exp(0) = ?\)</span></li>
<li><span class="math inline">\(\exp(-1) = ?\)</span></li>
<li>What is larger, <span class="math inline">\(\log(10)\)</span> or <span class="math inline">\(\exp(10)\)</span>?</li>
<li><span class="math inline">\(\log(\exp(x)) = ?\)</span></li>
<li><span class="math inline">\(\exp(\log(x)) = ?\)</span></li>
</ul>
</section>
<section id="rules-for-log-and-exp" class="level3" data-number="8.1.4">
<h3 data-number="8.1.4" class="anchored" data-anchor-id="rules-for-log-and-exp"><span class="header-section-number">8.1.4</span> Rules for log and exp*</h3>
<p>There are some rules for working with logs and exponents that we will use later on to derive some results about the interpretation of log-linear regression. You don’t need to know these but you might find them useful.</p>
<ul>
<li><p>Addition with logs: <span class="math display">\[\log(m) + \log(n) = \log(mn) \]</span></p></li>
<li><p>Multiplication with exponents:<br>
<span class="math display">\[ \exp(m) \times \exp(n) = \exp(m + n) \]</span></p></li>
</ul>
</section>
</section>
<section id="the-log-linear-model" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="the-log-linear-model"><span class="header-section-number">8.2</span> The log-linear model</h2>
<p>There are a various ways to apply log-transformations in regression analysis, which are outlined in the following table and discussed in more detail in <span class="citation" data-cites="cite-fox">(<a href="#ref-cite-fox" role="doc-biblioref"><strong>cite-fox?</strong></a>)</span>. The focus of this chapter is log-linear regression, but the overall approach to linear-log and log-log is the similar. A worked example is coming up in <span class="quarto-unresolved-ref">?sec-worked-example-9</span>. (Note that the term “log-linear” is also the name of a family of models for contingency table data – that is not what we are talking about here.)</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-log-table" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/log_table.png" class="img-fluid figure-img" width="565"></p>
<figcaption class="figure-caption">Figure&nbsp;8.4: Logs in regression analysis</figcaption>
</figure>
</div>
</div>
</div>
<p>Before getting into the worked example, recall that a main theme of this chapter is that transforming the <span class="math inline">\(Y\)</span> variable in a regression has three interrelated consequences:</p>
<ul>
<li>Changing the distribution Y variable / residuals</li>
<li>Changing the (non-)linearity of its relationship with other variables</li>
<li>Changing interpretation of the regression coefficients</li>
</ul>
<p>The next few sections address each of these points in more detail.</p>
</section>
<section id="sec-distribution-8" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="sec-distribution-8"><span class="header-section-number">8.3</span> Distribution of <span class="math inline">\(\log(Y)\)</span></h2>
<p>Below are some examples of the log transform applied to positively skewed data. We can see a range of results, from “wow, that definitely worked” in the first example to, “better, but still not great” in the second two examples. These are realistic reflections of how a log transform works to address skew.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-skew1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch8_loglinear_files/figure-html/fig-skew1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.5: Example 1: Log transforming ECLS math</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-skew2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch8_loglinear_files/figure-html/fig-skew2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.6: Example 2: Log transforming ECLS reading</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-skew3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch8_loglinear_files/figure-html/fig-skew3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.7: Example 3: Log transforming hourly wages</figcaption>
</figure>
</div>
</div>
</div>
<section id="why-logx1" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="why-logx1"><span class="header-section-number">8.3.1</span> Why <span class="math inline">\(\log(x+1)\)</span>?</h3>
<p>There are a few things to note about this approach to correcting positive skew. First, you might have nocited that we are computing <span class="math inline">\(\log(x + 1)\)</span> instead of <span class="math inline">\(\log(x)\)</span>. This is because the log function has “weird” behavior for values of <span class="math inline">\(x\)</span> between 0 and 1. These values of <span class="math inline">\(x\)</span> were not shown in <a href="#fig-logx">Figure&nbsp;<span>8.1</span></a> and <a href="#fig-loge">Figure&nbsp;<span>8.3</span></a>, but they are shown below in <a href="#fig-log0">Figure&nbsp;<span>8.8</span></a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-log0" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/log0.png" class="img-fluid figure-img" width="538"></p>
<figcaption class="figure-caption">Figure&nbsp;8.8: Logs for small values of X</figcaption>
</figure>
</div>
</div>
</div>
<p>We can see that <span class="math inline">\(\log(1) = 0\)</span>, which is true regardless of the base (i.e., <span class="math inline">\(b^0 = 1\)</span> for all choices of the <span class="math inline">\(b\)</span>). But for values of <span class="math inline">\(x &lt; 0\)</span>, <span class="math inline">\(\log(x)\)</span> goes to negative infinity. This is because of how negative exponents are defined:</p>
<p><span class="math display">\[ b^{-x} = \frac{1}{b^x}. \]</span></p>
<p>The upshot for log-linear regression is as follows: if your <span class="math inline">\(Y\)</span> variable takes on values in the range <span class="math inline">\((0, 1)\)</span>, the log transform is going to change those values into large negative numbers. This can result in negative skew, rather fixing your positive skew.</p>
<p><a href="#fig-skew4">Figure&nbsp;<span>8.9</span></a> provides an example. The top row shows is the example as <a href="#fig-skew1">Figure&nbsp;<span>8.5</span></a> above, (math achievement in ECLS), and the bottom shows the same variable but transformed to proportion correct. In the left-hand panels we can see that the distribution of the proportion is qualitatively the same the as the distribution of the original variable. However, the log transform behaves differently for these two cases. Why? Because logs are “weird” on the range <span class="math inline">\((0, 1)\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-skew4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch8_loglinear_files/figure-html/fig-skew4-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.9: Comparing Log transforms of ECLS math total score versus proportion correct</figcaption>
</figure>
</div>
</div>
</div>
<p>To avoid this situation we can add 1 to a variable before taking its log. Technically, there is no reason to do this if the variable does not take on values in the range 0 to 1, but I always apply the “add 1” rule just so I don’t have to worry about it.</p>
</section>
<section id="what-about-negative-values-of-x" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="what-about-negative-values-of-x"><span class="header-section-number">8.3.2</span> What about negative values of <span class="math inline">\(x\)</span>?</h3>
<p>You may have noted that the “add 1” rule doesn’t cover cases where the variable can take on negative values. The problem here is that there is no way to turn a positive base <span class="math inline">\(b\)</span> into a negative number through exponentiation - i.e., <span class="math inline">\(\log(x)\)</span> is undefined whenever <span class="math inline">\(x &lt; 0\)</span>.</p>
<p>To address situations where you want to log transform a variable that can take on negative values, we can use the transformation</p>
<p><span class="math display">\[ \log(x - \text{min}(x) + 1). \]</span></p>
<p>The following table shows how this transformation works. The first column shows the original data, the second column shows how subtracting the minimum makes all of the negative numbers positive, and the third column shows how adding 1 makes all of the numbers less than 1 equal to or greater than 1.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="files/images/log_min.png" class="img-fluid figure-img" width="598"></p>
<figcaption class="figure-caption">Dealing with negative values of x in log transforms</figcaption>
</figure>
</div>
</div>
</div>
<p>The take home message: If we have negative values of <span class="math inline">\(x\)</span>, before we apply the log transform we need to:</p>
<ul>
<li>Step 1. “Add” the minimum value of <span class="math inline">\(x\)</span> to prevent undefined values of log</li>
<li>Step 2. Add 1 to make sure no values are less than 1</li>
</ul>
<p><strong>Can you think of a log transformation that would work to address data that were negatively skewed, rather than positively skewed? Hint: the trick is similar to the one in this section</strong></p>
</section>
<section id="skew-versus-censoring" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="skew-versus-censoring"><span class="header-section-number">8.3.3</span> Skew versus censoring</h3>
<p>It is important to distinguish between skew and floor (or ceiling) effects. Floor and ceiling effects are collectively known as “censoring”. While transforming you data can help with skew, it isn’t going to do anything about censoring, so it is important to be able to tell the difference.</p>
<p>Censoring can look like extreme skew, but is importantly different from skew because a large proportion of the observations have exactly the same value. An example is shown in <a href="#fig-floor">Figure&nbsp;<span>8.10</span></a> below, which shows a floor effect in which a large proportion of the cases have a values of 0 (“are censored at zero”). Note that the log transformation does not do anything about the censored data. In general, if you transform a “heap” of values, then the same heap shows up in the transformed data.</p>
<p>To deal with censored data, we need to consider alternatives to linear regression (e.g., tobit regression). We won’t cover regression for censored data in this course. For our purposes, the moral is: don’t mistake censoring for skew, because they don’t have the same solution.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-floor" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="files/images/floor_effect.png" class="img-fluid figure-img" width="759"></p>
<figcaption class="figure-caption">Figure&nbsp;8.10: A floor effect is not the same as positive skew</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="final-comments-on-dealing-with-skew" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="final-comments-on-dealing-with-skew"><span class="header-section-number">8.3.4</span> Final comments on dealing with skew</h3>
<p>Recall that the assumptions of linear regression are not about the <span class="math inline">\(Y\)</span> variable itself, but about the residuals (<a href="ch7_assumption_checking.html#sec-recap-7"><span>Section&nbsp;7.1</span></a>). So, a skewed outcome variable is not necessarily a problem. In particular, it is entirely possible that <span class="math inline">\(Y\)</span> is positively skewed but the residuals are not, especially if one of the <span class="math inline">\(X\)</span> variables has a similar distribution to <span class="math inline">\(Y\)</span>. So, in practice, you should not overly worry about non-normality of <span class="math inline">\(Y\)</span> – its the residuals of your regression model that matter.</p>
<p>Second, even if the residuals are non-normal, this still doesn’t matter very much with very large samples. The central limit theorem assures us that, as the sample size gets larger, the sampling distribution of the regression coefficients converges to a normal distribution, regardless of the distribution of the residuals.</p>
<!-- This is illustrated in Figure \@ref(fig:clt) below.  -->
<!-- The left panel shows the qq-plot of the residuals when Math Achievement (`c1rmscal`) is regressed on SES (`wksesl`) using the ECLS dataset. The right panel shows the bootstrapped sampling distribution of the regression coefficient, with samples of size $N = 100$. It is apparent that the skewness of the $Y$ variable does not affect the normality of the sampling distribution of the b-weight when the sample size is $100$. This is why we can often ignore skew in $Y$ with “large” samples ($N = 100$ in this case). -->
<!-- ```{r, clt, echo = F, fig.cap = "The sampling distribution of a regression coefficient when residuals have positive skew", fig.align = 'center'} -->
<!-- knitr::include_graphics("images/clt.png") -->
<!-- ``` -->
<p>The moral of this section is that, if you are considering log-transforming an outcome variable due to skew, you should keep in mind:</p>
<ol type="1">
<li>The problem may not really need to be fixed:
<ul>
<li>Check the residuals!</li>
<li>If you have sufficient sample size, mild to moderate violations of normality are not really an issue.</li>
</ul></li>
<li>The log-transformation has other important implications for you model, which we discuss next.</li>
</ol>
</section>
</section>
<section id="sec-relationship-8" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="sec-relationship-8"><span class="header-section-number">8.4</span> Relationship with <span class="math inline">\(X\)</span></h2>
<p>In addition to affecting normality,(non-linear) transformations of the <span class="math inline">\(Y\)</span> variable necessarily affect the linearity of regression. In particular, if <span class="math inline">\(Y\)</span> is linearly related to <span class="math inline">\(X\)</span>, then <span class="math inline">\(\log(Y)\)</span> cannot also be linearly related to <span class="math inline">\(X\)</span>.</p>
<p>Stated more formally, if</p>
<p><span class="math display">\[ Y = a + bX + \epsilon \]</span></p>
<p>then</p>
<p><span class="math display">\[
\begin{align}
\log(Y) &amp; = \log(a + bX + \epsilon) \\
&amp; \neq a + bX + \epsilon. \\
\end{align}
\]</span></p>
<p>In practice, this means that addressing positive skew using a log transform can sometimes create more problems than it solves. <a href="#fig-nonlinear1">Figure&nbsp;<span>8.11</span></a> illustrates this issue. In the top row, we see the residual versus fitted plot and qqplot of residuals for the regression of Math Achievement (<code>c1rmscal</code>) on SES (<code>wksesl</code>). The linear regression resulted in a clear violation of normality (positive skew). In the bottom row, we see same output after log transforming Math Achievement – it addressed the issue with normality, but also made the nonlinearity more apparent.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-nonlinear1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch8_loglinear_files/figure-html/fig-nonlinear1-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.11: Nonlinear vs non-normality when log transforming Y</figcaption>
</figure>
</div>
</div>
</div>
<p>The take home message is that when we transform <span class="math inline">\(Y\)</span> (or <span class="math inline">\(X\)</span>) we necessarily affect the relationship between the variables, as well as their individual distributions. It is often the case that when we try to “fix” the normality of the <span class="math inline">\(Y\)</span> variable, we can inadvertently make its relationship to <span class="math inline">\(X\)</span> more non-linear.</p>
<p>As we discuss in the next chapter, we can address non-linearity of regression by transforming the <span class="math inline">\(X\)</span> variable(s). But we should be sure that the problem we are trying to solve (normality) isn’t worse than the the problem we end up with (non-linearity).</p>
</section>
<section id="sec-interpretation-8" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="sec-interpretation-8"><span class="header-section-number">8.5</span> Interpretation</h2>
<p>The final point about the log-linear model is how it affects the interpretation of the model parameters. For example, in linear regression we know that a one unit increase in <span class="math inline">\(X\)</span> leads to a <span class="math inline">\(b\)</span>-unit increase in <span class="math inline">\(\hat Y\)</span>. But how do we interpret a <span class="math inline">\(b\)</span>-unit increase in <span class="math inline">\(\log(Y)\)</span>?</p>
<p>In general, one of the main shortcomings of “transforming your data” is that it can lead to uninformative or unclear interpretations of model parameters. If the results don’t make sense, its not much of a consolation to know that the model assumptions looked OK!</p>
<p>However, it turns out that there is very nice interpretation of the log-linear model. It is because of this interpretation that we often use the log transform to address skew in <span class="math inline">\(Y\)</span>, rather than some other transformation.</p>
<p>There two ways to interpret the regression coefficients in the log-linear model. First, we consider the easy but approximate way (you’re welcome!). Second, we consider the more complicated but accurate way, which involves reverse transforming the regression coefficients using exponentiation (see <a href="#sec-math-review-8"><span>Section&nbsp;8.1</span></a>).</p>
<section id="sec-approximate-8" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="sec-approximate-8"><span class="header-section-number">8.5.1</span> Approximate interpretation</h3>
<p>In a log-linear model, the regression coefficients can be interpreted as the <em>approximate</em> proportion change in <span class="math inline">\(Y\)</span>, in the original units. So, in this equation,</p>
<p><span id="eq-logy"><span class="math display">\[ \log(Y) = a + bX + \epsilon \tag{8.1}\]</span></span></p>
<p>we can interpret <span class="math inline">\(b\)</span> as the proportionate change in <span class="math inline">\(Y\)</span> associated with a one unit increase in <span class="math inline">\(X\)</span>. This should seem like surprising: <span class="math inline">\(Y\)</span> is not the outcome variable – <span class="math inline">\(\log(Y)\)</span> is. But, we can still interpret the model with respect to <span class="math inline">\(Y\)</span>!</p>
<p>Below are some numerical examples illustrating how to interpret the regression slope in <a href="#eq-logy">Equation&nbsp;<span>8.1</span></a>:</p>
<ul>
<li><p>if <span class="math inline">\(b = .25\)</span>, then <span class="math inline">\(Y\)</span> is expected to increase by 25% when <span class="math inline">\(X\)</span> increases by 1 unit.</p></li>
<li><p>if <span class="math inline">\(b = 0\)</span>, then <span class="math inline">\(Y\)</span> is expected to be the same when <span class="math inline">\(X\)</span> increases by 1 unit (i.e., no relationship)</p></li>
<li><p>if <span class="math inline">\(b = -.45\)</span>, then <span class="math inline">\(Y\)</span> is expected to decrease by 45% when <span class="math inline">\(X\)</span> increases by 1 unit.</p></li>
</ul>
<p>It is important to note that this interpretation is approximate and it only applies when <span class="math inline">\(|b|\)</span> is small (e.g., <span class="math inline">\(|b|&lt; .5\)</span>). We will see how the approximation works and how to deal with other values of <span class="math inline">\(b\)</span> when we get to the exact interpretation in <span class="quarto-unresolved-ref">?sec-exact-8</span>.</p>
<p>Before moving on, let’s get clear on what “proportionate change” means. Consider two values of a variable. We let <span class="math inline">\(Y\)</span> denote the original value and <span class="math inline">\(Y^*\)</span> denote a new value. The “change” is the difference <span class="math inline">\(Y^* - Y\)</span>. Treating the change as a proportion of the original value <span class="math inline">\(Y\)</span> gives us the proportionate change:</p>
<p><span class="math display">\[ \text{proportionate change} = \frac{Y^* - Y}{Y} = Y^*/Y - 1.\]</span></p>
<p>Multiplying the proportionate change by 100 gives us the percentage change, which is usually easier to talk about in words. The numerical examples listed above used percentage change. If we want to talk about the change without specifying the units (e.g, proportion or percentage), we say “relative change.”</p>
<p>Note that relative change is not the same as relative magnitude. <span class="math inline">\(Y'/Y\)</span> is the magnitude of <span class="math inline">\(Y^*\)</span> relative to <span class="math inline">\(Y\)</span>. As shown in the above equation for proportionate change, we need to subtract 1 from relative magnitude to get relative change.</p>
<p>For example, say I loan <span class="math inline">\(Y = 100\)</span> dollars to a friend and they pay me back <span class="math inline">\(Y^* = 150\)</span> dollars. The amount my friend paid me back is 1.5 times, or 150%, of what I initially lent them:</p>
<p><span class="math display">\[ Y^*/Y = 150/100 = 1.5 \]</span></p>
<p>This is the relative <em>magnitude</em> of the two amounts.</p>
<p>Alternatively, we could say that I have <em>gained</em> 50%, or 1/2, over the initial amount:</p>
<p><span class="math display">\[ Y^*/Y - 1 = 150/100 - 1 = .5 \]</span> This is relative <em>change</em>.</p>
<p>As an example of relative loss rather than gain, assume <span class="math inline">\(Y^* = 40\)</span> and <span class="math inline">\(Y = 100\)</span>, then <span class="math inline">\(Y^*\)</span> is 40% of <span class="math inline">\(Y\)</span> (relative magnitude) and the relative change (decrease) from 100 to 40 is 60%.</p>
<p>Here are some more examples. <strong>Please write down your answers and be prepared to share them in class.</strong></p>
<ol type="1">
<li><p>How many times larger is <span class="math inline">\(Y^* = 6\)</span> than <span class="math inline">\(Y = 2\)</span>?</p></li>
<li><p>What is the relative increase from <span class="math inline">\(Y = 2\)</span> to <span class="math inline">\(Y^* = 6\)</span>?</p></li>
<li><p>What is the percent increase from <span class="math inline">\(Y = 200\)</span> to <span class="math inline">\(Y^* = 600\)</span>?</p></li>
<li><p>What is the percent decrease from <span class="math inline">\(Y = 600\)</span> to <span class="math inline">\(Y^* = 200\)</span>?</p></li>
<li><p>What is the percent change from <span class="math inline">\(Y = 1\)</span> to <span class="math inline">\(Y^* = 1\)</span>?</p></li>
</ol>
<p>The answers are hidden below and can be viewed by pressing the “code” button. But please keep in mind that you won’t learn anything by viewing the answers before trying the questions.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 6 is 3 times larger than 2, or 300% percent larger than 2 (6/2 = 3)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 6 is a 200% increase from 2 (6/2 - 1 = 2)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 600 is a 200% increase from 200 </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 200 is a 66% decrease from 600</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 1 is a zero percent increase from 1 (but 100% as large as 1!)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="a-hypothetical-example" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="a-hypothetical-example"><span class="header-section-number">8.5.2</span> A hypothetical example</h3>
<p>This section provides a hypothetical example comparing the interpretation of linear regression and log-linear regression. We will work though the example in class, so <strong>please write down your answers to the questions in this section and be prepared to share your responses</strong>.</p>
<p>To get a better idea of how the interpretation of log-linear regression differs from the interpretation of linear regression, let’s consider the following variables:</p>
<ul>
<li><span class="math inline">\(Y\)</span> is wages (dollars per week)</li>
<li><span class="math inline">\(X\)</span> is hours worked per week</li>
</ul>
<p>A linear relationship between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> would means</p>
<p><span class="math display">\[ \widehat Y = a + bX. \]</span></p>
<p>Let’s further assume that <span class="math inline">\(b = 20\)</span>. With this information, you should be able to work out answers to the following two questions pretty easily:</p>
<ol type="1">
<li><p>For someone who is expected to earn $100/week, what would be their predicted earnings if they worked one hour more per week?</p></li>
<li><p>What about for someone who was expected to earn $1000/week?</p></li>
</ol>
<p>Now let’s consider a log-linear model, this time with a regression coefficient of <span class="math inline">\(b = .2\)</span>:</p>
<p><span class="math display">\[ \log(\widehat Y) = a + bX. \]</span> Using this log-linear equation, please answer the following questions:</p>
<ol start="3" type="1">
<li><p>For someone who is expected to earn $100/week, what would be their predicted earnings if they worked one hour more per week? To answer this question, use the interpretation of <span class="math inline">\(b\)</span> in terms of proportionate change, as outlined in the previous section.</p></li>
<li><p>What about for someone who was expected to earn $1000/week?</p></li>
</ol>
<p>The answers are hidden below. You can use the “code” button to see them, but please try to answer on your own first.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 120 dollars per week</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 1020 dollars per week</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 120 dollars per week</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 1200 dollars per week</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This example shows that, while the linear model represents change in fixed units (e.g., dollars), the log-linear model represents change that is relative to an initial value of <span class="math inline">\(Y\)</span>. This is particularly useful in applications involving monetary outcomes, where it has been argued that people’s “subjective evaluation” of money is more like the latter than the former.</p>
<p>The contrast between “fixed units” and “subject value” interpretions can be illustrated as follows.</p>
<ul>
<li><p>At $100/week, $20 for an additional hour is equivalent to a 20% increase in wages for only a 2.5% (1/40) increase in hours worked.</p></li>
<li><p>At $1000/week, $20 is a 2% increase in wages, which is less than the 2.5% increase in hours worked.</p></li>
</ul>
<p>Thus, the same fixed amount, $20, doesn’t have the same “subject value” for someone making $100/week as compared to someone making $1000/week. On the other hand, a 20% increase for both people might be considered as having equal subjective value. On this logic, the person making $1000/ week would need a $200 increase in order experience the same subject value as the $20 increase provides to the person making $100/ week.</p>
<p>Some real life examples of this kind of interpretation are linked below.</p>
<ul>
<li><p>Sliding scales for parking, car pool / day care late pick-up, bail and fines, <a href="https://www.theatlantic.com/business/archive/2015/03/finland-home-of-the-103000-speeding-ticket/387484/">https://www.theatlantic.com/business/archive/2015/03/finland-home-of-the-103000-speeding-ticket/387484/</a></p></li>
<li><p>Proportional tuition based on income and number of dependents. <a href="https://ronclarkacademy.com/tuition-and-financial-aid">https://ronclarkacademy.com/tuition-and-financial-aid</a></p></li>
</ul>
</section>
<section id="sec-exact-9" class="level3" data-number="8.5.3">
<h3 data-number="8.5.3" class="anchored" data-anchor-id="sec-exact-9"><span class="header-section-number">8.5.3</span> Exact interpretation</h3>
<p>If we want an exact interpretation of the regression coefficients in a log-linear model, we need to do some “follow-up math” with exponents. The main result is about the relative magnitude of <span class="math inline">\(\hat Y\)</span> corresponding to a one-unit change in <span class="math inline">\(X\)</span></p>
<p><span id="eq-expb"><span class="math display">\[ \frac{\widehat Y(X + 1)}{\widehat Y(X)} = \exp(b)
\tag{8.2}\]</span></span></p>
<p>where <span class="math inline">\(\widehat Y(X)\)</span> is the predicted value of <span class="math inline">\(Y\)</span> for a given value of <span class="math inline">\(X\)</span>. This is result derived in <a href="#sec-derivation-8"><span>Section&nbsp;8.5.5</span></a> below (optional).</p>
<p>Based on <a href="#eq-expb">Equation&nbsp;<span>8.2</span></a>, we can interpret the exponentiated regression coefficient in a log-linear model in terms of relative magnitude. In practice, people often prer to use relative change instead. From <a href="#eq-expb">Equation&nbsp;<span>8.2</span></a> and the definition of proportion change in <a href="#sec-approximate-8"><span>Section&nbsp;8.5.1</span></a>, it follows that the proportion of change in <span class="math inline">\(\widehat Y\)</span> for a 1 unit increase in <span class="math inline">\(X\)</span> is <em>exactly</em> equal to <span class="math inline">\(\exp(b) - 1\)</span>.</p>
<p>In the hypothetical example above (wages and hours worked), the exact proportion change in the log-linear model is</p>
<p><span class="math display">\[ \exp(.2) - 1 = 1.2214 - 1= .2214 \]</span></p>
<p>or about 22%.</p>
</section>
<section id="summary" class="level3" data-number="8.5.4">
<h3 data-number="8.5.4" class="anchored" data-anchor-id="summary"><span class="header-section-number">8.5.4</span> Summary</h3>
<p>While there are many transformations that can be used to address skew, the log-linear model has the advantage that it is still interpretable in terms of the original <span class="math inline">\(Y\)</span> variable. In fact, in many applications, notably those in which <span class="math inline">\(Y\)</span> is monetary, the interpretation is arguably better than for linear regression!</p>
<p>There are two ways to interpret the regression coefficients in the log-linear model</p>
<ul>
<li><p>The approximate interpretation: a one unit of change in <span class="math inline">\(X\)</span> is expected to yield a <span class="math inline">\((b \times 100)\%\)</span> change in <span class="math inline">\(Y\)</span>. This interpretation only applies when <span class="math inline">\(b\)</span> is small (e.g., less than .5 in absolute value).</p></li>
<li><p>The exact interpretation: a one unit of change in <span class="math inline">\(X\)</span> is expected to yield a <span class="math inline">\((\exp(b) - 1) \times 100\%\)</span> change in <span class="math inline">\(Y\)</span>, and this applies for any value of <span class="math inline">\(b\)</span>.</p></li>
</ul>
</section>
<section id="sec-derivation-8" class="level3" data-number="8.5.5">
<h3 data-number="8.5.5" class="anchored" data-anchor-id="sec-derivation-8"><span class="header-section-number">8.5.5</span> Derivation of <a href="#eq-expb">Equation&nbsp;<span>8.2</span></a> *</h3>
<p>Start with the log-linear model, exponentiate both sides, and then use the multiplication rule for exponents:</p>
<p><span class="math display">\[\begin{align}
\log(\widehat Y) &amp; = a + bX \\
\implies &amp; \\
\exp(\log(\widehat Y)) &amp; = \exp(a + bX) \\
\implies &amp; \\
\widehat Y &amp; = \exp(a)\exp(bX) \\
\end{align}\]</span></p>
<p>Then do the same thing for <span class="math inline">\(X+1\)</span> in place of <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[\begin{align}
\log(\widehat Y^*) &amp; = a + b(X + 1) \\
\implies &amp; \\
\widehat Y^*&amp; = \exp(a)\exp(bX)\exp(b) \\
\end{align}\]</span></p>
<p>Finally, take the ratio of <span class="math inline">\(\widehat Y^*\)</span> to <span class="math inline">\(\widehat Y\)</span>:</p>
<p><span class="math display">\[ \frac{\widehat Y^*}{\widehat Y} = \frac{\exp(a)\exp(bX)\exp(b)}{\exp(a)\exp(bX)} = \exp(b) \]</span></p>
<p>This gives <a href="#eq-expb">Equation&nbsp;<span>8.2</span></a>.</p>
<p>The reason that the approximate interpretation in <a href="#sec-approximate-8"><span>Section&nbsp;8.5.1</span></a> works is because</p>
<p><span class="math display">\[ \exp(b) - 1 \approx b \]</span></p>
<p>for <span class="math inline">\(|b| &lt; .5\)</span>. This is illustrated in the graph below, where the blue line is <span class="math inline">\(\exp(b)-1\)</span> and black line is <span class="math inline">\(b\)</span>. We can see that the two lines are pretty close over the range (-.5, .5).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-expb" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ch8_loglinear_files/figure-html/fig-expb-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8.12: exp(b) - 1 (blue) versus b (black)</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="sec-worked-example-8" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="sec-worked-example-8"><span class="header-section-number">8.6</span> Worked example</h2>
<p>This section works through log-linear regression using a new example, the <code>Wages.Rdata</code> data (source: Weinberg &amp; Abramowitz (2017) Statistics using Stata: An integrative approach. Cambridge University Press). The dataset was collected in 1985 from <span class="math inline">\(N = 400\)</span> respondents and contains the following variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data and take a look</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Wages.RData"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wages))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">educ</th>
<th style="text-align: right;">south</th>
<th style="text-align: right;">sex</th>
<th style="text-align: right;">exper</th>
<th style="text-align: right;">wage</th>
<th style="text-align: right;">occup</th>
<th style="text-align: right;">marr</th>
<th style="text-align: right;">ed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">7.50</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">13.07</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">4.45</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">6.25</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">19.98</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">7.30</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We will focus on regressing hourly wage (<code>wage</code>) on years of education (<code>educ</code>). The distribution of the outcome variable and its relationship with the predictor are depicted below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(wages)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wage,  <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(educ, wage, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ch8_loglinear_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This example is a good candidate for log-linear regression because</p>
<ul>
<li><code>wages</code> is positively skewed</li>
<li>Its relationship with <code>educ</code> appears somewhat exponential</li>
<li>The log-transform provides a suitable interpretation when the outcome is monetary</li>
</ul>
<p>Moreover, a quick a look at the linear regression model (below) shows that <em>all</em> of the model assumptions are violated. So, time to try something other than regular regression!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage <span class="sc">~</span> educ)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out model fit</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ch8_loglinear_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="log-linear-regression-of-wages-on-education" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="log-linear-regression-of-wages-on-education"><span class="header-section-number">8.6.1</span> Log-linear regression of Wages on Education</h3>
<p>To run a log-linear model, we can transform the <span class="math inline">\(Y\)</span>-variable (wages) using the <code>log</code> function, and then run the model as usual. The diagnostic plots are shown below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log transform of wage</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>log_wage <span class="ot">&lt;-</span> <span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress it on educ</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_wage <span class="sc">~</span> educ)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out model fit</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ch8_loglinear_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that the log transformation helped with positive skew, although didn’t do much for the negative tail. It also reduced the apparent heteroskedasticity. However, the relationship still appears non-linear, perhaps more so than in the original linear model. We will address non-linearity in the following chapter, and for now just focus on interpreting the log-linear model in this example.</p>
<p>The R-output is below.</p>
<p>But before moving on, let’s make sure we have a good understanding of what the regression coefficients for the log-linear model mean. The model output is reported below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mod2)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/log_linear_output.png"</span>, <span class="at">dpi =</span> <span class="dv">125</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="files/images/log_linear_output.png" class="img-fluid" width="1453"></p>
</div>
</div>
<p>Plugging the values from the R output into the equation for log-linear regression, we have</p>
<p><span class="math display">\[
\begin{align}
\widehat{\log(WAGES)} &amp; = a + b (EDUC) \\
\widehat{\log(WAGES)} &amp; = 1.188730 + 0.074802 (EDUC)
\end{align}
\]</span></p>
<p><strong>Please take a moment to write down both the approximate and exact interpretation of the regression coefficient for <code>educ</code>. Hint: you need to do some follow-up math with exponents to get the exact interpretation. </strong></p>
</section>
</section>
<section id="sec-workbook-8" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="sec-workbook-8"><span class="header-section-number">8.7</span> Workbook</h2>
<p>This section collects the questions asked in this chapter. The lessons for this chapter will focus on discussing these questions and then working on the exercises in <span class="quarto-unresolved-ref">?sec-exercises-8</span>. The lesson will <strong>not</strong> be a lecture that reviews all of the material in the chapter! So, if you haven’t written down / thought about the answers to these questions before class, the lesson will not be very useful for you. Please engage with each question by writing down one or more answers, asking clarifying questions about related material, posing follow up questions, etc.</p>
<p><a href="#sec-math-review-8"><span>Section&nbsp;8.1</span></a></p>
<p>I’ll ask some questions like the following to start class off. You check your answers by pasting the questions into <span class="math inline">\(R\)</span> or Google’s search bar.</p>
<ul>
<li><span class="math inline">\(\log(2.7182) = ?\)</span></li>
<li><span class="math inline">\(\log(1) = ?\)</span></li>
<li><span class="math inline">\(\log(0) = ?\)</span></li>
<li><span class="math inline">\(\log(-1) = ?\)</span></li>
<li><span class="math inline">\(\exp(1) = ?\)</span></li>
<li><span class="math inline">\(\exp(0) = ?\)</span></li>
<li><span class="math inline">\(\exp(-1) = ?\)</span></li>
<li>What is larger, <span class="math inline">\(\log(10)\)</span> or <span class="math inline">\(\exp(10)\)</span>?</li>
<li><span class="math inline">\(\log(\exp(x)) = ?\)</span></li>
<li><span class="math inline">\(\exp(\log(x)) = ?\)</span></li>
</ul>
<p><a href="#sec-interpretation-8"><span>Section&nbsp;8.5</span></a></p>
<ul>
<li>Please write down your answers to the questions below and be prepared to share in clas: s</li>
</ul>
<ol type="1">
<li><p>How many times larger is <span class="math inline">\(Y^* = 6\)</span> than <span class="math inline">\(Y = 2\)</span>?</p></li>
<li><p>What is the relative increase from <span class="math inline">\(Y = 2\)</span> to <span class="math inline">\(Y^* = 6\)</span>?</p></li>
<li><p>What is the percent increase from <span class="math inline">\(Y = 200\)</span> to <span class="math inline">\(Y^* = 600\)</span>?</p></li>
<li><p>What is the percent decrease from <span class="math inline">\(Y = 600\)</span> to <span class="math inline">\(Y^* = 200\)</span>?</p></li>
<li><p>What is the percent change from <span class="math inline">\(Y = 1\)</span> to <span class="math inline">\(Y^* = 1\)</span>?</p></li>
</ol>
<ul>
<li>Please write down your answers to the four questions about the hypothetical example in and be prepared to share your responses in class. *</li>
</ul>
<p><a href="#sec-worked-example-8"><span>Section&nbsp;8.6</span></a></p>
<ul>
<li>Please take a moment to write down your interpretation of the regression coefficient for <code>educ</code> in the summary output below.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(wages)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>log_wage <span class="ot">&lt;-</span> <span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress it on educ</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_wage <span class="sc">~</span> educ)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_wage ~ educ)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.07475 -0.35961  0.02614  0.31244  1.18163 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.188730   0.102328   11.62   &lt;2e-16 ***
educ        0.074802   0.007263   10.30   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4234 on 398 degrees of freedom
Multiple R-squared:  0.2104,    Adjusted R-squared:  0.2085 
F-statistic: 106.1 on 1 and 398 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(wages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercises-9" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="exercises-9"><span class="header-section-number">8.8</span> Exercises</h2>
<p>There isn’t much new in terms of R code in this chapter. The code for the worked example is presented below, but please refer to <a href="#sec-worked-example-8"><span>Section&nbsp;8.6</span></a> for the interpretation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data and take a look</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Wages.RData"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wages))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">educ</th>
<th style="text-align: right;">south</th>
<th style="text-align: right;">sex</th>
<th style="text-align: right;">exper</th>
<th style="text-align: right;">wage</th>
<th style="text-align: right;">occup</th>
<th style="text-align: right;">marr</th>
<th style="text-align: right;">ed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">7.50</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">13.07</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">4.45</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">6.25</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">19.98</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">7.30</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We will focus on regressing hourly wage (<code>wage</code>) on years of education (<code>educ</code>). The distribution of the outcome variable and its relationship with the predictor are depicted below.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(wages)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wage,  <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(educ, wage, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ch8_loglinear_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="linear-regression-of-wages-on-education" class="level3" data-number="8.8.1">
<h3 data-number="8.8.1" class="anchored" data-anchor-id="linear-regression-of-wages-on-education"><span class="header-section-number">8.8.1</span> Linear regression of Wages on Education</h3>
<p>Working with linear model, we can see that <em>all</em> of the assumptions of the model are violated – we are going to need to try another approach!</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage <span class="sc">~</span> educ)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out model fit</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ch8_loglinear_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="log-linear-regression-of-wages-on-education-1" class="level3" data-number="8.8.2">
<h3 data-number="8.8.2" class="anchored" data-anchor-id="log-linear-regression-of-wages-on-education-1"><span class="header-section-number">8.8.2</span> Log-linear regression of Wages on Education</h3>
<p>To run a log-linear model, we can transform the Y-variable using the <code>log</code> function, and then run the model as usual.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log transform of wage</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>log_wage <span class="ot">&lt;-</span> <span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress it on educ</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_wage <span class="sc">~</span> educ)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out model fit</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="ch8_loglinear_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(wages)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The log transformation helped with positive skew, although didn’t do much for the negative tail. It reduced the apparent heteroskedasticity. However, the relationship still appears non-linear, perhaps more so than in the original linear model. We will address non-linearity in the following chapter, and for now just focus on interpreting the log-linear model in this example.</p>
<ul>
<li>The usual summary output provides the regression slope, which can be interpreted using the “approximate” interpretation of relative change:</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log_wage ~ educ)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.07475 -0.35961  0.02614  0.31244  1.18163 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.188730   0.102328   11.62   &lt;2e-16 ***
educ        0.074802   0.007263   10.30   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4234 on 398 degrees of freedom
Multiple R-squared:  0.2104,    Adjusted R-squared:  0.2085 
F-statistic: 106.1 on 1 and 398 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Some follow up math to get the exact interpretation of the regression slope in terms of relative change. First <span class="math inline">\(\exp(b) - 1\)</span>:</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the regression slope from the output </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>conf.b <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod2)[<span class="dv">2</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Exp and subtract one to get exact relative change</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(conf.b) <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      educ 
0.07767034 </code></pre>
</div>
</div>
<ul>
<li>Next we compute a confidence interval for <span class="math inline">\(\exp(b) - 1\)</span>:</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute a confidence interval for exact relative change</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(mod2)[<span class="dv">2</span>, ]) <span class="sc">-</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5 %     97.5 % 
0.06239300 0.09316737 </code></pre>
</div>
</div>
</section>
</section>
<section id="write-up" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="write-up"><span class="header-section-number">8.9</span> Write up</h2>
<p>Approximate:</p>
<ul>
<li>Using a log-linear regression model, it was found that a one unit increase in years of education led to a predicted increase in wages of 7.4% (<span class="math inline">\(b = .074, t(398) = 10.30, p &lt; .001\)</span>).</li>
</ul>
<p>Exact:</p>
<ul>
<li>Using a log-linear regression model, it was found that a one unit increase in years of education led to a predicted increase in wages of 7.8% (<span class="math inline">\(\exp(b) - 1 = .078, 95\% \text{ CI: }[0.062, 0.093]\)</span>).</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch7_assumption_checking.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Assumption checking</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb22" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="an">fold:</span><span class="co"> true</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu"># Log-linear regression  {#sec-chap-8}</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>In the previous chapter we considered how to check the population assumptions of linear regression for a given data set. In this chapter we discuss one way to deal with assumption violations --  by "transforming" the $Y$ variable. In general, a transformation is just a function we apply to a variable to change it into another variable. We have already seen some examples of transformations: centering or deviation scores, standardizing or z-scores, and percentiles. </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>In this chapter we will apply the log transformation to the $Y$ variable in a regression model, which results in the log-linear regression model. This transformation is widely used  to address skew in the $Y$ variable / residuals, and it also serves to illustrate the overall approach to transforming the $Y$ variable in a regression model to address assumption violations. </span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>There are two big themes to this chapter. First, whenever we apply a non-linear transform to the $Y$ variable in a regression model, it always has three types of consequences. It affects: </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The distribution of the variable / residuals. </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The (non-)linearity of its relationship with predictor variables.</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>The interpretation of the regression coefficients.  </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>We have to consider all three of these consequences when transforming the $Y$ variable. In particular, we might find that addressing one problem (e.g., non-normality) can create other  problems (e.g., nonlinearity). The moral is that addressing assumption violations by transforming the $Y$ variable is not always as straightforward as we might hope.  </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>The other big theme of this chapter is the overall strategy for dealing with assumption violations. In particular, when we are faced with data that are not compatible with the assumptions of regression modeling, we often proceed as follows: </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Transform the data to make them compatible with linear regression (or some other model we know how to use).</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Run the analysis on the transformed data.</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>"Reverse-transform" the results of the analysis so that they are interpretable in terms of the original variable(s).</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>We will see this "transform$\rightarrow$analyze$\rightarrow$reverse- transform" strategy in this chapter, and again when we cover logistic regression in @sec-chap-10. Both of these approaches are exemplars of *generalized linear modeling*, which is an advanced regression topic that formalizes the intuitive idea behind this approach.    </span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>This chapter addresses transformations of the $Y$-variable only. Another approach for dealing with assumption violations in linear regression is to transform one or more of the $X$ variables instead of (or in addition to) the $Y$ variable. These approaches are discussed in the next chapter. </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="fu">## Math review {#sec-math-review-8}</span></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>Let's start with a review the requisite math -- logs and exponents. We are going to use these concepts later in the course as well, so it is worth sorting them out.  If you haven't seen logs or exponents in while, brace yourself. This fist section of the math review covers the basic interpretation of logs and their utility for reducing skewness. The following sections add some details. </span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>In this math review, we use the lowercase symbols $x$ and $y$ for generic mathematical variables. These symbols do not correspond to the uppercase symbols $X$ and $Y$ in regression notation. So, e.g., $x$ is not a predictor, its just a generic variable. </span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>The function $\log_{10}(x)$ returns the power to which we need to raise 10 to get the value $x$. It answers the question: $10^? = x$. </span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>Some examples:</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log_{10}(10) = 1$, because $10^1 = 10$</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log_{10}(100) = 2$, because $10^2 = 100$</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log_{10}(1000) = 3$, because $10^3 = 1000$</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>...</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>In @fig-logx, the three values computed above are shown as vertical dashed lines. In general, the plots shows that for every order of magnitude that $x$ increases (e.g., from 10 to 100, or from 100 to 1000), its log only increases by one unit. Intuitively, this means that "big differences" on $x$ translate into "small differences" on $\log(x)$. </span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig-logx, echo = F, fig.cap = "Log base 10", fig.align = 'center'}</span></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/logx.png"</span>, <span class="at">dpi =</span> <span class="dv">150</span>)</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>This "compression" of large values down to a smaller scale turns out to be useful for dealing with positive skew, as illustrated in @fig-logdata. This is a main reason that the log transform is widely used --  to reduce positive skew.</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-logdata, echo = F, fig.cap = "Log transform and positive skew", fig.align = 'center'}</span></span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"ECLS2577.Rdata"</span>)</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ecls)</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots</span></span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(c1rmscal, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(c1rmscal <span class="sc">+</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a><span class="fu">### Natural logarithm</span></span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>The symbol $\log_{10}$ is read "log base 10". In statistics, we usually use a different base -- log base $e$. Here $e = 2.7182...$ is an irrational number called *Euler's number*. We will see later on that using $\log_e$ makes the interpretation of log-linear regression simpler. Note that in this context, $e$ is not the residual from a regression model. Whether $e$ denotes Euler's number or regression residuals should be clear from context. </span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>Regardless of which base we use, logs have the same overall compression effect, as shown in @fig-loge. For example, $\log_{10}(1000) = 3$ and $\log_{e}(1000) \approx 7$ -- both numbers are much smaller than $1000$, which means that both functions achieve the same overall result of making big values into smaller values. The same is true when applied to real data -- in fact, the right hand panel in @fig-logdata was computed using $\log_e$. </span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig-loge, echo = F, fig.cap = "Log base 10 vs log base e", fig.align = 'center'}</span></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/loge.png"</span>, <span class="at">dpi =</span> <span class="dv">150</span>)</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>Log base $e$, or $\log_e$,is called the *natural logarithm* and often denoted "$\ln$". But $\ln$ can be hard to read so we will just stick with $\log$ and omit the base symbol when we mean $\log_e$. This is consistent with what R's <span class="in">`log`</span> function does -- its default base is $e$.</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a><span class="fu">### log and exp</span></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>Recall that our overall modeling strategy in log-linear regression is "transform$\rightarrow$analyze$\rightarrow$reverse- transform". In mathematics, the reverse transform is called the *inverse* of the original function. The inverse of the logarithm is exponentiation. So, if we start by log-transforming our $Y$-variable, we are going to end up doing exponents later on.  </span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>To see how $\log$ and $\exp$ work together, let's start with the number $x= 100$, and take the log of that number: </span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>$$ \log(100) =  4.60517 $$</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>This equation tells us that if we raise $e$ to the power of $4.60517$ the result will be $100$.  We can think of $x = 100$ as our original data and $y = 4.60517$ as our transformed value. </span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>By definition of the logarithm, we can equivalently write $\log(100) =  4.60517$ as</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>$$e^{4.60517} = 100. $$</span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>This equation uses exponents (raise $e$ to a power) rather than logs, but it communicates the same information as the previous equation. In our second equation, we take the output of the log  ($y = 4.60517$) and use it as input to the exponent. The exponent then returns the original value of $x = 100$. </span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>The mathematical symbol $\exp(y)$ is often used instead of $e^y$ to avoid having to write complicated expressions in the superscript. So we can more clearly write the above equation as</span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>$$\exp(4.60517) = 100. $$</span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>This is just a change of notation so we don't have to typeset superscripts. </span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>To summarize: the two equations presented below are equivalent by definition: </span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>$$ \log(100) =  4.60517 \quad \text{and} \quad \exp (4.60517 ) = 100.$$</span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>In the first one, we take the input value $x = 100$ and transform it using the logarithm, which gives us the transformed value $y = 4.60517$. In the second equation, we take the transformed value $y = 4.60517$ as input into the exponent, which gives us back the original value of $x = 100$. </span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>In general, the relationship between the two functions is: </span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>$$\log(x) = y \quad  \text{and} \quad \exp (y) = x. $$</span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pop quiz</span></span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>I'll ask some questions like the following to start class off.  **Please write down your answers and be prepared to share them in class**. You check your answers by pasting the questions into $R$ or Google's search bar. </span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(2.7182) = ?$</span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(1) = ?$</span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(0) = ?$ </span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(-1) = ?$ </span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\exp(1) = ?$</span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\exp(0) = ?$</span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\exp(-1) = ?$</span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>What is larger, $\log(10)$ or $\exp(10)$? </span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(\exp(x)) = ?$ </span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\exp(\log(x)) = ?$</span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a><span class="fu">### Rules for log and exp*</span></span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a>There are some rules for working with logs and exponents that we will use later on to derive some results about the interpretation of log-linear regression. You don't need to know these but you might find them useful.</span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Addition with logs:</span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a>$$\log(m) + \log(n) = \log(mn) $$</span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Multiplication with exponents:  </span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>$$ \exp(m) \times \exp(n) = \exp(m + n) $$</span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## The log-linear model</span></span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a>There are a various ways to apply log-transformations in regression analysis, which are outlined in the following table and discussed in more detail in @cite-fox. The focus of this chapter is log-linear regression, but the overall approach to linear-log and log-log is the similar. A worked example is coming up in  @sec-worked-example-9. (Note that the term "log-linear" is also the name of a family of models for contingency table data -- that is not what we are talking about here.) </span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig-log-table, echo = F, fig.cap = "Logs in regression analysis", fig.align = 'center'}</span></span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/log_table.png"</span>)</span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a>Before getting into the worked example, recall that a main theme of this chapter is that transforming the $Y$ variable in a regression has three interrelated consequences: </span>
<span id="cb22-143"><a href="#cb22-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-144"><a href="#cb22-144" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Changing the distribution Y variable / residuals </span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Changing the (non-)linearity of its relationship with other variables</span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Changing interpretation of the regression coefficients</span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a>The next few sections address each of these points in more detail.</span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distribution of $\log(Y)$ {#sec-distribution-8}</span></span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a>Below are some examples of the log transform applied to positively skewed data. We can see a range of results, from "wow, that definitely worked" in the first example to, "better, but still not great" in the second two examples. These are realistic reflections of how a log transform works to address skew. </span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-skew1, echo = F, fig.cap = "Example 1: Log transforming ECLS math", fig.align = 'center', fig.height=8}</span></span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb22-156"><a href="#cb22-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-157"><a href="#cb22-157" aria-hidden="true" tabindex="-1"></a><span class="co"># histograms </span></span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(c1rmscal, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(c1rmscal <span class="sc">+</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a><span class="co"># qq plots</span></span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(c1rmscal, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>, <span class="at">main =</span> <span class="st">"qq-plot of c1rmscal"</span> )</span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(c1rmscal)</span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">log</span>(c1rmscal <span class="sc">+</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>,  <span class="at">main =</span> <span class="st">"qq-plot of log(c1rmscal + 1)"</span> )</span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">log</span>(c1rmscal <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-skew2, echo = F, fig.cap = "Example 2: Log transforming ECLS reading", fig.align = 'center', fig.height=8}</span></span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a><span class="co"># histograms</span></span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(c1rrscal, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(c1rrscal <span class="sc">+</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplots</span></span>
<span id="cb22-176"><a href="#cb22-176" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(c1rrscal, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>, <span class="at">main =</span> <span class="st">"qq-plot of c1rrscal"</span> )</span>
<span id="cb22-177"><a href="#cb22-177" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(c1rrscal)</span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">log</span>(c1rrscal <span class="sc">+</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>,  <span class="at">main =</span> <span class="st">"qq-plot of log(c1rrscal + 1)"</span> )</span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">log</span>(c1rrscal <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-skew3, echo = F, fig.cap = "Example 3: Log transforming hourly wages", fig.align = 'center', fig.height=8}</span></span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Wages.RData"</span>)</span>
<span id="cb22-184"><a href="#cb22-184" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(wages)</span>
<span id="cb22-185"><a href="#cb22-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a><span class="co"># histograms</span></span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wage, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a><span class="co"># qqplots</span></span>
<span id="cb22-192"><a href="#cb22-192" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(wage, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>, <span class="at">main =</span> <span class="st">"qq-plot of wage"</span> )</span>
<span id="cb22-193"><a href="#cb22-193" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(wage)</span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>,  <span class="at">main =</span> <span class="st">"qq-plot of log(wage + 1)"</span> )</span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(wages)</span>
<span id="cb22-197"><a href="#cb22-197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-198"><a href="#cb22-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why $\log(x+1)$?</span></span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a>There are a few things to note about this approach to correcting positive skew. First, you might have nocited that we are computing $\log(x + 1)$ instead of $\log(x)$. This is because the log function has "weird" behavior for values of $x$ between 0 and 1. These values of $x$ were not shown in @fig-logx and @fig-loge, but they are shown below in @fig-log0. </span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig-log0, echo = F, fig.cap = "Logs for small values of X", fig.align = 'center'}</span></span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/log0.png"</span>, <span class="at">dpi =</span> <span class="dv">150</span>)</span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a>We can see that $\log(1) = 0$, which is true regardless of the base (i.e., $b^0 = 1$ for all choices of the $b$). But for values of $x &lt; 0$, $\log(x)$ goes to negative infinity. This is because of how negative exponents are defined:</span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a>$$ b^{-x} = \frac{1}{b^x}. $$</span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a>The upshot for log-linear regression is as follows: if your $Y$ variable takes on values in the range $(0, 1)$, the log transform is going to change those values into large negative numbers. This can result in negative skew, rather fixing your positive skew. </span>
<span id="cb22-212"><a href="#cb22-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-213"><a href="#cb22-213" aria-hidden="true" tabindex="-1"></a>@fig-skew4 provides an example. The top row shows is the example as @fig-skew1 above, (math achievement in ECLS), and the bottom shows the same variable but transformed to proportion correct. In the left-hand panels we can see that the distribution of the proportion is qualitatively the same the as the distribution of the original variable. However, the log transform behaves differently for these two cases. Why? Because logs are "weird" on the range $(0, 1)$. </span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-skew4, echo = F, fig.cap = "Comparing Log transforms of ECLS math total score versus proportion correct", fig.align = 'center', fig.height=8}</span></span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a>prop_c1rmscal <span class="ot">&lt;-</span> (c1rmscal <span class="sc">-</span> <span class="fu">min</span>(c1rmscal))<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(c1rmscal, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(c1rmscal <span class="sc">+</span> <span class="dv">1</span>), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prop_c1rmscal, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(prop_c1rmscal), <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-222"><a href="#cb22-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-223"><a href="#cb22-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-224"><a href="#cb22-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a>To avoid this situation we can add 1 to a variable before taking its log. Technically, there is no reason to do this if the variable does not take on values in the range 0 to 1, but I always apply the "add 1" rule just so I don't have to worry about it. </span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a><span class="fu">### What about negative values of $x$?</span></span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a>You may have noted that the "add 1" rule doesn't cover cases where the variable can take on negative values. The problem here is that there is no way to turn a positive base $b$ into a negative number through exponentiation - i.e., $\log(x)$ is undefined whenever $x &lt; 0$. </span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a>To address situations where you want to log transform a variable that can take on negative values, we can use the transformation</span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a>$$ \log(x - \text{min}(x) + 1). $$</span>
<span id="cb22-234"><a href="#cb22-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-235"><a href="#cb22-235" aria-hidden="true" tabindex="-1"></a>The following table shows how this transformation works. The first column shows the original data, the second column shows how subtracting the minimum makes all of the negative numbers positive, and the third column shows how adding 1 makes all of the numbers less than 1 equal to or greater than 1. </span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, log-min, echo = F, fig.cap = "Dealing with negative values of x in log transforms", fig.align = 'center'}</span></span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/log_min.png"</span>)</span>
<span id="cb22-239"><a href="#cb22-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-240"><a href="#cb22-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a>The take home message: If we have negative values of $x$, before we apply the log transform we need to: </span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-243"><a href="#cb22-243" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Step 1. “Add” the minimum value of $x$ to prevent undefined values of log</span>
<span id="cb22-244"><a href="#cb22-244" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Step 2. Add 1 to make sure no values are less than 1</span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a>**Can you think of a log transformation that would work to address data that were negatively skewed, rather than positively skewed? Hint: the trick is similar to the one in this section** </span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-248"><a href="#cb22-248" aria-hidden="true" tabindex="-1"></a><span class="fu">### Skew versus censoring</span></span>
<span id="cb22-249"><a href="#cb22-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a>It is important to distinguish between skew and floor (or ceiling) effects. Floor and ceiling effects are collectively known as "censoring". While transforming you data can help with skew, it isn't going to do anything about censoring, so it is important to be able to tell the difference. </span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a>Censoring can look like extreme skew, but is importantly different from skew because a large proportion of the observations have exactly the same value. An example is shown in @fig-floor below, which shows a floor effect in which a large proportion of the cases have a values of 0 ("are censored at zero"). Note that the log transformation does not do anything about the censored data. In general, if you transform a "heap" of values, then the same heap shows up in the transformed data. </span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a>To deal with censored data, we need to consider alternatives to linear regression (e.g., tobit regression). We won't cover regression for censored data in this course. For our purposes, the moral is: don't mistake censoring for skew, because they don't have the same solution. </span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig-floor, echo = F, fig.cap = "A floor effect is not the same as positive skew", fig.align = 'center'}</span></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/floor_effect.png"</span>, <span class="at">dpi =</span> <span class="dv">125</span>)</span>
<span id="cb22-258"><a href="#cb22-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-259"><a href="#cb22-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a><span class="fu">### Final comments on dealing with skew</span></span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a>Recall that the assumptions of linear regression are not about the $Y$ variable itself, but about the residuals (@sec-recap-7). So, a skewed outcome variable is not necessarily a problem. In particular, it is entirely possible that $Y$ is positively skewed but the residuals are not, especially if one of the $X$ variables has a similar distribution to $Y$. So, in practice, you should not overly worry about non-normality of $Y$ -- its the residuals of your regression model that matter. </span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-264"><a href="#cb22-264" aria-hidden="true" tabindex="-1"></a>Second, even if the residuals are non-normal, this still doesn't matter very much with very large samples. The central limit theorem assures us that, as the sample size gets larger, the sampling distribution of the regression coefficients converges to a normal distribution, regardless of the distribution of the residuals. </span>
<span id="cb22-265"><a href="#cb22-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-267"><a href="#cb22-267" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- This is illustrated in Figure \@ref(fig:clt) below.  --&gt;</span></span>
<span id="cb22-268"><a href="#cb22-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- The left panel shows the qq-plot of the residuals when Math Achievement (`c1rmscal`) is regressed on SES (`wksesl`) using the ECLS dataset. The right panel shows the bootstrapped sampling distribution of the regression coefficient, with samples of size $N = 100$. It is apparent that the skewness of the $Y$ variable does not affect the normality of the sampling distribution of the b-weight when the sample size is $100$. This is why we can often ignore skew in $Y$ with “large” samples ($N = 100$ in this case). --&gt;</span></span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ```{r, clt, echo = F, fig.cap = "The sampling distribution of a regression coefficient when residuals have positive skew", fig.align = 'center'} --&gt;</span></span>
<span id="cb22-272"><a href="#cb22-272" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- knitr::include_graphics("images/clt.png") --&gt;</span></span>
<span id="cb22-273"><a href="#cb22-273" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- ``` --&gt;</span></span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a>The moral of this section is that, if you are considering log-transforming an outcome variable due to skew, you should keep in mind:</span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-277"><a href="#cb22-277" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>The problem may not really need to be fixed: </span>
<span id="cb22-278"><a href="#cb22-278" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>Check the residuals! </span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a><span class="ss">    * </span>If you have sufficient sample size, mild to moderate violations of normality are not really an issue.</span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The log-transformation has other important implications for you model, which we discuss next. </span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-283"><a href="#cb22-283" aria-hidden="true" tabindex="-1"></a><span class="fu">## Relationship with $X$ {#sec-relationship-8}</span></span>
<span id="cb22-284"><a href="#cb22-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-285"><a href="#cb22-285" aria-hidden="true" tabindex="-1"></a>In addition to affecting normality,(non-linear) transformations of the $Y$ variable necessarily affect the linearity of regression. In particular, if $Y$ is linearly related to $X$, then $\log(Y)$ cannot also be linearly related to $X$. </span>
<span id="cb22-286"><a href="#cb22-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-287"><a href="#cb22-287" aria-hidden="true" tabindex="-1"></a>Stated more formally, if</span>
<span id="cb22-288"><a href="#cb22-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-289"><a href="#cb22-289" aria-hidden="true" tabindex="-1"></a>$$ Y = a + bX + \epsilon $$ </span>
<span id="cb22-290"><a href="#cb22-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-291"><a href="#cb22-291" aria-hidden="true" tabindex="-1"></a>then</span>
<span id="cb22-292"><a href="#cb22-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-293"><a href="#cb22-293" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-294"><a href="#cb22-294" aria-hidden="true" tabindex="-1"></a>\begin{align} </span>
<span id="cb22-295"><a href="#cb22-295" aria-hidden="true" tabindex="-1"></a>\log(Y) &amp; = \log(a + bX + \epsilon) <span class="sc">\\</span></span>
<span id="cb22-296"><a href="#cb22-296" aria-hidden="true" tabindex="-1"></a> &amp; \neq a + bX + \epsilon. <span class="sc">\\</span></span>
<span id="cb22-297"><a href="#cb22-297" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb22-298"><a href="#cb22-298" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-299"><a href="#cb22-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-300"><a href="#cb22-300" aria-hidden="true" tabindex="-1"></a>In practice, this means that addressing positive skew using a log transform can sometimes create more problems than it solves. @fig-nonlinear1 illustrates this issue. In the top row, we see the residual versus fitted plot and qqplot of residuals for the regression of Math Achievement (<span class="in">`c1rmscal`</span>) on SES (<span class="in">`wksesl`</span>). The linear regression resulted in a clear violation of normality (positive skew). In the bottom row, we see same output after log transforming Math Achievement -- it addressed the issue with normality, but also made the nonlinearity more apparent.  </span>
<span id="cb22-301"><a href="#cb22-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-302"><a href="#cb22-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-nonlinear1, echo = F, fig.cap = "Nonlinear vs non-normality when log transforming Y", fig.align = 'center', fig.height=8}</span></span>
<span id="cb22-303"><a href="#cb22-303" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(c1rmscal <span class="sc">~</span> wksesl)</span>
<span id="cb22-304"><a href="#cb22-304" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(c1rmscal <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> wksesl)</span>
<span id="cb22-305"><a href="#cb22-305" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb22-306"><a href="#cb22-306" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">1</span>)</span>
<span id="cb22-307"><a href="#cb22-307" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">2</span>)</span>
<span id="cb22-308"><a href="#cb22-308" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">1</span>)</span>
<span id="cb22-309"><a href="#cb22-309" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">2</span>)</span>
<span id="cb22-310"><a href="#cb22-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-311"><a href="#cb22-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-312"><a href="#cb22-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-313"><a href="#cb22-313" aria-hidden="true" tabindex="-1"></a>The take home message is that when we transform $Y$ (or $X$) we necessarily affect the relationship between the variables, as well as their individual distributions. It is often the case that when we try to “fix” the normality of the $Y$ variable, we can inadvertently make its relationship to $X$ more non-linear.</span>
<span id="cb22-314"><a href="#cb22-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-315"><a href="#cb22-315" aria-hidden="true" tabindex="-1"></a>As we discuss in the next chapter, we can address non-linearity of regression by transforming the $X$ variable(s). But we should be sure that the problem we are trying to solve (normality) isn’t worse than the the problem we end up with (non-linearity). </span>
<span id="cb22-316"><a href="#cb22-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-317"><a href="#cb22-317" aria-hidden="true" tabindex="-1"></a><span class="fu">## Interpretation {#sec-interpretation-8}</span></span>
<span id="cb22-318"><a href="#cb22-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-319"><a href="#cb22-319" aria-hidden="true" tabindex="-1"></a>The final point about the log-linear model is how it affects the interpretation of the model parameters. For example, in linear regression we know that a one unit increase in $X$ leads to a $b$-unit increase in $\hat Y$. But how do we interpret a $b$-unit increase in $\log(Y)$? </span>
<span id="cb22-320"><a href="#cb22-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-321"><a href="#cb22-321" aria-hidden="true" tabindex="-1"></a>In general, one of the main shortcomings of "transforming your data" is that it can lead to uninformative or unclear interpretations of model parameters. If the results don't make sense, its not much of a consolation to know that the model assumptions looked OK! </span>
<span id="cb22-322"><a href="#cb22-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-323"><a href="#cb22-323" aria-hidden="true" tabindex="-1"></a>However, it turns out that there is very nice interpretation of the log-linear model. It is because of this interpretation that we often use the log transform to address skew in $Y$, rather than some other transformation. </span>
<span id="cb22-324"><a href="#cb22-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-325"><a href="#cb22-325" aria-hidden="true" tabindex="-1"></a>There two ways to interpret the regression coefficients in the log-linear model. First, we consider the easy but approximate way (you're welcome!). Second, we consider the more complicated but accurate way, which involves reverse transforming the regression coefficients using exponentiation (see @sec-math-review-8). </span>
<span id="cb22-326"><a href="#cb22-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-327"><a href="#cb22-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### Approximate interpretation {#sec-approximate-8}</span></span>
<span id="cb22-328"><a href="#cb22-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-329"><a href="#cb22-329" aria-hidden="true" tabindex="-1"></a>In a log-linear model, the regression coefficients can be interpreted as the *approximate* proportion change in $Y$, in the original units. So, in this equation, </span>
<span id="cb22-330"><a href="#cb22-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-331"><a href="#cb22-331" aria-hidden="true" tabindex="-1"></a>$$ \log(Y) = a + bX + \epsilon$$ {#eq-logy}</span>
<span id="cb22-332"><a href="#cb22-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-333"><a href="#cb22-333" aria-hidden="true" tabindex="-1"></a>we can interpret $b$ as the proportionate change in $Y$ associated with a one unit increase in $X$. This should seem like surprising: $Y$ is not the outcome variable -- $\log(Y)$ is. But, we can still interpret the model with respect to $Y$! </span>
<span id="cb22-334"><a href="#cb22-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-335"><a href="#cb22-335" aria-hidden="true" tabindex="-1"></a>Below are some numerical examples illustrating how to interpret the regression slope in @eq-logy: </span>
<span id="cb22-336"><a href="#cb22-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-337"><a href="#cb22-337" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>if $b = .25$, then $Y$ is expected to increase by 25% when $X$ increases by 1 unit. </span>
<span id="cb22-338"><a href="#cb22-338" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>if $b = 0$, then $Y$ is expected to be the same when $X$ increases by 1 unit (i.e., no relationship)</span>
<span id="cb22-339"><a href="#cb22-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-340"><a href="#cb22-340" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>if $b = -.45$, then $Y$ is expected to decrease by 45% when $X$ increases by 1 unit. </span>
<span id="cb22-341"><a href="#cb22-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-342"><a href="#cb22-342" aria-hidden="true" tabindex="-1"></a>It is important to note that this interpretation is approximate and it only applies when $|b|$ is small (e.g., $|b|&lt; .5$). We will see how the approximation works and how to deal with other values of $b$ when we get to the exact interpretation in @sec-exact-8. </span>
<span id="cb22-343"><a href="#cb22-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-344"><a href="#cb22-344" aria-hidden="true" tabindex="-1"></a>Before moving on, let's get clear on what "proportionate change" means. Consider two values of a variable. We let $Y$ denote the original value and $Y^*$ denote a new value. The "change" is the difference $Y^* - Y$. Treating the change as a proportion of the original value $Y$ gives us the proportionate change: </span>
<span id="cb22-345"><a href="#cb22-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-346"><a href="#cb22-346" aria-hidden="true" tabindex="-1"></a>$$ \text{proportionate change} = \frac{Y^* - Y}{Y} = Y^*/Y - 1.$$</span>
<span id="cb22-347"><a href="#cb22-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-348"><a href="#cb22-348" aria-hidden="true" tabindex="-1"></a>Multiplying the proportionate change by 100 gives us the percentage change, which is usually easier to talk about in words. The numerical examples listed above used percentage change. If we want to talk about the change without specifying the units (e.g, proportion or percentage), we say "relative change." </span>
<span id="cb22-349"><a href="#cb22-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-350"><a href="#cb22-350" aria-hidden="true" tabindex="-1"></a>Note that relative change is not the same as relative magnitude. $Y'/Y$ is the magnitude of $Y^*$ relative to $Y$. As shown in the above equation for proportionate change, we need to subtract 1 from relative magnitude to get relative change. </span>
<span id="cb22-351"><a href="#cb22-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-352"><a href="#cb22-352" aria-hidden="true" tabindex="-1"></a>For example, say I loan $Y = 100$ dollars to a friend and they pay me back $Y^* = 150$ dollars. The amount my friend paid me back is 1.5 times, or 150%, of what I initially lent them:</span>
<span id="cb22-353"><a href="#cb22-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-354"><a href="#cb22-354" aria-hidden="true" tabindex="-1"></a>$$ Y^*/Y = 150/100 = 1.5 $$</span>
<span id="cb22-355"><a href="#cb22-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-356"><a href="#cb22-356" aria-hidden="true" tabindex="-1"></a>This is the relative *magnitude* of the two amounts.</span>
<span id="cb22-357"><a href="#cb22-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-358"><a href="#cb22-358" aria-hidden="true" tabindex="-1"></a>Alternatively, we could say that I have *gained* 50%, or 1/2, over the initial amount:</span>
<span id="cb22-359"><a href="#cb22-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-360"><a href="#cb22-360" aria-hidden="true" tabindex="-1"></a>$$ Y^*/Y - 1 = 150/100 - 1 = .5 $$</span>
<span id="cb22-361"><a href="#cb22-361" aria-hidden="true" tabindex="-1"></a>This is relative *change*. </span>
<span id="cb22-362"><a href="#cb22-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-363"><a href="#cb22-363" aria-hidden="true" tabindex="-1"></a>As an example of relative loss rather than gain, assume $Y^* = 40$ and $Y = 100$, then $Y^*$ is 40% of $Y$ (relative magnitude) and the relative change (decrease) from 100 to 40 is 60%. </span>
<span id="cb22-364"><a href="#cb22-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-365"><a href="#cb22-365" aria-hidden="true" tabindex="-1"></a>Here are some more examples. **Please write down your answers and be prepared to share them in class.**</span>
<span id="cb22-366"><a href="#cb22-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-367"><a href="#cb22-367" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>How many times larger is $Y^* = 6$ than $Y = 2$?  </span>
<span id="cb22-368"><a href="#cb22-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-369"><a href="#cb22-369" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>What is the relative increase from $Y = 2$ to $Y^* = 6$?  </span>
<span id="cb22-370"><a href="#cb22-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-371"><a href="#cb22-371" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>What is the percent increase from $Y = 200$ to $Y^* = 600$?</span>
<span id="cb22-372"><a href="#cb22-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-373"><a href="#cb22-373" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>What is the percent decrease from $Y = 600$ to $Y^* = 200$?</span>
<span id="cb22-374"><a href="#cb22-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-375"><a href="#cb22-375" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>What is the percent change from $Y = 1$ to $Y^* = 1$?</span>
<span id="cb22-376"><a href="#cb22-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-377"><a href="#cb22-377" aria-hidden="true" tabindex="-1"></a>The answers are hidden below and can be viewed by pressing the "code" button. But please keep in mind that you won't learn anything by viewing the answers before trying the questions. </span>
<span id="cb22-378"><a href="#cb22-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-381"><a href="#cb22-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-382"><a href="#cb22-382" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 6 is 3 times larger than 2, or 300% percent larger than 2 (6/2 = 3)</span></span>
<span id="cb22-383"><a href="#cb22-383" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 6 is a 200% increase from 2 (6/2 - 1 = 2)</span></span>
<span id="cb22-384"><a href="#cb22-384" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 600 is a 200% increase from 200 </span></span>
<span id="cb22-385"><a href="#cb22-385" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 200 is a 66% decrease from 600</span></span>
<span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. 1 is a zero percent increase from 1 (but 100% as large as 1!)</span></span>
<span id="cb22-387"><a href="#cb22-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-388"><a href="#cb22-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-389"><a href="#cb22-389" aria-hidden="true" tabindex="-1"></a><span class="fu">### A hypothetical example </span></span>
<span id="cb22-390"><a href="#cb22-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-391"><a href="#cb22-391" aria-hidden="true" tabindex="-1"></a>This section provides a hypothetical example comparing the interpretation of linear regression and log-linear regression. We will work though the example in class, so **please write down your answers to the questions in this section and be prepared to share your responses**. </span>
<span id="cb22-392"><a href="#cb22-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-393"><a href="#cb22-393" aria-hidden="true" tabindex="-1"></a>To get a better idea of how the interpretation of log-linear regression differs from the interpretation of linear regression, let's consider the following variables:</span>
<span id="cb22-394"><a href="#cb22-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-395"><a href="#cb22-395" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$Y$ is wages (dollars per week) </span>
<span id="cb22-396"><a href="#cb22-396" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$X$ is hours worked per week</span>
<span id="cb22-397"><a href="#cb22-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-398"><a href="#cb22-398" aria-hidden="true" tabindex="-1"></a>A linear relationship between $Y$ and $X$ would means</span>
<span id="cb22-399"><a href="#cb22-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-400"><a href="#cb22-400" aria-hidden="true" tabindex="-1"></a>$$ \widehat Y = a + bX. $$</span>
<span id="cb22-401"><a href="#cb22-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-402"><a href="#cb22-402" aria-hidden="true" tabindex="-1"></a>Let's further assume that $b = 20$. With this information, you should be able to work out answers to the following two questions pretty easily: </span>
<span id="cb22-403"><a href="#cb22-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-404"><a href="#cb22-404" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>For someone who is expected to earn $100/week, what would be their predicted earnings if they worked one hour more per week? </span>
<span id="cb22-405"><a href="#cb22-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-406"><a href="#cb22-406" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>What about for someone who was expected to earn $1000/week? </span>
<span id="cb22-407"><a href="#cb22-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-408"><a href="#cb22-408" aria-hidden="true" tabindex="-1"></a>Now let's consider a log-linear model, this time with a regression coefficient of $b = .2$:</span>
<span id="cb22-409"><a href="#cb22-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-410"><a href="#cb22-410" aria-hidden="true" tabindex="-1"></a>$$ \log(\widehat Y) = a + bX. $$</span>
<span id="cb22-411"><a href="#cb22-411" aria-hidden="true" tabindex="-1"></a>Using this log-linear equation, please answer the following questions: </span>
<span id="cb22-412"><a href="#cb22-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-413"><a href="#cb22-413" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>For someone who is expected to earn \$100/week, what would be their  predicted earnings if they worked one hour more per week? To answer this question, use the interpretation of $b$ in terms of proportionate change, as outlined in the previous section. </span>
<span id="cb22-414"><a href="#cb22-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-415"><a href="#cb22-415" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>What about for someone who was expected to earn $1000/week? </span>
<span id="cb22-416"><a href="#cb22-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-417"><a href="#cb22-417" aria-hidden="true" tabindex="-1"></a>The answers are hidden below. You can use the "code" button to see them, but please try to answer on your own first. </span>
<span id="cb22-418"><a href="#cb22-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-419"><a href="#cb22-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, results = F}</span></span>
<span id="cb22-420"><a href="#cb22-420" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. 120 dollars per week</span></span>
<span id="cb22-421"><a href="#cb22-421" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. 1020 dollars per week</span></span>
<span id="cb22-422"><a href="#cb22-422" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. 120 dollars per week</span></span>
<span id="cb22-423"><a href="#cb22-423" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. 1200 dollars per week</span></span>
<span id="cb22-424"><a href="#cb22-424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-425"><a href="#cb22-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-426"><a href="#cb22-426" aria-hidden="true" tabindex="-1"></a>This example shows that, while the linear model represents change in fixed units (e.g., dollars), the log-linear model represents change that is relative to an initial value of $Y$. This is particularly useful in applications involving monetary outcomes, where it has been argued that people’s "subjective evaluation" of money is more like the latter than the former. </span>
<span id="cb22-427"><a href="#cb22-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-428"><a href="#cb22-428" aria-hidden="true" tabindex="-1"></a>The contrast between "fixed units" and "subject value" interpretions can be illustrated as follows. </span>
<span id="cb22-429"><a href="#cb22-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-430"><a href="#cb22-430" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>At \$100/week, \$20 for an additional hour is equivalent to a 20% increase in wages for only a 2.5% (1/40) increase in hours worked. </span>
<span id="cb22-431"><a href="#cb22-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-432"><a href="#cb22-432" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>At \$1000/week, \$20 is a 2% increase in wages, which is less than the 2.5% increase in hours worked.</span>
<span id="cb22-433"><a href="#cb22-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-434"><a href="#cb22-434" aria-hidden="true" tabindex="-1"></a>Thus, the same fixed amount, \$20, doesn't have the same "subject value" for someone making \$100/week as compared to someone making \$1000/week. On the other hand, a 20% increase for both people might be considered as having equal subjective value.  On this logic, the person making \$1000/ week would need a \$200 increase in order experience the same subject value as the \$20 increase provides to the person making \$100/ week.  </span>
<span id="cb22-435"><a href="#cb22-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-436"><a href="#cb22-436" aria-hidden="true" tabindex="-1"></a>Some real life examples of this kind of interpretation are linked below.</span>
<span id="cb22-437"><a href="#cb22-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-438"><a href="#cb22-438" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Sliding scales for parking, car pool / day care late pick-up, bail and fines, <span class="co">[</span><span class="ot">https://www.theatlantic.com/business/archive/2015/03/finland-home-of-the-103000-speeding-ticket/387484/</span><span class="co">](https://www.theatlantic.com/business/archive/2015/03/finland-home-of-the-103000-speeding-ticket/387484/)</span></span>
<span id="cb22-439"><a href="#cb22-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-440"><a href="#cb22-440" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Proportional tuition based on income and number of dependents. </span>
<span id="cb22-441"><a href="#cb22-441" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">https://ronclarkacademy.com/tuition-and-financial-aid</span><span class="co">](https://ronclarkacademy.com/tuition-and-financial-aid)</span></span>
<span id="cb22-442"><a href="#cb22-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-443"><a href="#cb22-443" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exact interpretation {#sec-exact-9}</span></span>
<span id="cb22-444"><a href="#cb22-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-445"><a href="#cb22-445" aria-hidden="true" tabindex="-1"></a>If we want an exact interpretation of the regression coefficients in a log-linear model, we need to do some "follow-up math" with exponents. The main result is about the relative magnitude of $\hat Y$ corresponding to a one-unit change in $X$</span>
<span id="cb22-446"><a href="#cb22-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-447"><a href="#cb22-447" aria-hidden="true" tabindex="-1"></a>$$ \frac{\widehat Y(X + 1)}{\widehat Y(X)} = \exp(b) </span>
<span id="cb22-448"><a href="#cb22-448" aria-hidden="true" tabindex="-1"></a>$$ {#eq-expb}</span>
<span id="cb22-449"><a href="#cb22-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-450"><a href="#cb22-450" aria-hidden="true" tabindex="-1"></a>where $\widehat Y(X)$ is the predicted value of $Y$ for a given value of $X$. This is result derived in @sec-derivation-8 below (optional).</span>
<span id="cb22-451"><a href="#cb22-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-452"><a href="#cb22-452" aria-hidden="true" tabindex="-1"></a>Based on @eq-expb, we can interpret the exponentiated regression coefficient in a log-linear model in terms of relative magnitude. In practice, people often prer to use relative change instead. From @eq-expb and the definition of proportion change in @sec-approximate-8, it follows that the proportion of change in $\widehat Y$ for a 1 unit increase in $X$ is *exactly* equal to $\exp(b) - 1$. </span>
<span id="cb22-453"><a href="#cb22-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-454"><a href="#cb22-454" aria-hidden="true" tabindex="-1"></a>In the hypothetical example above (wages and hours worked), the exact proportion change in the log-linear model is</span>
<span id="cb22-455"><a href="#cb22-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-456"><a href="#cb22-456" aria-hidden="true" tabindex="-1"></a>$$ \exp(.2) - 1 = 1.2214 - 1= .2214 $$</span>
<span id="cb22-457"><a href="#cb22-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-458"><a href="#cb22-458" aria-hidden="true" tabindex="-1"></a>or about 22%. </span>
<span id="cb22-459"><a href="#cb22-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-460"><a href="#cb22-460" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary</span></span>
<span id="cb22-461"><a href="#cb22-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-462"><a href="#cb22-462" aria-hidden="true" tabindex="-1"></a>While there are many transformations that can be used to address skew, the log-linear model has the advantage that it is still interpretable in terms of the original $Y$ variable. In fact, in many applications, notably those in which $Y$ is monetary, the interpretation is arguably better than for linear regression! </span>
<span id="cb22-463"><a href="#cb22-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-464"><a href="#cb22-464" aria-hidden="true" tabindex="-1"></a>There are two ways to interpret the regression coefficients in the log-linear model</span>
<span id="cb22-465"><a href="#cb22-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-466"><a href="#cb22-466" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The approximate interpretation: a one unit of change in $X$ is expected to yield a $(b \times 100)\%$ change in $Y$. This interpretation only applies when $b$ is small (e.g., less than .5 in absolute value).</span>
<span id="cb22-467"><a href="#cb22-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-468"><a href="#cb22-468" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The exact interpretation: a one unit of change in $X$ is expected to yield a $(\exp(b) - 1)  \times 100\%$ change in $Y$, and this applies for any value of $b$. </span>
<span id="cb22-469"><a href="#cb22-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-470"><a href="#cb22-470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Derivation of @eq-expb * {#sec-derivation-8}</span></span>
<span id="cb22-471"><a href="#cb22-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-472"><a href="#cb22-472" aria-hidden="true" tabindex="-1"></a>Start with the log-linear model, exponentiate both sides, and then use the multiplication rule for exponents:</span>
<span id="cb22-473"><a href="#cb22-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-474"><a href="#cb22-474" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb22-475"><a href="#cb22-475" aria-hidden="true" tabindex="-1"></a>\log(\widehat Y) &amp; = a + bX <span class="sc">\\</span></span>
<span id="cb22-476"><a href="#cb22-476" aria-hidden="true" tabindex="-1"></a>\implies &amp; <span class="sc">\\</span></span>
<span id="cb22-477"><a href="#cb22-477" aria-hidden="true" tabindex="-1"></a>\exp(\log(\widehat Y)) &amp; = \exp(a + bX) <span class="sc">\\</span></span>
<span id="cb22-478"><a href="#cb22-478" aria-hidden="true" tabindex="-1"></a>\implies &amp; <span class="sc">\\</span></span>
<span id="cb22-479"><a href="#cb22-479" aria-hidden="true" tabindex="-1"></a>\widehat Y &amp; = \exp(a)\exp(bX) <span class="sc">\\</span></span>
<span id="cb22-480"><a href="#cb22-480" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb22-481"><a href="#cb22-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-482"><a href="#cb22-482" aria-hidden="true" tabindex="-1"></a>Then do the same thing for $X+1$ in place of $X$: </span>
<span id="cb22-483"><a href="#cb22-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-484"><a href="#cb22-484" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb22-485"><a href="#cb22-485" aria-hidden="true" tabindex="-1"></a>\log(\widehat Y^*) &amp; = a + b(X + 1) <span class="sc">\\</span></span>
<span id="cb22-486"><a href="#cb22-486" aria-hidden="true" tabindex="-1"></a>\implies &amp; <span class="sc">\\</span></span>
<span id="cb22-487"><a href="#cb22-487" aria-hidden="true" tabindex="-1"></a>\widehat Y^*&amp; = \exp(a)\exp(bX)\exp(b) <span class="sc">\\</span></span>
<span id="cb22-488"><a href="#cb22-488" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb22-489"><a href="#cb22-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-490"><a href="#cb22-490" aria-hidden="true" tabindex="-1"></a>Finally, take the ratio of $\widehat Y^*$ to $\widehat Y$: </span>
<span id="cb22-491"><a href="#cb22-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-492"><a href="#cb22-492" aria-hidden="true" tabindex="-1"></a>$$ \frac{\widehat Y^*}{\widehat Y} = \frac{\exp(a)\exp(bX)\exp(b)}{\exp(a)\exp(bX)} = \exp(b) $$</span>
<span id="cb22-493"><a href="#cb22-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-494"><a href="#cb22-494" aria-hidden="true" tabindex="-1"></a>This gives @eq-expb. </span>
<span id="cb22-495"><a href="#cb22-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-496"><a href="#cb22-496" aria-hidden="true" tabindex="-1"></a>The reason that the approximate interpretation in @sec-approximate-8 works is because </span>
<span id="cb22-497"><a href="#cb22-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-498"><a href="#cb22-498" aria-hidden="true" tabindex="-1"></a>$$ \exp(b) - 1 \approx b $$</span>
<span id="cb22-499"><a href="#cb22-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-500"><a href="#cb22-500" aria-hidden="true" tabindex="-1"></a>for $|b| &lt; .5$. This is illustrated in the graph below, where the blue line is $\exp(b)-1$ and black line is $b$. We can see that the two lines are pretty close over the range (-.5, .5). </span>
<span id="cb22-501"><a href="#cb22-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-502"><a href="#cb22-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-503"><a href="#cb22-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-expb, echo = F, fig.cap = "exp(b) - 1 (blue) versus b (black)", fig.align = 'center'}</span></span>
<span id="cb22-504"><a href="#cb22-504" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> .<span class="dv">1</span>)</span>
<span id="cb22-505"><a href="#cb22-505" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, x, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">ylab =</span> <span class="st">"exact vs approx proportion change"</span>, <span class="at">xlab =</span> <span class="st">"value of regression coefficient"</span>)</span>
<span id="cb22-506"><a href="#cb22-506" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, <span class="fu">exp</span>(x)<span class="sc">-</span><span class="dv">1</span>, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"#4b9cd3"</span>)</span>
<span id="cb22-507"><a href="#cb22-507" aria-hidden="true" tabindex="-1"></a><span class="co">#abline(h = 0, col = "grey", lty = 2)</span></span>
<span id="cb22-508"><a href="#cb22-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-509"><a href="#cb22-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-510"><a href="#cb22-510" aria-hidden="true" tabindex="-1"></a><span class="fu">## Worked example {#sec-worked-example-8} </span></span>
<span id="cb22-511"><a href="#cb22-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-512"><a href="#cb22-512" aria-hidden="true" tabindex="-1"></a>This section works through log-linear regression using a new example, the <span class="in">`Wages.Rdata`</span> data (source: Weinberg &amp; Abramowitz (2017) Statistics using Stata: An integrative approach. Cambridge University Press). The dataset was collected in 1985 from $N = 400$ respondents and contains the following variables.   </span>
<span id="cb22-513"><a href="#cb22-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-516"><a href="#cb22-516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-517"><a href="#cb22-517" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data and take a look</span></span>
<span id="cb22-518"><a href="#cb22-518" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Wages.RData"</span>)</span>
<span id="cb22-519"><a href="#cb22-519" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wages))</span>
<span id="cb22-520"><a href="#cb22-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-521"><a href="#cb22-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-522"><a href="#cb22-522" aria-hidden="true" tabindex="-1"></a>We will focus on regressing hourly wage (<span class="in">`wage`</span>) on years of education (<span class="in">`educ`</span>). The distribution of the outcome variable and its relationship with the predictor are depicted below. </span>
<span id="cb22-523"><a href="#cb22-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-524"><a href="#cb22-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-527"><a href="#cb22-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-528"><a href="#cb22-528" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(wages)</span>
<span id="cb22-529"><a href="#cb22-529" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-530"><a href="#cb22-530" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wage,  <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-531"><a href="#cb22-531" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(educ, wage, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-532"><a href="#cb22-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-533"><a href="#cb22-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-534"><a href="#cb22-534" aria-hidden="true" tabindex="-1"></a>This example is a good candidate for log-linear regression because</span>
<span id="cb22-535"><a href="#cb22-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-536"><a href="#cb22-536" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`wages`</span> is positively skewed</span>
<span id="cb22-537"><a href="#cb22-537" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Its relationship with <span class="in">`educ`</span> appears somewhat exponential</span>
<span id="cb22-538"><a href="#cb22-538" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The log-transform provides a suitable interpretation when the outcome is monetary</span>
<span id="cb22-539"><a href="#cb22-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-540"><a href="#cb22-540" aria-hidden="true" tabindex="-1"></a>Moreover, a quick a look at the linear regression model (below) shows that *all* of the model assumptions are violated. So, time to try something other than regular regression!</span>
<span id="cb22-541"><a href="#cb22-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-544"><a href="#cb22-544" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-545"><a href="#cb22-545" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage <span class="sc">~</span> educ)</span>
<span id="cb22-546"><a href="#cb22-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-547"><a href="#cb22-547" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out model fit</span></span>
<span id="cb22-548"><a href="#cb22-548" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-549"><a href="#cb22-549" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-550"><a href="#cb22-550" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-551"><a href="#cb22-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-552"><a href="#cb22-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-553"><a href="#cb22-553" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log-linear regression of Wages on Education</span></span>
<span id="cb22-554"><a href="#cb22-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-555"><a href="#cb22-555" aria-hidden="true" tabindex="-1"></a>To run a log-linear model, we can transform the $Y$-variable (wages) using the <span class="in">`log`</span> function, and then run the model as usual. The diagnostic plots are shown below. </span>
<span id="cb22-556"><a href="#cb22-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-559"><a href="#cb22-559" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-560"><a href="#cb22-560" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log transform of wage</span></span>
<span id="cb22-561"><a href="#cb22-561" aria-hidden="true" tabindex="-1"></a>log_wage <span class="ot">&lt;-</span> <span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb22-562"><a href="#cb22-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-563"><a href="#cb22-563" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress it on educ</span></span>
<span id="cb22-564"><a href="#cb22-564" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_wage <span class="sc">~</span> educ)</span>
<span id="cb22-565"><a href="#cb22-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-566"><a href="#cb22-566" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out model fit</span></span>
<span id="cb22-567"><a href="#cb22-567" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-568"><a href="#cb22-568" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-569"><a href="#cb22-569" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-570"><a href="#cb22-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-571"><a href="#cb22-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-572"><a href="#cb22-572" aria-hidden="true" tabindex="-1"></a>We can see that the log transformation helped with positive skew, although didn't do much for the negative tail. It also reduced the apparent heteroskedasticity. However, the relationship still appears non-linear, perhaps more so than in the original linear model. We will address non-linearity in the following chapter, and for now just focus on interpreting the log-linear model in this example. </span>
<span id="cb22-573"><a href="#cb22-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-574"><a href="#cb22-574" aria-hidden="true" tabindex="-1"></a>The R-output is below. </span>
<span id="cb22-575"><a href="#cb22-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-576"><a href="#cb22-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-577"><a href="#cb22-577" aria-hidden="true" tabindex="-1"></a>But before moving on, let's make sure we have a good understanding of what the regression coefficients for the log-linear model mean. The model output is reported below. </span>
<span id="cb22-578"><a href="#cb22-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-581"><a href="#cb22-581" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-582"><a href="#cb22-582" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mod2)</span></span>
<span id="cb22-583"><a href="#cb22-583" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"files/images/log_linear_output.png"</span>, <span class="at">dpi =</span> <span class="dv">125</span>)</span>
<span id="cb22-584"><a href="#cb22-584" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-585"><a href="#cb22-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-586"><a href="#cb22-586" aria-hidden="true" tabindex="-1"></a>Plugging the values from the R output into the equation for log-linear regression, we have</span>
<span id="cb22-587"><a href="#cb22-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-588"><a href="#cb22-588" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb22-589"><a href="#cb22-589" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb22-590"><a href="#cb22-590" aria-hidden="true" tabindex="-1"></a>\widehat{\log(WAGES)} &amp; = a + b (EDUC) <span class="sc">\\</span></span>
<span id="cb22-591"><a href="#cb22-591" aria-hidden="true" tabindex="-1"></a>\widehat{\log(WAGES)} &amp; = 1.188730 + 0.074802 (EDUC)</span>
<span id="cb22-592"><a href="#cb22-592" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb22-593"><a href="#cb22-593" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb22-594"><a href="#cb22-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-595"><a href="#cb22-595" aria-hidden="true" tabindex="-1"></a>**Please take a moment to write down both the approximate and exact interpretation of the regression coefficient for <span class="in">`educ`</span>. Hint: you need to do some follow-up math with exponents to get the exact interpretation. ** </span>
<span id="cb22-596"><a href="#cb22-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-597"><a href="#cb22-597" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = F}</span></span>
<span id="cb22-598"><a href="#cb22-598" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(wages)</span>
<span id="cb22-599"><a href="#cb22-599" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-600"><a href="#cb22-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-601"><a href="#cb22-601" aria-hidden="true" tabindex="-1"></a><span class="fu">## Workbook {#sec-workbook-8}</span></span>
<span id="cb22-602"><a href="#cb22-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-603"><a href="#cb22-603" aria-hidden="true" tabindex="-1"></a>This section collects the questions asked in this chapter. The lessons for this chapter will focus on discussing these questions and then working on the exercises in @sec-exercises-8. The lesson will **not** be a lecture that reviews all of the material in the chapter! So, if you haven't written down / thought about the answers to these questions before class, the lesson will not be very useful for you. Please engage with each question by writing down one or more answers, asking clarifying questions about related material, posing follow up questions, etc. </span>
<span id="cb22-604"><a href="#cb22-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-605"><a href="#cb22-605" aria-hidden="true" tabindex="-1"></a>@sec-math-review-8</span>
<span id="cb22-606"><a href="#cb22-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-607"><a href="#cb22-607" aria-hidden="true" tabindex="-1"></a>I'll ask some questions like the following to start class off. You check your answers by pasting the questions into $R$ or Google's search bar. </span>
<span id="cb22-608"><a href="#cb22-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-609"><a href="#cb22-609" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(2.7182) = ?$</span>
<span id="cb22-610"><a href="#cb22-610" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(1) = ?$</span>
<span id="cb22-611"><a href="#cb22-611" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(0) = ?$ </span>
<span id="cb22-612"><a href="#cb22-612" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(-1) = ?$ </span>
<span id="cb22-613"><a href="#cb22-613" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\exp(1) = ?$</span>
<span id="cb22-614"><a href="#cb22-614" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\exp(0) = ?$</span>
<span id="cb22-615"><a href="#cb22-615" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\exp(-1) = ?$</span>
<span id="cb22-616"><a href="#cb22-616" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>What is larger, $\log(10)$ or $\exp(10)$? </span>
<span id="cb22-617"><a href="#cb22-617" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\log(\exp(x)) = ?$ </span>
<span id="cb22-618"><a href="#cb22-618" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$\exp(\log(x)) = ?$</span>
<span id="cb22-619"><a href="#cb22-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-620"><a href="#cb22-620" aria-hidden="true" tabindex="-1"></a>@sec-interpretation-8</span>
<span id="cb22-621"><a href="#cb22-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-622"><a href="#cb22-622" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Please write down your answers to the questions below and be prepared to share in clas: s</span>
<span id="cb22-623"><a href="#cb22-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-624"><a href="#cb22-624" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>How many times larger is $Y^* = 6$ than $Y = 2$?  </span>
<span id="cb22-625"><a href="#cb22-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-626"><a href="#cb22-626" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>What is the relative increase from $Y = 2$ to $Y^* = 6$?  </span>
<span id="cb22-627"><a href="#cb22-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-628"><a href="#cb22-628" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>What is the percent increase from $Y = 200$ to $Y^* = 600$?</span>
<span id="cb22-629"><a href="#cb22-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-630"><a href="#cb22-630" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>What is the percent decrease from $Y = 600$ to $Y^* = 200$?</span>
<span id="cb22-631"><a href="#cb22-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-632"><a href="#cb22-632" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>What is the percent change from $Y = 1$ to $Y^* = 1$?</span>
<span id="cb22-633"><a href="#cb22-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-634"><a href="#cb22-634" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Please write down your answers to the four questions about the hypothetical example in and be prepared to share your responses in class. *</span>
<span id="cb22-635"><a href="#cb22-635" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-636"><a href="#cb22-636" aria-hidden="true" tabindex="-1"></a>@sec-worked-example-8 </span>
<span id="cb22-637"><a href="#cb22-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-638"><a href="#cb22-638" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Please take a moment to write down your interpretation of the regression coefficient for <span class="in">`educ`</span> in the summary output below.</span>
<span id="cb22-639"><a href="#cb22-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-642"><a href="#cb22-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-643"><a href="#cb22-643" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(wages)</span>
<span id="cb22-644"><a href="#cb22-644" aria-hidden="true" tabindex="-1"></a>log_wage <span class="ot">&lt;-</span> <span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb22-645"><a href="#cb22-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-646"><a href="#cb22-646" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress it on educ</span></span>
<span id="cb22-647"><a href="#cb22-647" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_wage <span class="sc">~</span> educ)</span>
<span id="cb22-648"><a href="#cb22-648" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span>
<span id="cb22-649"><a href="#cb22-649" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(wages)</span>
<span id="cb22-650"><a href="#cb22-650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-651"><a href="#cb22-651" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-652"><a href="#cb22-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exercises {#exercises-9}</span></span>
<span id="cb22-653"><a href="#cb22-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-654"><a href="#cb22-654" aria-hidden="true" tabindex="-1"></a>There isn't much new in terms of R code in this chapter. The code for the worked example is presented below, but please refer to @sec-worked-example-8 for the interpretation.</span>
<span id="cb22-655"><a href="#cb22-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-656"><a href="#cb22-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-659"><a href="#cb22-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-660"><a href="#cb22-660" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data and take a look</span></span>
<span id="cb22-661"><a href="#cb22-661" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"Wages.RData"</span>)</span>
<span id="cb22-662"><a href="#cb22-662" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(wages))</span>
<span id="cb22-663"><a href="#cb22-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-664"><a href="#cb22-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-665"><a href="#cb22-665" aria-hidden="true" tabindex="-1"></a>We will focus on regressing hourly wage (<span class="in">`wage`</span>) on years of education (<span class="in">`educ`</span>). The distribution of the outcome variable and its relationship with the predictor are depicted below. </span>
<span id="cb22-666"><a href="#cb22-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-669"><a href="#cb22-669" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-670"><a href="#cb22-670" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(wages)</span>
<span id="cb22-671"><a href="#cb22-671" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-672"><a href="#cb22-672" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(wage,  <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-673"><a href="#cb22-673" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(educ, wage, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-674"><a href="#cb22-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-675"><a href="#cb22-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-676"><a href="#cb22-676" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear regression of Wages on Education</span></span>
<span id="cb22-677"><a href="#cb22-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-678"><a href="#cb22-678" aria-hidden="true" tabindex="-1"></a>Working with linear model, we can see that *all* of the assumptions of the model are violated -- we are going to need to try another approach!</span>
<span id="cb22-679"><a href="#cb22-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-682"><a href="#cb22-682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-683"><a href="#cb22-683" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage <span class="sc">~</span> educ)</span>
<span id="cb22-684"><a href="#cb22-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-685"><a href="#cb22-685" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out model fit</span></span>
<span id="cb22-686"><a href="#cb22-686" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-687"><a href="#cb22-687" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-688"><a href="#cb22-688" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-689"><a href="#cb22-689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-690"><a href="#cb22-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-691"><a href="#cb22-691" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log-linear regression of Wages on Education</span></span>
<span id="cb22-692"><a href="#cb22-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-693"><a href="#cb22-693" aria-hidden="true" tabindex="-1"></a>To run a log-linear model, we can transform the Y-variable using the <span class="in">`log`</span> function, and then run the model as usual.</span>
<span id="cb22-694"><a href="#cb22-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-697"><a href="#cb22-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-698"><a href="#cb22-698" aria-hidden="true" tabindex="-1"></a><span class="co"># Create log transform of wage</span></span>
<span id="cb22-699"><a href="#cb22-699" aria-hidden="true" tabindex="-1"></a>log_wage <span class="ot">&lt;-</span> <span class="fu">log</span>(wage <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb22-700"><a href="#cb22-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-701"><a href="#cb22-701" aria-hidden="true" tabindex="-1"></a><span class="co"># Regress it on educ</span></span>
<span id="cb22-702"><a href="#cb22-702" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(log_wage <span class="sc">~</span> educ)</span>
<span id="cb22-703"><a href="#cb22-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-704"><a href="#cb22-704" aria-hidden="true" tabindex="-1"></a><span class="co"># Check out model fit</span></span>
<span id="cb22-705"><a href="#cb22-705" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-706"><a href="#cb22-706" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-707"><a href="#cb22-707" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod2, <span class="dv">2</span>, <span class="at">col =</span> <span class="st">"#4B9CD3"</span>)</span>
<span id="cb22-708"><a href="#cb22-708" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(wages)</span>
<span id="cb22-709"><a href="#cb22-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-710"><a href="#cb22-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-711"><a href="#cb22-711" aria-hidden="true" tabindex="-1"></a>The log transformation helped with positive skew, although didn't do much for the negative tail. It reduced the apparent heteroskedasticity. However, the relationship still appears non-linear, perhaps more so than in the original linear model. We will address non-linearity in the following chapter, and for now just focus on interpreting the log-linear model in this example. </span>
<span id="cb22-712"><a href="#cb22-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-713"><a href="#cb22-713" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The usual summary output provides the regression slope, which can be interpreted using the "approximate" interpretation of relative change: </span>
<span id="cb22-714"><a href="#cb22-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-717"><a href="#cb22-717" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-718"><a href="#cb22-718" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span>
<span id="cb22-719"><a href="#cb22-719" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-720"><a href="#cb22-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-721"><a href="#cb22-721" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Some follow up math to get the exact interpretation of the regression slope in terms of relative change. First $\exp(b) - 1$: </span>
<span id="cb22-722"><a href="#cb22-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-725"><a href="#cb22-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-726"><a href="#cb22-726" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the regression slope from the output </span></span>
<span id="cb22-727"><a href="#cb22-727" aria-hidden="true" tabindex="-1"></a>conf.b <span class="ot">&lt;-</span> <span class="fu">coef</span>(mod2)[<span class="dv">2</span>]</span>
<span id="cb22-728"><a href="#cb22-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-729"><a href="#cb22-729" aria-hidden="true" tabindex="-1"></a><span class="co"># Exp and subtract one to get exact relative change</span></span>
<span id="cb22-730"><a href="#cb22-730" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(conf.b) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb22-731"><a href="#cb22-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-732"><a href="#cb22-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-733"><a href="#cb22-733" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Next we compute a confidence interval for $\exp(b) - 1$:</span>
<span id="cb22-734"><a href="#cb22-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-737"><a href="#cb22-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-738"><a href="#cb22-738" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute a confidence interval for exact relative change</span></span>
<span id="cb22-739"><a href="#cb22-739" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(mod2)[<span class="dv">2</span>, ]) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb22-740"><a href="#cb22-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-741"><a href="#cb22-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-742"><a href="#cb22-742" aria-hidden="true" tabindex="-1"></a><span class="fu">## Write up</span></span>
<span id="cb22-743"><a href="#cb22-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-744"><a href="#cb22-744" aria-hidden="true" tabindex="-1"></a>Approximate: </span>
<span id="cb22-745"><a href="#cb22-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-746"><a href="#cb22-746" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Using a log-linear regression model, it was found that a one unit increase in years of education led to a predicted increase in wages of 7.4% ($b = .074, t(398) = 10.30, p &lt; .001$). </span>
<span id="cb22-747"><a href="#cb22-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-748"><a href="#cb22-748" aria-hidden="true" tabindex="-1"></a>Exact:</span>
<span id="cb22-749"><a href="#cb22-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-750"><a href="#cb22-750" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Using a log-linear regression model, it was found that a one unit increase in years of education led to a predicted increase in wages of 7.8% ($\exp(b) - 1 = .078, 95\% \text{ CI: }<span class="co">[</span><span class="ot">0.062, 0.093</span><span class="co">]</span>$). </span>
<span id="cb22-751"><a href="#cb22-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-752"><a href="#cb22-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-753"><a href="#cb22-753" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo = F}</span></span>
<span id="cb22-754"><a href="#cb22-754" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb22-755"><a href="#cb22-755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-756"><a href="#cb22-756" aria-hidden="true" tabindex="-1"></a>  </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>